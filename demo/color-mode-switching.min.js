!function(){"use strict";function e(e){return e.normalize("NFD").replace(/\p{Diacritic}/gu,"")}function t(t,s,n=!1,i=!1){return i&&(t=e(t),s=e(s)),n&&(t=t.toLowerCase(),s=s.toLowerCase()),function(e,t,s=0){let n;const i=[];if(t)for(s=Math.max(0,s);-1!==(n=e.indexOf(t,s));)i.push(n),s=n+1;return i}(t,s)}function s(e,s,n="span",i=!1,r=!1){const a=t(e,s,i,r);if(!a.length)return e;const o=s.length,l=new DocumentFragment;let c=0;for(const t of a){l.append(document.createTextNode(e.substring(c,t)));const s=document.createElement(n),i=t+o;s.append(document.createTextNode(e.substring(t,i))),l.append(s),c=i}return c!==e.length&&l.append(document.createTextNode(e.substring(c))),l}function n(e,t,s,n){const i="one"===new Intl.PluralRules(document.documentElement.lang,{type:"cardinal"}).select(e)?t:s;return n instanceof r?n.format({count:e,text:i}):`${e} ${i}`}function i(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}class r{constructor({strings:e,keys:t,formatter:s}){this.strings=e,this.keys=t,this.formatter=s}format(e){return this.formatter?this.formatter(e):this.strings.reduce(((t,s,n)=>{const i=this.keys[n];return t.concat(s).concat(e[i]??"")}),"")}static fromString(e,t){L(t,RegExp,{paramNumber:2});const s=[],n=[];let i,a=0;for(;null!==(i=t.exec(e));){const t=i[0],r=i.index;r!==a&&n.push(e.slice(a,r)),s.push(i[1]),a=r+t.length}return a<e.length&&n.push(e.slice(a)),new r({strings:n,keys:s})}}function a(e,...t){return new r({strings:e,keys:t})}class o{}class l{}class c extends Error{constructor(e,t){super(e,t)}}function h(e,t){if(Object.hasOwn(e,"_name"))throw new c('Property "_name" is reserved');const s=Object.create(o.prototype),n=new Proxy(s,{get(e,s){if("_name"===s)return t;if(!(s in e))throw new c(`Undefined enumeration property "${s}"`);return e[s]},set(){throw new c("Enumeration list cannot be supplemented")},ownKeys:e=>Reflect.ownKeys(e)});for(const[t,i]of Object.entries(e)){if("string"!=typeof i&&"number"!=typeof i)throw new TypeError(`Value of property "${t}" must be either string or number`);const e=Object.create(l.prototype);e.name=t,e.value=i,e.listing=n,Object.freeze(e),Object.defineProperty(s,t,{value:e,enumerable:!0})}return Object.freeze(s),n}function d(e,t){return e._name===t}function u(e,t){if(!(e instanceof l))throw new TypeError("Argument #1 is not an enumeration member");t&&function(e,t){if(!d(e,t))throw new TypeError(`Invalid enumeration: expected "${t}", got ${e._name}`)}(e.listing,t)}const m=h({one:"h1",two:"h2",three:"h3",four:"h4",five:"h5",six:"h6"},"headingLevels"),p=h({beforebegin:"beforebegin",afterbegin:"afterbegin",beforeend:"beforeend",afterend:"afterend"},"adjacencyPositions"),g=h({head:"HEAD",get:"GET",post:"POST",put:"PUT",delete:"DELETE",trace:"TRACE",patch:"PATCH",options:"OPTIONS",connect:"CONNECT"},"httpMethods"),f=h({pending:"pending",fulfilled:"fulfilled",rejected:"rejected"},"promiseStates");h({append:"append",prepend:"prepend"},"DOMManipulationActions");const b=h({topleft:"topleft",topright:"topright",bottomleft:"bottomleft",bottomright:"bottomright"},"positionalCorners");h({success:"success",error:"error"},"statuses");const v=h({asc:"ASC",desc:"DESC"},"sortDirection"),y=h({top:"top",right:"right",bottom:"bottom",left:"left",center:"center"},"positioning");h({push:"push",replace:"replace"},"historyAction"),h({enabled:"enabled",disabled:"disabled"},"enabledDisabled");class E extends DOMException{#e;constructor(e,t,s){super(e,t),this.#e=s}get cause(){return this.#e}}class C extends E{constructor(e,t){super(e,"TimeoutError",t)}}class w extends DOMException{constructor(e){super(e,"AbortError")}}class P extends DOMException{constructor(e){super(e,"AbortError")}}class x extends DOMException{constructor(e){super(e,"AbortError")}}class S extends E{constructor(e,t){super(e,"ApplicationException",t)}}class k extends E{constructor(e,t){super(e,"ApplicationException",t)}}function T(e){return null==e}function O(e){return Symbol.iterator in Object(e)||Symbol.asyncIterator in Object(e)}function M(e,{signal:t,onPerform:s,onEnd:n,initialValues:i=[]}={}){if(!e.length)return Promise.resolve([]);L(t,AbortSignal,{allowUndefined:!0});const r=e.length;return new Promise(((a,o)=>{const l=i,c=[];let h,d=!0;const u=(e,t,s=!0)=>{let i;if(e===f.fulfilled)a(l);else{o(t);const{promise:e,resolve:n,reject:r}=Promise.withResolvers();if(i=e,c.length){const{promise:e,resolve:t}=Promise.withResolvers();s?h=t:t(),e.then((e=>{const t=[];for(const s of c)t.push(s(l,e));Promise.all(t).then((()=>{n()})).catch((e=>{e=new k("Could not revert task",e),r(e)}))}))}else n()}"function"==typeof n&&n({state:e,values:l,error:t,revertPromise:i})};if(t){const e=()=>{u(f.rejected,new x("Promise series was aborted"))};t.aborted?(d=!1,e()):t.addEventListener("abort",(()=>{t.reason instanceof w||e()}))}if(d){let n=0,i=!1;const a=o=>{if(i)return;const d=e[o],m=o+1;let p,g;"function"==typeof d?p=d:({perform:p,revert:g}=d);const b=()=>{r===m?u(f.fulfilled):a(m)};if(p){let e;(v=p.bind(this,l,t),function(...e){return new Promise(((t,s)=>{try{t(v(...e))}catch(e){s(e)}}))})().then((t=>{e=t})).catch((e=>{if("AbortError"!==e.name){let t=new S(`Could not perform task: ${e.message}`,e);u(f.rejected,t,!1),i=!0}else g=!1})).finally((()=>{i||(g&&c.push(g),t&&t.aborted?h&&h(e):(l.push(e),n++,"function"==typeof s&&s(n,r),b()))}))}else b();var v};a(0)}}))}function L(e,t,{paramNumber:s=1,allowUndefined:n=!1}={}){if(!n||void 0!==e)if(Array.isArray(t)){if(!function(e,t){for(const s of t)if(e instanceof s)return!0;return!1}(e,t)){const e=new Intl.ListFormat(document.documentElement.lang,{style:"long",type:"conjunction"}).format(t.map((e=>e.name)));throw new TypeError(`Parameter #${s} must implement at least one of the following: ${e}`)}}else if(!(e instanceof t)){throw new TypeError(`Parameter #${s} must implement interface ${t.name}`)}}function A(e){return L(e,CustomEvent),new CustomEvent(e.type,{detail:e.detail})}function N(e,t,n,i){if(e&&t&&n){i&&!Object.hasOwn(i,"total")&&(i.total=0);const r=s(e,t,"mark",!0,!0);if(r instanceof DocumentFragment){const e=r.children.length;return n.replaceChildren(r),i&&(i.total+=e),e}}return null}function I(e,t,s,n){t||(t="N/A"),e.textContent=t,s&&N(n??t,s,e)}const D={buildHyperlink:(e,t,s={})=>function(e,t,s={}){s.href=e;const n={attrs:s};t instanceof Element?n.elems=[t]:n.html=t;return Q("a",n)}(e,t,s)};const j=(()=>{const e=new Set,t={capture:!1,once:!1,passive:!1};return{register(s,n={}){let i=!1;for(const{options:o,callbacks:l}of e)if(r=o,a={...t,...n},r.capture===a.capture&&r.once===a.once&&r.passive===a.passive&&r.signal===a.signal){l.add(s),i=!0;break}var r,a;if(!i){const i=new Set;i.add(s);const r=e=>{for(const t of i)t(e)};e.add({options:{...t,...n},callbacks:i,handler:r,originalOptions:Object.assign({},n)}),n.signal&&n.signal.addEventListener("abort",(()=>{this.unregister(s)}),{once:!0}),document.addEventListener("click",r,n)}},unregister(t){for(const s of e){const{callbacks:n,handler:i,originalOptions:r}=s;if(n.has(t)){n.delete(t),0===n.size&&(e.delete(s),document.removeEventListener("click",i,r));break}}}}})();function R(e){return"object"==typeof e&&null!==e}function B(e,t,s=!1){const n=s?[]:{};for(const[i,r]of Object.entries(e))t(i,r)&&(s?n.push(r):n[i]=r);return n}function F(...e){if(0===e.length)return{};if(1===e.length)return e[0];const t={};for(const s of e)if("object"==typeof s)for(const e in s)Object.hasOwn(s,e)&&("object"==typeof t[e]&&"object"==typeof s[e]&&Object.getPrototypeOf(s[e])===Object.prototype?t[e]=F(t[e],s[e]):t[e]=s[e]);return t}function V(e,t){return t.reduce(((e,t)=>e&&e[t]),e)}function $(e,t,{divider:s="."}={}){return V(e,t.split(s))}function K(e,t,{validProps:s,includeNullish:n=!1,considerArrayAsMultiPath:i=!1}={}){const r={};for(const[a,o]of Object.entries(e))if(!s||s.includes(a)){let e;if("string"==typeof o)e=$(t,o);else if(Array.isArray(o))if(i){for(const s of o)if(e=$(t,s),!T(e))break}else e=V(t,o);!n&&T(e)||(r[a]=e)}return r}function U(e,t){"object"==typeof t&&(t=Object.keys(t));const s={};for(const n of Object.keys(e))t.includes(n)&&(s[n]=e[n]);return s}const q="http://localhost/projects/project/",H=`${q}lib/firstile-css/dist/`,W={project:q,stylesheetsURL:H,stylesheets:{checkbox:`${H}checkbox.min.css`,checkboxClassic:`${H}checkbox-classic.min.css`,selectMenu:void 0,referenceSelect:void 0,formElement:`${H}form-element.min.css`,siteNotificationCard:void 0,dialog:`${H}dialog.min.css`,fullscreenToggler:`${H}fullscreen-toggler.min.css`,notificationStatus:`${H}notification-status.min.css`},workers:`${q}lib/tagplant.js/src/workers/`,apiListingEndpoint:"http://localhost/projects/data-project/src/public/countries/"};function z(e,t,s,n){if(void 0!==s&&!Number.isInteger(s))throw new TypeError("Invalid width: it must be an integer");if(void 0!==n&&!Number.isInteger(n))throw new TypeError("Invalid height: it must be an integer");return Q("img",{attrs:{src:e,...t&&{alt:t},...s&&{width:s},...n&&{height:n}}})}function Q(e,t={},s={}){const n=document.createElement(e);for(const[e,i]of Object.entries(t))if(void 0!==i)switch(e){case"classes":O(i)&&(Array.isArray(i)&&i.length||!Array.isArray(i))&&n.classList.add(...i);break;case"text":n.innerText=i;break;case"html":n.innerHTML=i;break;case"id":"string"==typeof i&&(n.id=i);break;case"attrs":for(const[e,t]of Object.entries(i))n.setAttribute(e,t);break;case"title":n.title=i;break;case"elems":for(const e of i)if(e instanceof Node)n.append(e);else if(e instanceof DocumentFragment)n.append(...e.children);else if(R(e)){const{tag:t,options:i,text:r,node:a,ref:o}=e,l="string"==typeof r,c=a instanceof Node;let h;l||c?l?h=document.createTextNode(r):c&&(h=a):h=Q(t,i,s),h&&(o&&(s[o]=h),n.append(h))}}return n}function _(e,t=[]){return Q("button",{text:e,classes:t,attrs:{type:"button"}})}function G(e,t,s){const n=e.children;return s>=0&&s<n.length?e.insertBefore(t,n[s]):e.appendChild(t)}function J(e,t="span"){if(e instanceof HTMLElement)return e;if(e instanceof DocumentFragment)return Q(t,{elems:[{node:e}]});if(e instanceof Blob)return z(URL.createObjectURL(e));if(e instanceof Date)return Q("time",{text:e.toString(),attrs:{datetime:e.toISOString()}});if(R(e)&&Object.hasOwn(e,"value"))return J(e.value);{const s={};return T(e)||"boolean"==typeof e?s.text="":"number"==typeof e?s.text=String(e):s.html=String(e),Q(t,s)}}function X(e,t){t||(t=Q("div"));for(const s of e)"function"!=typeof s?t.append(J(s)):t.append(s());return t}function Y(e){if(!e.elements.length)return[];const t=Array.from(e.elements),s=[];return t.forEach((e=>{("submit"===e.type||"BUTTON"===e.tagName&&"button"!==e.type)&&s.push(e)})),s}const Z=(()=>{const e=new Map;let t;const s=(s,n)=>{t||(t=new MutationObserver((t=>{t.forEach((t=>{if(e.has(t.target)){const s=e.get(t.target),n=t.attributeName;if(n in s){const e=s[n],i=t.target.getAttribute(n),r=t.oldValue;for(const s of e)s({newValue:i,oldValue:r,attrName:n,mutation:t})}}}))}))),t.observe(s,{attributes:!0,attributeFilter:n,attributeOldValue:!0})};return(n,i,r)=>{if(L(n,Element),"function"!=typeof r)throw new TypeError("Callback must be a function");if(e.has(n)){const t=e.get(n);i in t?t[i].push(r):(t[i]=[r],s(n,Object.keys(t)))}else{const t=Object.create(null);t[i]=[r],e.set(n,t),s(n,[i])}const a={unobserve(){const s=e.get(n);delete s[i];const r=Object.keys(s).length;return 0===r&&(e=>{t.observe(e,{attributes:!0,attributeFilter:[],attributeOldValue:!0})})(n),r}};return Object.freeze(a),a}})();function ee(e,t){if("function"!=typeof t)throw new TypeError("Callback must be a function");const s=new MutationObserver((e=>{e.forEach((e=>{"childList"===e.type&&(e.addedNodes.length||e.removedNodes.length)&&t({addedNodes:e.addedNodes,removedNodes:e.removedNodes})}))}));return s.observe(e,{childList:!0}),s}function te(e="el",t=1,s="-"){let n=t;for(;document.getElementById(e.concat(s,n));)n++;return e.concat(s,n)}function se(e,t){return L(e,Node),L(t,Node,{paramNumber:2}),e.insertBefore(t,e.firstChild)}function ne(e,t){return t&&t.parentNode?t.parentNode.insertBefore(e,t.nextSibling):t.appendChild(e)}function ie(e,t){if(!(e instanceof Element))throw new TypeError("Argument 1 is not an element");"string"==typeof t&&(t=[t]),e.classList.remove(...t),0===e.classList.length&&e.removeAttribute("class")}function re(e){return null!==e.parentNode}function ae(e){return re(e)?e.parentNode.removeChild(e):null}function oe(e,t){let s=0,n=e;for(;n!==t&&n.parentNode;)n=n.parentNode,s++;return s}function le(e,t){let s=null,n=1/0;const i=function(e,t){return document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>t(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP})}(e,(e=>t(e)));for(;i.nextNode();){const t=oe(i.currentNode,e);t<n&&(n=t,s=i.currentNode)}return s}const ce=(()=>{let e;const t=new Map;return s=>{if(L(s,Element),t.has(s)){t.get(s).observersCount++}else t.set(s,{isConnected:s.isConnected,observersCount:1}),(()=>{if(!e){const s=(e,t)=>{e.isConnected=!0,t.dispatchEvent(new CustomEvent("connected"))},n=(e,t)=>{e.isConnected=!1,t.dispatchEvent(new CustomEvent("disconnected"))};e=new MutationObserver((e=>{for(const i of e){if(0!==i.addedNodes.length)for(const e of i.addedNodes)if(e.nodeType===Node.ELEMENT_NODE)if(t.has(e)){const n=t.get(e);s(n,e)}else for(const[n,i]of t.entries())e.contains(n)&&s(i,n);if(0!==i.removedNodes.length)for(const e of i.removedNodes)if(e.nodeType===Node.ELEMENT_NODE)if(t.has(e)){const s=t.get(e);n(s,e)}else for(const[s,i]of t.entries())e.contains(s)&&n(i,s)}})),e.observe(document.body,{childList:!0,subtree:!0})}})();const n={removeObserver(){const e=t.get(s);return e.observersCount--,0===e.observersCount&&t.delete(s),e.observersCount}};return Object.freeze(n),n}})();function he(e,t,s){switch(u(t,"adjacencyPositions"),t){case p.beforebegin:return e.parentNode.insertBefore(s,e);case p.afterbegin:return se(e,s);case p.beforeend:return e.appendChild(s);case p.afterend:return ne(s,e)}}const de=({ElInterface:e=HTMLElement,mode:t="open",options:s={}}={})=>class extends e{static observedAttributes=["stylesheet"];static defaultOptions={observeStylesheet:!1,mimicRootAttributes:["data-theme"]};#t=!1;#s;afterConnectedAttrCallbacks={};#n=!1;#i=new Set;constructor(){super().attachShadow({mode:t}),this.options={...this.constructor.defaultOptions,...s};for(const e of this.constructor.defaultOptions.mimicRootAttributes)this.options.mimicRootAttributes.includes(e)||this.options.mimicRootAttributes.push(e)}attributeChangedCallback(e,t,s){"stylesheet"===e&&this.options.observeStylesheet&&(this.#s&&this.#s.remove(),s&&(this.#s=this.addExternalStylesheet(s))),Object.hasOwn(this.afterConnectedAttrCallbacks,e)&&(this.wasConnected?this.#r(e,t,s):this.addEventListener("connected",(()=>{this.#r(e,t,s)}),{once:!0}))}addAfterConnectedAttrCallback(e,t){Object.hasOwn(this.afterConnectedAttrCallbacks,e)?this.afterConnectedAttrCallbacks[e].push(t):this.afterConnectedAttrCallbacks[e]=[t]}#r(e,t,s){if(Object.hasOwn(this.afterConnectedAttrCallbacks,e))for(const n of this.afterConnectedAttrCallbacks[e])n(s,t,e)}connectedCallback(e){if(this.#n=!0,this.#t=!0,e){const t=e.content.cloneNode(!0);this.shadowRoot.appendChild(t)}this.dispatchEvent(new CustomEvent("connected",{detail:{shadowRoot:this.shadowRoot,template:e}}));for(const e of this.options.mimicRootAttributes){const t=document.documentElement.getAttribute(e);null!==t&&this.setAttribute(e,t);const s=Z(document.documentElement,e,(({newValue:t})=>{null===t?this.removeAttribute(e):this.setAttribute(e,t)})),n=Z(this,e,(({newValue:t})=>{const s=document.documentElement.getAttribute(e);null!==s&&t!==s&&this.setAttribute(e,s)}));this.#i.add(s).add(n)}this.classList.add("custom-element")}disconnectedCallback(){this.#n=!1;const e=null===this.parentElement;this.dispatchEvent(new CustomEvent("disconnected",{detail:{shadowRoot:this.shadowRoot,isRemoved:e}})),e&&this.dispatchEvent(new CustomEvent("removed",{detail:{shadowRoot:this.shadowRoot}}));for(const e of this.#i)e.unobserve();for(const e of this.options.mimicRootAttributes)this.removeAttribute(e)}get wasConnected(){return this.#t}get isConnected(){return this.#n}get mainStylesheet(){return this.#s}addExternalStylesheet(e,t={}){const s=Q("link",{attrs:{...t,rel:"stylesheet",href:e}});return this.insertElementAfterStylesheets(s)}insertElementAfterStylesheets(e){for(const t of this.shadowRoot.children)if("link"!==t.localName)return this.shadowRoot.insertBefore(e,t);return this.shadowRoot.appendChild(e)}addInternalStyles(e){const t=document.createElement("style");return t.textContent=e,se(this.shadowRoot,t)}removeNonLinkChildrenInShadowRoot(){for(const e of this.shadowRoot.children)"link"!==e.localName&&e.remove()}};function ue({top:e="auto",right:t="auto",bottom:s="auto",left:n="auto"}={}){const i=e=>"auto"===e?"auto":`${e}px`;return`${i(e)} ${i(t)} ${i(s)} ${i(n)}`}class me{#a;#o;constructor(e,t){this.#a=e,this.#o=t}get x(){return this.#a}get y(){return this.#o}shift(e,t){return new me(this.#a+e,this.#o+t)}shiftX(e){return new me(this.#a+e,this.#o)}shiftY(e){return new me(this.#a,this.#o+e)}shiftByPositionalCorner(e,t,s){switch(u(e,"positionalCorners"),e){case b.topright:return this.shiftX(-t);case b.bottomleft:return this.shiftY(-s);case b.bottomright:return this.shift(-t,-s);default:return this}}toDOMPoint(e=!1){return e?new DOMPointReadOnly(this.#a,this.#o):new DOMPoint(this.#a,this.#o)}}function pe(e,t,s,n=!1){const[i,r]=function(e,t,s){let n,i;const r=t.getBoundingClientRect(),a=s.getBoundingClientRect(),o=a.width,l=a.height,c=document.documentElement.clientWidth,h=document.documentElement.clientHeight,d=e=>{const t="top"===e||"bottom"===e?"y":"x";return[t,"y"===t?l:o]},u=e=>{const[t,s]=d(e),n="y"===t?h:c;return r[e]+Math.min(0,n-(r[e]+s))},m=e=>{const[,t]=d(e);return Math.max(0,r[e]-t)};switch(e){case"TL":n=m("top"),i=u("left");break;case"TR":n=m("top"),i=m("right");break;case"RT":n=u("top"),i=u("right");break;case"RB":n=m("bottom"),i=u("right");break;case"BR":n=u("bottom"),i=m("right");break;case"BL":n=u("bottom"),i=u("left");break;case"LB":n=m("bottom"),i=m("left");break;case"LT":n=u("top"),i=m("left")}return[n,i]}(t,s,e);n?e.style.setProperty("inset",`${i}px auto auto ${r}px`):(e.style.setProperty("top",i+"px"),e.style.setProperty("left",r+"px"))}function ge(e,t,s,n=b.topleft){u(n,"positionalCorners");const i=new me(t,s),r=e.getBoundingClientRect(),a=i.shiftByPositionalCorner(n,r.width,r.height);let o=new DOMRectReadOnly(a.x,a.y,r.width,r.height);o=function(e){L(e,[DOMRect,DOMRectReadOnly]);let{width:t,height:s}=e,n=Math.max(e.y,0),i=Math.max(e.x,0);const r=document.documentElement.clientWidth,a=document.documentElement.clientHeight;return e.height>a?(s=a,n=0):e.bottom>a&&(n-=e.bottom-a),e.width>r?(t=r,i=0):e.right>r&&(i-=e.right-r),new DOMRectReadOnly(i,n,t,s)}(o);let{top:l,left:c,width:h,height:d}=o;const m={inset:ue({top:l,left:c})};h!=r.width&&(m.width=`${h}px`),d!=r.height&&(m.height=`${d}px`),function(e,t){for(const[s,n]of Object.entries(t))e.style.setProperty(s,n)}(e,m)}function fe(e,t){const s=e.indexOf(t);return-1===s?null:(e.splice(s,1),!0)}function be(e,t){return 0===e.length&&0===t.length||e.length===t.length&&e.every((e=>t.includes(e)))}function ve(e,t){for(const[s,n]of Object.entries(t)){let t;t="function"==typeof n?[n]:n,e.addEventListener(s,...t)}}const ye=({parentConstructor:e=Ce,countFormula:t}={})=>class extends e{#l;constructor(e){super(e),this.#l=t,this.revisitCount(),ee(e,(()=>{this.revisitCount()})),Z(e,"data-count",(({newValue:t})=>{const s=this.countChildren;t!==String(s)&&e.setAttribute("data-count",s)}))}get countChildren(){const e=this.element.children.length;return"function"==typeof this.#l?this.#l(e):e}get countFormula(){return this.#l}revisitCount(){let e;this.element.hasAttribute("data-count")&&(e=parseInt(this.element.getAttribute("data-count")));const t=this.count;this.element.setAttribute("data-count",t),T(e)||e===t||this.dispatchEvent(new CustomEvent("countchange",{detail:{newCount:t,oldCount:e}}))}addCountAttrTo(e){L(e,Element),e.setAttribute("data-count",""),this.updateCountOnAttr(e.getAttributeNode("data-count"))}updateCountOnAttr(e){L(e,Attr),e.value=this.count,this.addEventListener("countchange",(t=>{e.value=t.detail.newCount}))}updateCountText(e){e.textContent=this.count,this.addEventListener("countchange",(t=>{e.textContent=t.detail.newCount}))}},Ee=({parentConstructor:e=Ce}={})=>class extends e{#c=new Map;#h=0;constructor(e){super(e),ee(e,(({addedNodes:t,removedNodes:s})=>{if(0!==t.length){t=Array.from(t);for(const{node:e}of this.#c.values())fe(t,e);if(0!==t.length)for(const s of t)s.parentElement===e&&this.setChildKey(s)}if(0!==s.length){s=Array.from(s);for(const[e,{node:t,detached:n}]of this.#c.entries())!n&&s.includes(t)&&this.#c.delete(e)}}))}get keysIndex(){return this.#h}get dataItemsMap(){return new Map(this.#c)}hasKey(e){return this.#c.has(e)}getByKey(e){const t=this.#d(e);return t?t.node:null}#d(e){return this.#c.get(e)}validateChildNode(e){if(e.parentElement!==this.element)throw new DOMException("Node must be a child of the fundamental element")}getKey(e){this.validateChildNode(e);for(const[t,{node:s}]of this.#c.entries())if(s===e)return t;return null}*namedChildren(){for(const[e,{node:t}]of this.#c.entries())yield[e,t]}*dataItems(){for(const[,{data:e}]of this.#c.entries())yield e}validateCustomKey(e){if(!T(e)){const t=typeof e;if("string"!==t&&"number"!==t)throw new TypeError("Custom key must be either a string or a number");if(this.hasKey(e))throw new DOMException(`Key "${e}" is taken`)}}#u(){if(0===this.#h)return this.#h++,0;{const e=this.#h;return this.#h++,e}}#m(e){return T(e)?e=this.#u():this.validateCustomKey(e),e}setChildKey(e,{key:t,data:s={}}={}){this.validateChildNode(e);const n=this.getKey(e);if(null!==n)throw new DOMException(`Node already has a key assigned ${n}`);return t=this.#m(t),this.#c.set(t,{node:e,data:s}),this.dispatchEvent(new CustomEvent("setnodekey",{detail:{node:e,key:t,data:s}})),t}getChildData(e){if(this.hasKey(e)){const t=this.#c.get(e);return Object.assign({},t.data)}}modifyChildData(e,t,{merge:s=!0}={}){if(this.hasKey(e)){const n=this.#c.get(e);n.data=s?{...n.data,...t}:t,this.#c.set(e,n)}}removeByKey(e){if(!this.hasKey(e))return!1;const{node:t}=this.#c.get(e);return t.remove(),this.#c.delete(e),!0}emptyKeys(){this.#c.clear()}detachChildByKey(e){if(this.hasKey(e)){const t=this.#c.get(e);return t.detached=!0,t.lastDetachPosition=function(e,t){let s=0;for(const n of e.children){if(n===t)return s;s++}return null}(this.element,t.node),this.#c.set(e,t),ae(t.node)}}reattachChildByKey(e,t){if(this.hasKey(e)){const s=this.#c.get(e);if("detached"in s&&s.detached){const{node:n,lastDetachPosition:i}=s,r=t||i||this.element.children.length;return delete s.detached,delete s.lastDetachPosition,this.#c.set(e,s),G(this.element,n,r)}}}};class Ce extends EventTarget{#p;#t=!1;constructor(e){if(e.isConnected)throw new DOMException("Element must not be connected");super(),ce(e),ve(e,{connected:()=>{const e=this.#t;this.#t||(this.dispatchEvent(new CustomEvent("connectedfirst")),this.#t=!0),this.dispatchEvent(new CustomEvent("connected",{detail:{wasConnected:e}}))},disconnected:()=>{this.dispatchEvent(new CustomEvent("disconnected"))}}),this.#p=e}get element(){return this.#p}get isAttached(){return re(this.element)}get isDetached(){return!this.isAttached}get wasConnected(){return this.#t}getElement(){return this.element}detach(){return this.isAttached?ae(this.element):null}attach(e,{adjacency:t=p.afterbegin}={}){this.isDetached&&he(e,t,this.element)}prependTo(e){e.prepend(this.element)}prependToBody(e){return se((e=e||document).body,this.element)}appendTo(e){e.append(this.element)}appendToBody(e){return(e=e||document).body.appendChild(this.element)}constrainAttributeToList(e,t,s,n){Z(this.#p,e,(({newValue:i})=>{let r;const a=s();try{r=t[i]}catch{this.#p.setAttribute(e,a.value)}r&&r!==a&&n(r)}))}static getStandardFooterSchema(e){return{tag:"footer",options:{classes:e},ref:"footer"}}static getStandardHeaderSchema(e,{classes:t,headingLevel:s=m.two,headingClasses:n}={}){return{tag:"header",options:{classes:t,elems:[{tag:s.value,options:{text:e,classes:n},ref:"heading"}]},ref:"header"}}static createStandardCarcass(e,t,s,{classes:n=[],attrs:i,headingLevel:r=m.two,includeFooter:a=!1,includeBody:o=!1,refs:l={}}={}){const c=[e.getHeaderSchema(s,r)];o&&"getBodySchema"in e&&c.push(e.getBodySchema()),a&&"getFooterSchema"in e&&c.push(e.getFooterSchema());return[Q(t,{classes:n,attrs:i,elems:c},l),l]}}class we{#g;constructor(e){this.#g=e}get type(){return this.#g}get eventType(){return this.#g}}class Pe{#f;#b;#v=!1;constructor(e,t,{autoadd:s=!1}={}){this.#f=e,this.#b=Array.isArray(t)?t:[t],s&&this.add()}get isAdded(){return this.#v}add(){this.#v||this.#y()}remove(){this.#v&&this.#E()}toggle(){this.#v?this.#E():this.#y()}#y(){for(const{type:e,args:t}of Object.values(this.#f))for(const s of this.#b)s.addEventListener(e,...t);this.#v=!0}#E(){for(const{type:e,args:t}of Object.values(this.#f))for(const s of this.#b)s.removeEventListener(e,...t);this.#v=!1}}class xe extends we{static#C="longpress";#w;#P;constructor(e,{length:t=2e3,addImmediatelly:s=!0}={}){super(),this.#w=e,this.#P=new Pe(this.getListeners(t),e,{autoadd:s})}static get eventType(){return xe.#C}add(){this.#P.add()}remove(){this.#P.remove()}toggle(){this.#P.toggle()}#x(e){this.#w.dispatchEvent(new CustomEvent(xe.#C,{detail:e}))}getListeners(e){let t,s;return{mousedown:{type:"mousedown",args:[n=>{const{promise:i,resolve:r}=Promise.withResolvers();s=r,t=setTimeout((()=>{this.#x({baseEvent:n,mouseupPromise:i})}),e)}]},mouseup:{type:"mouseup",args:[e=>{s(e),clearTimeout(t)}]}}}}const Se=(()=>{const e=new Map,t=new Map,s={register(t){if(!function(e,t){let s=e;for(;s;){if(s===t)return!0;s=Object.getPrototypeOf(s)}return!1}(t.prototype,we.prototype))throw new TypeError("Invalid controller");this.has(t.eventType)||e.set(t.eventType,t)},has:t=>e.has(t),enable(s,n,i=[]){let r,a=!1;if(t.has(n)?(r=t.get(n),Object.hasOwn(r,s)?r[s].usageCount++:(r[s]={usageCount:1},a=!0)):(r={},r[s]={usageCount:1},a=!0),a){const t=e.get(s);r[s].controller=new t(n,...i)}t.set(n,r)},disable(e,s){if(t.has(s)){const n=t.get(s);if(Object.hasOwn(n,e)){const i=n[e];1===i.usageCount&&(i.controller.remove(),delete n[e],Object.values(n).length||t.delete(s))}}},list:()=>Array.from(e.keys()),listElementEventTypes:e=>t.has(e)?Array.from(Object.keys(t.get(e))):[]};return Object.freeze(s),s})();class ke{static#S={className:"scrolled"};#k;#b=new Map;constructor(e={}){this.#k={...ke.#S,...e}}static get defaultOptions(){return Object.assign({},this.#S)}observe(e,t){let s;L(e,Element);const n=()=>{if(0!==e.scrollTop){e.classList.add(this.#k.className);for(const e of t)e.classList.add(this.#k.className)}else{ie(e,[this.#k.className]);for(const e of t)ie(e,[this.#k.className])}},i=new Pe({scroll:{type:"scroll",args:[()=>{clearTimeout(s),n(),s=setTimeout((()=>{n()}),100)}]}},e,{autoadd:!0});this.#b.set(e,{eventListeners:i,scrollTimeout:s})}unobserve(e){if(this.#b.has(e)){const{eventListeners:t,scrollTimeout:s}=this.#b.get(e);t.remove(),clearTimeout(s),this.#b.delete(e)}}}class Te extends(Ee({parentConstructor:ye()})){static#S={keyAsDataId:!1};#k;#T;#O=new Map;constructor({memberBuilder:e=Te.defaultMemberBuilder,tag:t="div",classes:s=[],options:n={}}={}){const i=Te.createCarcass({tag:t,classes:s});super(i),this.#k={...Te.#S,...n},this.#T=e,ee(i,(({removedNodes:e})=>{if(e.length)for(const t of e.values())if(this.#O.has(t)){const e=this.#O.get(t);for(const t of e)t();this.#O.delete(t)}})),this.addEventListener("setnodekey",(e=>{if(this.#k.keyAsDataId){const{node:t,key:s}=e.detail;t.setAttribute("data-id",s)}}))}static get defaultOptions(){return Object.assign({},this.#S)}get options(){return Object.assign({},this.#k)}get count(){return this.countChildren}has(e){return this.hasKey(e)}get(e){return this.getByKey(e)}createMember(e,t,{keyToDataset:s=!0,keyToClasses:n=!0,classes:r=[]}={}){const a=this.#T.build(e,t);if(s&&!T(t)&&!1!==t&&(a.dataset.name=t),n&&(t||0===t)){let e=t;"string"==typeof e&&(e=i(t)),("number"==typeof e||"string"==typeof e&&/^\d+$/.test(e))&&(e=`class-${e}`),a.classList.add(e)}return 0!==r.length&&a.classList.add(...r),a}*members(){for(const e of this.element.children)yield e}prependMember(e,t){se(this.element,e);return[e,this.setChildKey(e,{key:t,data:{originalPosition:0}})]}prepend(e,t,{keyToDataset:s,keyToClasses:n,classes:i=[]}={}){const r=this.createMember(e,t,{keyToDataset:s,keyToClasses:n,classes:i});return this.prependMember(r,t)}appendMember(e,t){this.element.appendChild(e);return[e,this.setChildKey(e,{key:t,data:{originalPosition:Math.max(0,this.countChildren-1)}})]}append(e,t,{keyToDataset:s,keyToClasses:n,classes:i=[]}={}){const r=this.createMember(e,t,{keyToDataset:s,keyToClasses:n,classes:i});return this.appendMember(r,t)}insertMember(e,t,s){G(this.element,e,t);return[e,this.setChildKey(e,{key:s,data:{originalPosition:t}})]}insert(e,t,s,{keyToDataset:n,keyToClasses:i,classes:r=[]}={}){const a=this.createMember(e,s,{keyToDataset:n,keyToClasses:i,classes:r});return this.insertMember(a,t,s)}remove(e){return this.getByKey(e)?(this.removeByKey(e),!1):null}empty({emptyKeys:e=!1}={}){0!==this.count&&(this.element.replaceChildren(),e&&this.emptyKeys())}detachMember(e){return this.detachChildByKey(e)}reattachMember(e,t){return this.reattachChildByKey(e,t)}isMemberAttached(e){const t=this.get(e);return null===t?null:re(t)}onMemberRemove(e,t){if(this.hasKey(e)){const s=this.getByKey(e);if(this.#O.has(s)){const e=this.#O.get(s);e.push(t),this.#O.set(s,e)}else this.#O.set(s,[t])}}removePortion(e,t){if(t<e)throw new TypeError("End index must be smaller than start index");if("number"!=typeof t&&(t=this.count-1),e<=this.count-1)for(let s=t;s>=e;s--)this.element.removeChild(this.element.children[s])}changeMemberBuilder(e){this.#T=e}static createCarcass({tag:e="div",classes:t=[]}={}){return Q(e,{classes:["group",...t]})}static get defaultMemberBuilder(){return{defaultTag:"div",iterableToElement:X,textElementWrapper:void 0,build(e){const t=typeof e;let s,n=Q(this.defaultTag);const i=()=>{if(this.textElementWrapper){const e=Q(this.textElementWrapper);return n.append(e),e}return n};if("string"===t)i().textContent=e;else if(Te.hasGroupMemberMethod(e))n=e.toGroupMember();else if(e instanceof Node)if(e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)e.firstChild.nodeType===Node.TEXT_NODE?i().append(e):n.append(e);else n.append(e);else if(O(e))s=e;else{if("object"!==t)throw new DOMException("Unsupported element type");s=Object.values(e)}return s&&(n=this.iterableToElement(s,n)),n}}}static get customElementMemberBuilder(){return{customElementName:"div",build(e){let t;if(O(e))t=e;else{if("object"!=typeof e)throw new DOMException("Unsupported element type");t=function*(e){for(const t of Object.keys(e))yield[t,e[t]]}(e)}return function(e,{tag:t="div",refs:s}={}){const n=Q(t);for(const[t,i]of e){let e;"function"==typeof i?e=i(n,t):void 0!==i&&(e=J(i)),e&&(e.setAttribute("slot",t),n.append(e),"object"==typeof s&&(s[t]=e))}return n}(t,{tag:this.customElementName})}}}static get chunkBuilder(){return{chunkNames:null,addNameToClasses:!1,build(e){const t=Q("div"),s=[];for(const[t,n]of Object.entries(e))s.push(this.buildCell(t,n));return t.append(...s),t},buildCell(e,t){const s={attrs:{"data-name":e}};Object.hasOwn(this,"chunkNames")&&R(this.chunkNames)&&Object.hasOwn(this.chunkNames,e)&&(s.attrs["data-title"]=this.chunkNames[e]),this.addNameToClasses&&(s.classes=[e]);const n=Q("div",s);return"function"==typeof t?t(n):T(t)||(R(t)&&Object.hasOwn(t,"value")?n.append(t.value):t instanceof DocumentFragment?n.append(t):n.innerHTML=t),n}}}static get classedItemsBuilder(){return{addNameToAttributes:!1,build(e){const t=Q("div");for(const[s,n]of Object.entries(e))t.append(this.buildItem(s,n));return t.append(),t},buildItem(e,t){let s;return s="function"!=typeof t?J(t):t(),s.classList.add(e),this.addNameToAttributes&&(s.dataset.name=e),s}}}static hasGroupMemberMethod(e){return"object"==typeof e&&null!==e&&"toGroupMember"in e&&"function"==typeof e.toGroupMember}}class Oe extends Te{static#M=h({unordered:"unordered",ordered:"ordered"},"listTypes");static#S={keyAsDataId:!1};static#L="li";#k;constructor({type:e=Oe.types.unordered,classes:t=[],options:s={}}={}){u(e,"listTypes");const n=Te.defaultMemberBuilder;n.defaultTag=Oe.#L;super({memberBuilder:n,tag:e===Oe.types.unordered?"ul":"ol",classes:t,options:{keyAsDataId:(s={...Oe.defaultOptions,...s}).keyAsDataId}}),this.#k=s}get types(){return Oe.#M}static get types(){return Oe.#M}static get defaultOptions(){return Object.assign({},this.#S)}get options(){return Object.assign({},this.#k)}static get itemTag(){return Oe.#L}getItem(e){return this.getByKey(e)}detachItem(e){return this.detachMember(e)}reattachItem(e,t){return this.reattachMember(e,t)}items(){return this.members()}static createItem(e,t=[]){L(e,Node);const s=Q(Oe.#L,{classes:t});return s.appendChild(e),s}}function Me(e){return e%2!=0}const Le=(e="position")=>(t,s)=>(t[e]||0)-(s[e]||0);class Ae extends DOMException{constructor(e,t){super(e,"AbortError"),this.previous=t}}class Ne extends Promise{#A=f.pending;#N;constructor(e,t,s=!0){if(void 0===t)t=new AbortController;else if(!(t instanceof AbortController))throw new TypeError("Parameter #2 is not an abort controller");let n=!1;super(((i,r)=>{e(i,r,t),t.signal.addEventListener("abort",(()=>{s&&!n&&r(new Ae("Promise was aborted",t.signal.reason))}))})),this.#N=t;const i=()=>{t.signal.aborted||(n=!0,t.abort(new w("The operation has expired")))};this.then((()=>{this.#A=f.fulfilled,i()}),(()=>{this.#A=f.rejected,i()}))}static get[Symbol.species](){return Promise}get abortController(){return this.#N}get state(){return this.#A}cancel(){this.abortController.abort(new P("Aborted by application"))}static isPromiseAbortException(e){return e instanceof Ae}}class Ie extends EventTarget{abortControllers=new Set;closeCallbacks=new Set;constructor(e){if(L(e,Element),super(),!function(e){return e instanceof Element&&(e.isConnected||document.body.contains(e))}(e))throw new DOMException("Element must be active");this.el=e,this.el.classList.add(Ie.className),function(e){return new Promise(((t,s)=>{e.parentElement||s(new DOMException("Element with removal tracking requires a parent element"));const n=new MutationObserver((s=>{s.forEach((s=>{s.removedNodes&&Array.from(s.removedNodes).includes(e)&&t()}))}));try{n.observe(e.parentElement,{childList:!0})}catch(e){s(e)}}))}(e).then((()=>{this.close(),this.dispatchEvent(new CustomEvent("remove"))})).catch((e=>{})),je.add(this)}static get className(){return"area"}get element(){return this.el}provideAbortController(){const e=new AbortController;return this.abortControllers.add(e),e.signal.addEventListener("abort",(()=>{this.abortControllers.delete(e)})),e}abortAll(){this.abortControllers.size&&this.abortControllers.forEach((e=>{e.signal.aborted||e.abort(new w("The operation has expired"))}))}addOnRemoveCallback(e){this.closeCallbacks.add(e)}close(){this.abortAll()}remove(){this.constructor.removeElement(this.el)}empty(){this.constructor.emptyElement(this.el),this.close()}toCollection(){const e=new De;return e.add(this),e}static findClosest(e){const t=Ie.className;return e.classList.contains(t)?e:e.closest(".".concat(t))}static removeInnerAreaElements(e){const t=e.getElementsByClassName(Ie.className);if(t.length){const s=Array.from(t);for(const[t,n]of s.entries()){const i=oe(n,e);s[t]={element:n,depth:i}}s.sort(Le("depth")).reverse();for(const e of s)e.element.remove()}}static removeElement(e){Ie.removeInnerAreaElements(e),e.remove()}static emptyElement(e){Ie.removeInnerAreaElements(e),e.replaceChildren()}static attachedTimeout(e,t){const s=je.relative(e);let n;return s&&(n=s.provideAbortController()),new Ne((e=>{const s=setTimeout((()=>{e()}),t);n&&n.signal.addEventListener("abort",(()=>{clearTimeout(s)}))}),n)}}class De{#c=new Map;get length(){return this.#c.size}add(e){L(e,Ie),this.#c.set(e.element,e),e.addEventListener("remove",(()=>{this.delete(e.element)}))}has(e){return this.#c.has(e)}get(e){return this.#c.get(e)}delete(e){return L(e,Element),this.#c.delete(e)}first(){const e=le(document.documentElement,(e=>e.classList.contains(Ie.className)));return e&&this.has(e)?this.get(e):null}relative(e){const t=Ie.findClosest(e);return t&&this.has(t)?this.get(t):null}}const je=new De,Re=()=>class{#I;#D;#j;constructor(e,t,s){this.#I=e,this.#D=t,this.#j=s}get shown(){return this.#I.matches(":popover-open")}get element(){return this.#I}show(e){e=e||this.#j,this.#I.showPopover(),e&&this.#D&&pe(this.#I,this.#j,this.#D,!0),this.#D&&this.#D.classList.add("active")}hide(){this.#I.hidePopover(),this.#D&&this.#D.classList.remove("active")}toggle(){this.shown?this.hide():this.show()}removePositionStyles(){!function(e,t){for(const s of t)e.style.removeProperty(s);""===e.getAttribute("style")&&e.removeAttribute("style")}(this.#I,["inset"])}};class Be extends(Re()){static#S={showImmediately:!0,toggler:null,lightDismiss:!0,position:!1};#R=h({constructed:"constructed",destructed:"destructed"},"fundamentalStates");#p;#B;#F=[];#V;#$=!1;constructor(e,t={}){const s={...Be.defaultOptions,...t};super(e,s.toggler,s.position),this.options=s,this.#p=e,this.#p.popover="manual";const{showImmediately:n,toggler:i,lightDismiss:r}=this.options;if(n&&this.show(),i){const t=[()=>{e.isConnected?this.toggle():i.removeEventListener("click",...t)}];this.#F.push({type:"click",args:t,el:i})}r&&j.register((t=>{const s=t.target.shadowRoot?t.composedPath()[0]:t.target;this.#$?this.#$=!1:e.contains(s)||!this.shown||i&&i.contains(s)||this.hide()}),{capture:!0,passive:!0}),this.#K()}get fundamentalStates(){return this.#R}get fundamentalState(){return this.#V}static get defaultOptions(){return Be.#S}#K(){this.#p.id||(this.#B=function(e,t,s,n){const i=te(t,s,n);return e.id=i,i}(this.#p,"popover"));for(const{type:e,args:t,el:s}of this.#F)s.addEventListener(e,...t),"click"===e&&s!==document&&s!==document.body&&s.classList.add("clickable");this.#V=this.#R.constructed}#U(){this.#p.removeAttribute("popover");for(const{type:e,args:t,el:s}of this.#F)s.removeEventListener(e,...t),"click"===e&&s!==document&&s!==document.body&&s.classList.remove("clickable");this.#B&&this.#p.removeAttribute("id"),this.removePositionStyles(),this.#V=this.#R.destructed}toggleFundamentals(){this.#V===this.#R.constructed?this.#U():this.#K()}suspendNextLightDismiss(){this.#$=!0}}class Fe extends(Re()){static#S={title:null,position:!1,relative:null,toggler:null,onClose:void 0,includeCloseButton:!0,classes:["popup"]};#p;#k;#q;constructor(e,t={}){t=function(e,t,s=[]){const n={...e,...t};for(const i of s)Object.hasOwn(t,i)&&Object.hasOwn(e,i)&&(Array.isArray(t[i])&&Array.isArray(e[i])?n[i]=[...e[i],...t[i]]:"object"==typeof t[i]&&"object"==typeof e[i]&&(n[i]={...e[i],...t[i]}));return n}(Fe.#S,t,["classes"]);const[s,n]=Fe.createCarcass(t.title,{includeCloseButton:t.includeCloseButton,classes:t.classes});super(s,t.relative,t.position),this.#k=t,this.#p=s,n.body.prepend(e),document.body.append(s);const i={lightDismiss:!1,showImmediately:!1,position:t.position};t.toggler&&(i.toggler=t.toggler),this.manualPopup=new Be(s,i),this.area=new Ie(n.body),this.#q=n.body,n.closeButton&&n.closeButton.addEventListener("click",(()=>{this.close()}))}static get defaultOptions(){return Object.assign({},this.#S)}get body(){return this.#q}close(){"function"!=typeof this.#k.onClose?this.hide():this.#k.onClose.call(this)}remove(){this.area.close(),this.#p.remove()}static createCarcass(e,{includeCloseButton:t=!0,classes:s}){const n={},i=[];e&&i.push({node:Q("h1",{text:e,classes:["popup-title"]}),ref:"title"}),t&&i.push({node:_("Close",["popup-close-button"]),ref:"closeButton"});return[Q("div",{classes:s,elems:[{tag:"header",options:{classes:["popup-header"],elems:i}},{tag:"div",options:{classes:["popup-body"]},ref:"body"}]},n),n]}}class Ve extends Ce{static#M=h({regular:"regular",toggle:"toggle",longpress:"longpress"},"menuTypes");#H;#W;#g;#z;#Q;#_={toggle:{},longpress:{}};#G={key:void 0,value:void 0};constructor({headingText:e="Menu",type:t=Ve.types.regular,classes:s=[],host:n=document.documentElement,includeCloseButton:i=!0,useTypeClasses:r=!0,closeOnButtonClick:a=!0,selectValue:o=!1}={}){s.includes("menu")||s.push("menu"),r&&s.push(`menu-${t.name}`),o&&s.push("selectable");const l=Q("div",{classes:s});super(l),this.#H=new Oe,this.host=n,this.includeCloseButton=i,this.closeOnButtonClick=a,this.selectValue=o,this.#z=Ve.createHeadingElement({type:t.name,text:e}),this.#Q=e,this.#W=Q("div",{classes:["group-holder"],elems:[this.#H.element]}),l.append(this.#z,this.#W),this.setType(t),this.constrainAttributeToList("data-type",Ve.#M,(()=>this.#g),(e=>{this.setType(e)})),this.#H.addCountAttrTo(l);(new ke).observe(this.#H.element,[l]),this.addEventListener("typechange",(e=>{const{oldType:t,newType:s}=e.detail;ie(l,`menu-${t.name}`),l.classList.add(`menu-${s.name}`)}))}get list(){return this.#H}get type(){return this.#g}static get types(){return Ve.#M}get headingElement(){return this.#z}set headingText(e){this.#z.innerText=e}get headingText(){return this.#z.innerText}prepend(e,t,{keyToDataset:s,keyToClasses:n,listItemClasses:i}={}){return"button"===e.localName&&this.#J(e,t),this.#H.prepend(e,t,{keyToDataset:s,keyToClasses:n,classes:i})}prependButton(e,t,{classes:s=[]}={}){const n=_(e,s);return[...this.prepend(n,t),n]}append(e,t,{keyToDataset:s,keyToClasses:n,listItemClasses:i}={}){return e instanceof Element&&"button"===e.localName&&this.#J(e,t),this.#H.append(e,t,{keyToDataset:s,keyToClasses:n,classes:i})}appendButton(e,t,{classes:s=[]}={}){const n=_(e,s);return[...this.append(n,t),n]}insert(e,t,s,{keyToDataset:n,keyToClasses:i,listItemClasses:r}={}){return"button"===e.localName&&this.#J(e,s),this.#H.insert(e,t,s,{keyToDataset:n,keyToClasses:i,classes:r})}insertButton(e,t,s){const n=_(e);return this.#J(n,s),[...this.insert(n,t,s),n]}remove(e){return this.#H.remove(e)}getListItem(e){return this.#H.getItem(e)}getButton(e){return this.getListItem(e)?.querySelector("button")}*buttons(){for(const e of this.#H.items())yield e?.querySelector("button")}#J(e,t){e.addEventListener("click",(()=>{if(this.closeOnButtonClick&&this.closePopover(),this.selectValue){const{value:s,key:n}=this.#G;this.headingText=e.innerText,this.dispatchEvent(new CustomEvent("changeselectvalue",{detail:{oldValue:s,newValue:this.headingText,oldKey:n,newKey:t}})),this.#G={value:this.headingText,key:t}}}))}closePopover(){this.#g&&Object.hasOwn(this.#_,this.#g.name)&&Object.hasOwn(this.#_[this.#g.name],"popover")&&this.#_[this.#g.name].popover.hide()}setType(e){if(e===this.#g)return;if(this.#g)switch(this.#g){case Ve.types.toggle:{this.#_.toggle.popover.toggleFundamentals();const e=Ve.createHeadingElement({type:"regular",text:this.headingText});this.#z.replaceWith(e),this.#z=e,this.#_.toggle.closeButton&&this.#_.toggle.closeButton.remove();break}case Ve.types.longpress:Se.disable("longpress",this.host),this.#_.longpress.popover.toggleFundamentals(),this.#_.longpress.listener.remove(),this.#_.longpress.closeButton&&this.#_.longpress.closeButton.remove()}const t=()=>_("Close",["close-button"]);switch(e){case Ve.types.toggle:{const e=Ve.createHeadingElement({type:"toggle",text:this.headingText});if(this.#z.replaceWith(e),this.#z=e,this.#_.toggle.popover=new Be(this.#W,{toggler:this.#z,position:"BL",showImmediately:!1}),this.includeCloseButton){const e=t();this.#W.prepend(e),e.addEventListener("click",(()=>{this.#_.toggle.popover.hide()})),this.#_.toggle.closeButton=e}break}case Ve.types.longpress:if(Se.register(xe),Se.enable("longpress",this.host),this.#_.longpress.popover=new Be(this.element,{showImmediately:!1}),!this.#_.longpress.listener){const e={type:"longpress",args:[e=>{const{baseEvent:t}=e.detail;this.#_.longpress.popover.suspendNextLightDismiss(),this.#_.longpress.popover.show(),ge(this.element,t.x,t.y)}]};this.#_.longpress.listener=new Pe({longpress:e},this.host)}if(this.#_.longpress.listener.add(),this.includeCloseButton){const e=t();this.#z.after(e),e.addEventListener("click",(()=>{this.#_.longpress.popover.hide()})),this.#_.longpress.closeButton=e}}const s=this.#g;this.#g=e,this.dispatchEvent(new CustomEvent("typechange",{detail:{oldType:s,newType:e}})),this.element.setAttribute("data-type",e.value)}select(e){if(this.selectValue){const t=this.getButton(e);if(t){const{value:s,key:n}=this.#G;this.headingText=t.innerText,this.dispatchEvent(new CustomEvent("changeselectvalue",{detail:{oldValue:s,newValue:this.headingText,oldKey:n,newKey:e}})),this.#G={value:this.headingText,key:e}}}}resetSelect(){if(this.selectValue){const{value:e,key:t}=this.#G;this.headingText=this.#Q,this.dispatchEvent(new CustomEvent("changeselectvalue",{detail:{oldValue:e,newValue:void 0,oldKey:t,newKey:void 0}})),this.#G={value:void 0,key:void 0}}}static createHeadingElement({type:e="regular",text:t="Menu",classes:s=[]}={}){return"toggle"===e?_(t,["heading",...s]):Q("span",{text:t,classes:["heading",...s]})}}const $e=({parentConstructor:e=EventTarget,statuses:t,defaultStatus:s,buildIsMethods:n=!0,privateMethods:i}={})=>class extends e{#X;constructor(...e){if(super(...e),"object"==typeof i&&(i.changeStatus=this.#Y.bind(this),i.setStatus=this.#Z.bind(this)),this.#Z(s),n)for(const[e,s]of Object.entries(t)){const t=`is${r=e,r.charAt(0).toUpperCase().concat(r.slice(1))}`;Object.defineProperty(this,t,{get:()=>this.#X===s})}var r}get statuses(){return t}get statusNames(){return Object.keys(t)}get status(){return this.#X}#Z(e){u(e,t._name),this.#X=e}#Y(e,{details:s={}}={}){if(u(e,t._name),e!==this.#X){const t=this.#X;this.#X=e,"dispatchEvent"in this&&this.dispatchEvent(new CustomEvent("statuschange",{detail:{...s,newStatus:e,oldStatus:t}}))}}addStatusAttrTo(e,{datasetPropName:t="status"}={}){L(e,Element);const s=`data-${t}`;e.setAttribute(s,"");const n=e.getAttributeNode(s);return this.updateStatusOnAttr(n),n}updateStatusOnAttr(e){L(e,Attr),e.value=this.#X.name,this.addEventListener("statuschange",(t=>{e.value=t.detail.newStatus.name}))}updateStatusText(e,t){e.textContent=this.#X.value,N(this.#X.value,t,e),this.addEventListener("statuschange",(s=>{const{newStatus:n}=s.detail;e.textContent=n.value,N(n.value,t,e)}))}};class Ke extends Ce{#ee=new Map;#te=new WeakSet;constructor(e=[]){const t=Q("dl",{classes:e});super(t),ee(t,(({addedNodes:e,removedNodes:t})=>{if(e.length){let t=null,s=!1,n=0;for(const i of e.values())if(s)this.#te.add(i),i.remove();else if("DT"!==i.tagName&&"DD"!==i.tagName)i.remove(),s=!0;else if(n++,Me(n)){if("DT"===i.tagName)t=i;else if(!this.getByDetails(i)){this.#te.add(i),i.remove(),s=!0;continue}}else if(n%2==0){if("DD"!==i.tagName){this.#te.add(i),i.remove(),s=!0;continue}this.#ee.has(t)||this.#ee.set(t,{details:i}),t=null}null===t||this.#ee.has(t)||(this.#te.add(t),t.remove(),t=null)}if(t.length)for(const e of t.values()){const t=e.tagName;if("DT"===t||"DD"===t)if(this.#te.has(e))this.#te.delete(e);else if("DT"===t){if(this.#ee.has(e)){const{details:t}=this.#ee.get(e);this.#ee.delete(e),this.#te.add(t),t.remove()}}else for(const[t,{details:s}]of this.#ee.entries())if(s===e){this.#ee.delete(t),this.#te.add(t),t.remove();break}}this.revisit()})),this.revisit()}get count(){return this.element.children.length/2}revisit(){this.element.setAttribute("data-count",this.count)}prependPair(e,t,{name:s,termClasses:n,detailsClasses:i}={}){const[r,a]=this.constructor.createPair(e,t,{termClasses:n,detailsClasses:i}),o={details:a};return s&&(o.name=s,r.dataset.name=s),this.#ee.set(r,o),this.element.prepend(r,a),[r,a]}appendPair(e,t,{name:s,termClasses:n,detailsClasses:i}={}){const[r,a]=this.constructor.createPair(e,t,{termClasses:n,detailsClasses:i}),o={details:a};return s&&(o.name=s,r.dataset.name=s),this.#ee.set(r,o),this.element.append(r,a),[r,a]}insertPair(e,t,s,{name:n,termClasses:i,detailsClasses:r}={}){const[a,o]=this.constructor.createPair(e,t,{termClasses:i,detailsClasses:r}),l={details:o};return n&&(l.name=n,a.dataset.name=n),this.#ee.set(a,l),s*=2,G(this.element,a,s),G(this.element,o,s+1),[a,o]}getByTerm(e){if(this.#ee.has(e)){const{details:t}=this.#ee.get(e);return[e,t]}return null}getByName(e){for(const[t,{name:s,details:n}]of this.#ee.entries())if(s===e)return[t,n];return null}getByDetails(e){for(const[t,{details:s}]of this.#ee.entries())if(s===e)return[t,e];return null}delete(e){for(const[t,{name:s,details:n}]of this.#ee.entries())if(s===e)return this.#ee.delete(t),t.remove(),n.remove(),!0;return!1}static createTerm(e,{classes:t}={}){return Q("dt",{text:e,classes:t})}static createDetails(e,{classes:t}={}){const s={classes:t};return e instanceof Node?s.elems=[e]:s.text=e,Q("dd",s)}static createPair(e,t,{termClasses:s,detailsClasses:n}={}){return[Ke.createTerm(e,{classes:s}),Ke.createDetails(t,{classes:n})]}static fromItems(e,t,{classes:s=[]}={}){const n=new Ke(s);for(const s of e)if("object"==typeof s&&"title"in s&&"value"in s){const[e]=n.appendPair(s.title,s.value,{name:s.name,termClasses:s.termClasses,detailsClasses:s.detailsClasses});"ref"in s&&(t[s.ref]=e)}return n}}class Ue extends Ce{#H;constructor(e,t=[]){const s=Q("nav",{classes:t});super(s),this.#H=new Oe,s.append(this.#H.element),e&&s.prepend(Q("span",{text:e,classes:["heading"]}))}get list(){return this.#H}prepend(e,t){return this.#H.prepend(e,t)}append(e,t){return this.#H.append(e,t)}insert(e,t,s){return this.#H.insert(e,t,s)}remove(e){return this.#H.remove(e)}appendHyperlink(e,t,s,{hyperlinkBuilder:n=D}={}){const i=n.buildHyperlink(e,t);return[i,...this.append(i,s)]}static fromSchema(e,{hyperlinkBuilder:t=D,heading:s="Navigation",classes:n=[]}={}){const i=new Ue(s,n);for(const[s,n]of Object.entries(e)){const e=t.buildHyperlink(n.url,n.title);i.append(e,s)}return i}}class qe extends Ce{constructor(e,{classes:t=[],headingLevel:s=m.two,includeStory:n=!1}={}){const i={},[r]=qe.createCarcass(e,{classes:t,headingLevel:s,includeStory:n,refs:i});super(r);for(const[e,t]of Object.entries(i))Object.defineProperty(this,e,{get:()=>t})}changeTitle(e){this.heading.innerText=e}addFooter(){if(this.footer)return this.footer;{const e=Q(...Object.values(this.constructor.getFooterSchema()));return this.element.append(e),this.footer=e,e}}insert(e){return e instanceof Ce&&(e=e.element),this.footer?this.element.insertBefore(e,this.footer):this.element.append(e),e}insertIntoStory(e){if(!this.story)throw new DOMException("Story component is not available");e instanceof Ce&&(e=e.element),this.story.append(e)}static getHeaderSchema(e,t){return Ce.getStandardHeaderSchema(e,{classes:["article-header"],headingLevel:t,headingClasses:["article-heading"]})}static getFooterSchema(){return Ce.getStandardFooterSchema(["article-footer"])}static createCarcass(e,{classes:t=[],attrs:s,headingLevel:n=m.two,includeFooter:i=!1,includeStory:r=!1,refs:a={}}={}){const[o,l]=Ce.createStandardCarcass(qe,"article",e,{classes:t,attrs:s,headingLevel:n,includeFooter:i,refs:a});if(r){const e=Q("div",{classes:["story"]});o.firstElementChild.after(e),l.story=e}return[o,l]}static fromSchema(e,{hyperlinkBuilder:t}={}){const s=new qe(e.title);if("message"in e){const t=Q("p",{text:e.message});s.insert(t)}if("data"in e){const t=new Ke;for(const[s,n]of Object.entries(e.data))"value"in n&&t.appendPair(s,n.value,{name:s});0!==t.element.children.length&&s.insert(t)}if("navigation"in e){Ue.fromSchema(e.navigation,{hyperlinkBuilder:t,heading:"Article Navigation"}).appendTo(s.addFooter())}return s}}const He=(()=>{let e=0;const t=h({pending:"Pending",running:"Running",aborted:"Aborted",failed:"Failed",completed:"Completed"},"processStatuses"),s={},n=$e({statuses:t,defaultStatus:t.pending,privateMethods:s});return class extends n{#se;#Y;#k;#N;#ne;#ie;#re;#ae;#oe;#le;#ce=!1;constructor(t,n,i={}){if(super(),this.#Y=s.changeStatus,e++,this.#se=e,this.#k={...this.constructor.defaultOptions,...i},this.name=t||`process${this.#se}`,this.title=n||`Process #${this.#se}`,this.#k.handle){const[e,t]=this.constructor.unpackHandle(this.#k.handle);this.#N=e,this.#ne=t}this.#ne&&this.#ne.addEventListener("abort",(e=>{if(this.isRunning){const t=e.target.reason;"object"==typeof t&&t instanceof w||this.abort(t)}})),document.dispatchEvent(new CustomEvent("processregister",{detail:{process:this}})),this.#k.supportsProgress&&(this.#re=0)}get id(){return this.#se}get keyPath(){return"id"}static get defaultOptions(){return{handle:void 0,timeout:void 0,category:"regular",supportsProgress:!1}}get options(){return Object.assign({},this.#k)}static get statuses(){return t}get startTime(){return this.#ie}get endTime(){return this.#ae}get timeTaken(){return this.#oe}get abortController(){return this.#N}get signal(){return this.#ne}get progressNumber(){return this.#re}get isEnded(){return this.#ce}get category(){return this.#k.category}get details(){return this.#k.details}start(){if(!this.isPending)throw new DOMException("Only pending process can be started","ProcessError");this.#ie=performance.now(),void 0!==this.options.timeout&&this.#N&&(this.#le=setTimeout((()=>{this.#N.abort(new C("The operation timed out"))}),this.options.timeout)),this.#Y(t.running,{details:{startTime:this.#ie}}),this.dispatchEvent(new CustomEvent("start",{detail:{process:this,startTime:this.#ie}}))}progress(e){if(!this.isRunning)throw new DOMException("Only running process can receive progress updates","ProcessError");e=Math.floor(e),this.#re=e,this.dispatchEvent(new CustomEvent("progress",{detail:{progress:e}}))}abort(e){if(!this.isRunning)throw new DOMException("Only running process can be aborted","ProcessError");const s=new P("Aborted by application");e||(e=s),this.#he(),this.#Y(t.aborted,{details:{reason:e}}),this.#N&&!this.#N.signal.aborted&&this.#N.abort(s),this.#de()}stopTimeout(){if(!this.#le)return null;clearTimeout(this.#le)}#he(){if(!this.isRunning)throw new DOMException("Process is not running","ProcessError");void 0!==this.#le&&clearTimeout(this.#le),this.#ae=performance.now(),this.#oe=this.#ae-this.#ie}#de(){this.#ce=!0,this.dispatchEvent(new CustomEvent("ended",{detail:{status:this.status,startTime:this.#ie,endTime:this.#ae,timeSpent:this.#oe}}))}fail(e){if(!this.isRunning)throw new DOMException("Only running process can be failed","ProcessError");this.#he(),this.#Y(t.failed,{details:{error:e}}),this.#de()}failIfRunning(e){this.isRunning&&this.fail(e)}complete(){if(!this.isRunning)throw new DOMException("Only running process can be completed","ProcessError");this.#he(),this.#Y(t.completed,{details:{startTime:this.#ie,endTime:this.#ae,timeSpent:this.#oe}}),this.#de()}toArticle({search:e}){const s={},n=Ke.fromItems([{name:"status",title:"Status",value:this.status.value,ref:"statusEl"},{name:"id",title:"ID",value:this.#se,ref:"idEl"}],s),i=new qe(this.title,{classes:["process-info"],headingLevel:m.three});N(this.title,e,i.heading),N(String(this.#se),e,s.idEl.nextElementSibling),i.insert(n.element);const r=new Ve({headingText:"Controls",host:i.element});i.element._menu=r,i.insert(r.element);const a=()=>{if(r.list.has("abort"))r.list.reattachItem("abort");else{const e=_("Abort");e.addEventListener("click",(()=>{this.abort("Aborted by user")})),r.append(e,"abort")}};this.#N&&this.isRunning&&a();const{statusEl:o}=s;let l,c;N(this.status.value,e,o.nextElementSibling),this.addEventListener("statuschange",(s=>{const{newStatus:i}=s.detail;switch(o.nextElementSibling.innerText=i.value,N(i.value,e,o.nextElementSibling),i){case t.running:this.#N&&a();break;case t.aborted:{const e=void 0!==s.detail.reason?s.detail.reason.message||s.detail.reason:"N/A";n.appendPair("Abort reason",e);break}case t.failed:n.appendPair("Error",s.detail.error.message??s.detail.error);break;case t.completed:c&&(c.innerText="100%")}r.list.has("abort")&&i!==t.running&&r.list.detachItem("abort")}));const h=e=>{l||([l,c]=n.appendPair("Progress",`${e}%`))};return void 0!==this.#re&&h(this.#re),this.addEventListener("progress",(e=>{const t=e.detail.progress;l?c.innerText=`${t}%`:h(t)})),n.appendPair("Category",this.category),i}toElementRepresentative({search:e}={}){return this.toArticle({search:e})}toElement({search:e}={}){return this.toArticle({search:e}).element}attachToElement(e,t="popover"){let s,n;const i=[i=>{i.preventDefault(),i.stopImmediatePropagation(),s?"popover"===t?n.toggle():re(s)?ae(s):e.insertAdjacentElement("afterend",s):(s=this.toElement(),e.insertAdjacentElement("afterend",s),"popover"===t&&(n=new Be(s,{toggler:e,position:"BL"})))},!0],r=e.classList.contains("clickable");r||e.classList.add("clickable"),e.addEventListener("click",...i),this.addEventListener("ended",(()=>{e.removeEventListener("click",...i),s&&s.remove(),r||ie(e,["clickable"])}))}createInfoToggler({removeOnEnd:e=!0,togglingMethod:s="popover",tag:n="div"}={}){const i=e=>e===t.running?e.value.concat("..."):e.value,r=Q(n,{text:i(this.status),classes:["compact-process-info"]});return r.setAttribute("data-status",this.status.name),this.addEventListener("statuschange",(e=>{const{newStatus:t}=e.detail;r.setAttribute("data-status",t.name),r.innerText=i(t)})),this.addEventListener("ended",(()=>{e&&r.remove()})),r.setAttribute("data-process",this.#se),r.setAttribute("data-process-name",this.name),this.attachToElement(r,s),r}delayedInfoToggler(e,{delay:t=250,removeOnEnd:s=!0,adjacency:n=p.afterend,tag:i="div"}={}){if(L(e,Element),!this.#ce||!s){let r=!1;const a=Ie.attachedTimeout(e,t);a.then((()=>{r=!0;const t=this.createInfoToggler({removeOnEnd:s,tag:i});e.insertAdjacentElement(n.name,t)})).catch((e=>{if(!Ne.isPromiseAbortException(e))throw e})),this.addEventListener("ended",(()=>{r||a.cancel()}))}}attachedClassToggling(e,{className:t="process-running",delay:s=0}={}){const n=()=>{e.classList.add(t)};let i,r;0===s?n():(i=!1,r=Ie.attachedTimeout(e,s),r.then((()=>{i=!0,n()})).catch((e=>{if(!Ne.isPromiseAbortException(e))throw e}))),this.addEventListener("ended",(()=>{ie(e,[t]),void 0===r||i||r.cancel()}))}toGroupMember({search:e}){return this.toElement({search:e})}toElementChunks({search:e,chunkList:t}={}){const s={id:t=>{I(t,"#".concat(this.id),e)},name:t=>{I(t,this.name,e)},title:t=>{I(t,this.title,e)},status:t=>{I(t,this.status.value,e),this.addEventListener("statuschange",(s=>{const{newStatus:n}=s.detail;I(t,n.value,e)}))},details:t=>{I(t,this.#k.details||"N/A",e)}};if(R(t)){const e={};for(const n of Object.keys(t))Object.hasOwn(s,n)&&(e[n]=s[n]);return e}return s}toItem(){return{id:this.#se,name:this.name,title:this.title,status:this.status.value,details:this.#k.details||"N/A"}}static get chunkNames(){return{id:"ID",name:"Name",title:"Title",status:"Status",details:"Details"}}static get sortValues(){return{id:"ID",name:"Name",title:"Title",status:"Status",details:"Details"}}static wrapAroundPromise(e,t){L(e,Promise);const s=new He(...t);return s.start(),He.processToResolvers(s,e),s}static unpackHandle(e){let t,s;return e instanceof AbortController?(t=e,s=e.signal):e instanceof AbortSignal&&(s=e),[t,s]}static wrapAroundPromiseSeries(e,t,{promiseSeriesOnPerform:s,promiseSeriesOnFinally:n}={}){t.length>2?t[2].supportsProgress=!0:t.push({supportsProgress:!0});const i=new He(...t);i.start(),i.progress(0);const r=M(e,{signal:i.signal,onPerform:(e,t)=>{const n=e/t*100;i.progress(n),"function"==typeof s&&s()},promiseSeriesOnFinally:n});return He.processToResolvers(i,r),[i,r]}static processToResolvers(e,t){if(!e.isRunning)throw new DOMException("Process must be running","ProcessError");t.then((()=>{e.isRunning&&e.complete()})).catch((t=>{e.isRunning&&("AbortError"!==t.name?e.fail(t):e.abort(t))}))}}})();class We extends EventTarget{#ue;#me;#pe;#ge;constructor({total:e,perPage:t,page:s,autoAdjustPage:n=!0}={}){We.validatePage(s,e,t),super(),this.#ue=e,this.#me=t,this.#pe=s,this.#ge=n}set total(e){if(e<0)throw new TypeError("Total number cannot be negative");if(e!==this.#ue){const t=this.#ue;if(this.#ue=e,this.dispatchEvent(new CustomEvent("totalchange",{detail:{newTotal:e,oldTotal:t}})),!T(this.#pe)&&!T(this.#me))try{We.validatePage(this.#pe,e,this.#me)}catch(t){if(this.#ge&&t instanceof RangeError){const t=We.getMaxPage(e,this.#me);this.page=t}}}}get total(){return this.#ue}set perPage(e){if(e<=0)throw new TypeError("Per page number must be positive");if(e!==this.#me){const t=this.#me;if(this.#me=e,this.dispatchEvent(new CustomEvent("perpagechange",{detail:{newPerPage:e,oldPerPage:t}})),!T(this.#ue)&&!T(this.#pe))try{We.validatePage(this.#pe,this.#ue,e)}catch(t){if(this.#ge&&t instanceof RangeError){const t=We.getMaxPage(this.#ue,e);this.page=t}}}}get perPage(){return this.#me}set page(e){if(e!==this.#pe){try{We.validatePage(e,this.#ue,this.#me)}catch(t){if(!(this.#ge&&t instanceof RangeError))throw t;e=We.getMaxPage(e,this.#me)}const t=this.#pe;this.#pe=e,this.dispatchEvent(new CustomEvent("pagenumberchange",{detail:{newPageNumber:e,oldPageNumber:t}}))}}get page(){return this.#pe}get pageCount(){return Math.ceil(this.#ue/this.#me)}get maxPage(){return We.getMaxPage(this.#ue,this.#me)}get hasNextPage(){return this.#pe<We.getMaxPage(this.#ue,this.#me)}get hasPreviousPage(){return this.#pe>1}get isFirstPage(){return 1===this.#pe}get isLastPage(){return this.#pe===this.maxPage}get offsetStart(){return(this.#pe-1)*this.#me}get offsetEnd(){const e=this.#pe*this.#me;return e>this.#ue?this.#ue:e}get nextPage(){if(this.hasNextPage)return this.#pe+1}get previousPage(){if(this.hasPreviousPage)return this.#pe-1}get params(){return{total:this.#ue,perPage:this.#me,pageNumber:this.#pe}}calculateVisiblePageRange({size:e=5,orientation:t=y.right}={}){return We.calculateVisiblePageRange(this.#pe,this.pageCount,{size:e,orientation:t})}static getMaxPage(e,t){return Math.ceil(e/t)}static getLastPageIfMax(e,t,s){const n=We.getMaxPage(t,s);return e>n?n:e}static validatePage(e,t,s){if(e<0)throw new TypeError("Page number cannot be negative");if(t&&0===e)throw new RangeError("Page number cannot be 0 when total is defined and positive");const n=We.getMaxPage(t,s);if(e>n)throw new RangeError(`Page number cannot exceed ${n}, got ${e}`)}static calculateVisiblePageRange(e,t,{size:s=5,orientation:n=y.right}={}){let i,r,a;switch(n){case y.right:if(i=e,r=Math.min(e+s-1,t),a=r-i+1,a<s){const e=s-a;i=Math.max(i-e,1)}break;case y.left:if(i=Math.max(e-s+1,1),r=e,a=r-i+1,a<s){const e=s-a;r=Math.min(r+e,t)}break;case y.center:{const n=s/2;let o=Me(s)?Math.floor(n):n-1,l=Me(s)?Math.floor(n):n;if(i=Math.max(e-o,1),r=Math.min(e+l,t),a=r-i+1,a<s){const n=s-a;t-e>=s?r=Math.min(r+n,t):i=Math.max(i-n,1)}}}return[i,r]}}class ze{constructor(e){if("object"!=typeof e||null===e)throw new TypeError("Given value must be an object");this.value=e,this.arrayIterator="entries"in e.constructor.prototype?e.entries():Object.entries(e)}*[Symbol.iterator](){for(const[e,t]of this.arrayIterator)yield[e,t]}}function Qe(e,t,{keepOriginal:n=!1}={}){if(!t)return e;if(T(e))return null;if("string"==typeof e){const n=s(e,t,"mark",!0,!0);return n instanceof DocumentFragment?n:null}if("trackCriteria"in e){return e.trackCriteria({search:t}).isMatch?e:null}{"toItem"in e&&(e=e.toItem());let i=0;const r=Object.create(null);for(let[a,o]of new ze(e)){const e=o,l=typeof o;if("string"===l||"number"===l){o=String(o);const l=s(o,t,"mark",!0,!0);l instanceof DocumentFragment&&(r[a]=n?{rawValue:e,value:l}:l,i++)}a in r||(r[a]=e)}return 0===i?null:r}}class _e extends EventTarget{#fe;constructor(e,{protectedMethods:t={}}={}){super(e),this.#fe=e,Object.assign(t,{dispatchAddEvent:this.#be,dispatchDeleteEvent:this.#ve,dispatchDeleteManyEvent:this.#ye,dispatchDeleteNotFoundEvent:this.#Ee})}*[Symbol.iterator](){for(const[e,t]of this.store.entries())yield[e,t]}get store(){return this.#fe}get size(){return this.store.size}get isDense(){return!1}getSize(){return this.size}applySearchParams(e,{appliedParams:t={}}={}){let s,n,i=[];const r=new Map,a=e=>{n=e.keyPath;const t=e[n];return r.set(t,e),[t,e.toItem()]};for(const[n,r]of this){const o=typeof r;if(e.search){const s=Qe(r,e.search,{keepOriginal:!0});null!==s&&(s instanceof DocumentFragment?i.push([n,{result:s,value:r}]):"toItem"in r?i.push(a(r)):i.push([n,s])),t.search=e.search}else"object"===o&&"toItem"in r?i.push(a(r)):i.push([n,r]);void 0===s&&"object"===o&&(s=!0)}const o=i.length;if(0===o)return{result:i,total:o,appliedParams:t};let l,c=0;if(e.perPage&&e.page&&(l=new We({total:o,perPage:e.perPage,page:We.getLastPageIfMax(e.page,o,e.perPage)}),c=l.offsetStart,c>=o))return{result:[],total:o,appliedParams:t};if(e.order){let n;if(s)e.sort&&(n=function({sortCriteria:e,path:t,isPairs:s=!1}={}){return function(n,i){const r=e.split(",").map((e=>e.trim()));for(let e of r){const[r,a]=e.split(" "),o="DESC"===a?-1:1,l=s?n[1]:n,c=s?i[1]:i;let h=l[r],d=c[r];if(t&&(h=l[r][t]||l[r],d=c[r][t]||c[r]),"string"==typeof h&&"string"==typeof d){const e=String(h).localeCompare(String(d),void 0,{sensitivity:"base"});if(0!==e)return e*o}else{if(h=parseFloat(h),d=parseFloat(d),h<d)return-1*o;if(h>d)return 1*o}}return 0}}({sortCriteria:`${e.sort} ${e.order.toUpperCase()}`,path:"rawValue",isPairs:!0}));else if("asc"===e.order||"desc"===e.order){const t=e.order.toLowerCase();n=function({direction:e=v.asc,path:t,isPairs:s=!1}={}){return u(e,"sortDirection"),(n,i)=>{s&&Array.isArray(n)&&Array.isArray(i)&&(n=n[1],i=i[1]);let r=e===v.asc?n:i,a=e===v.asc?i:n;return isNaN(n)||isNaN(i)?(t&&"object"==typeof r&&"object"==typeof a&&(r=r[t]||r,a=a[t]||a),String(r).localeCompare(String(a))):r-a}}({direction:v[t],path:"rawValue",isPairs:!0})}n&&(i.sort(n),t.order=e.order,e.sort&&(t.sort=e.sort))}if(l){const s=l.offsetEnd;(0!==c||s<o)&&(i=i.slice(c,s)),t.perPage=e.perPage,t.page=e.page}if(0!==r.size)for(const[e,[,t]]of i.entries())i[e][1]=r.get(t[n]);return{result:i,total:o,appliedParams:t}}#be(e,t={}){this.dispatchEvent(new CustomEvent("add",{detail:{...t,element:e}}))}#ve(e,t={}){this.dispatchEvent(new CustomEvent("delete",{detail:{...t,key:e}}))}#ye(e,t={}){this.dispatchEvent(new CustomEvent("deletemany",{detail:{...t,keys:e}}))}#Ee(e,t={}){this.dispatchEvent(new CustomEvent("deletenotfound",{detail:{...t,keys:e}}))}}const Ge=(e,{parentConstructor:t=_e}={})=>class extends t{#ve;#ye;constructor(...e){super(...e);const{dispatchDeleteEvent:t,dispatchDeleteManyEvent:s}=e[1].protectedMethods;this.#ve=t,this.#ye=s}delete(t,{reason:s}={}){const n=e(this.store,t);return n&&this.#ve(t,{total:this.getSize(),reason:s}),n}deleteMany(t,{reason:s}={}){const n={successKeys:[],errors:[],successCount:0,errorCount:0,notFoundKeys:[]};for(const s of t){const t=e(this.store,s);t?(n.successKeys.push(s),n.successCount++):null===t?n.notFoundKeys.push(s):(n.errors.push([s,new DOMException("Could not delete element")]),n.errorCount++)}return 0!==n.successCount&&this.#ye(n.successKeys,{total:this.getSize(),reason:s}),n}};function Je(e,t){L(e,[Map,Set]);const s=e.delete(t);return s||null}const Xe=({ElInterface:e=HTMLElement,internalsParamName:t="_internals",stopInnerInputPropagation:s=!0}={})=>class extends e{static formAssociated=!0;static validityFlags=["valueMissing","typeMismatch","patternMismatch","tooLong","tooShort","rangeUnderflow","rangeOverflow","stepMismatch","badInput","customError"];static observedAttributes=[...super.observedAttributes,"value"];#Ce="";#we;#Pe=[];constructor(){super(),this.internalsParamName=t,this[this.internalsParamName]=this.attachInternals(),s&&this.addEventListener("input",(e=>{e.composedPath()[0]!==this&&e.stopImmediatePropagation()}))}get internals(){return this[this.internalsParamName]}get form(){return this.internals.form}get name(){return this.getAttribute("name")}get valid(){return this.internals.checkValidity()}setValue(e,{state:t,inputType:s="",inputData:n,dispatchInputEvent:i=!0,dispatchValueChangeEvent:r=!0}={}){if("string"!=typeof e&&!T(e))throw new TypeError("Custom form element value must be either a string or nullish");if(void 0===e&&(e=null),e!==this.#Ce||t!==this.#we){const a=this.#Ce;this.internals.setFormValue(e,t),this.#Ce=e,this.#we=t,T(e)?this.constructor.isValueAssistive||this.removeAttribute("value"):this.setAttribute("value",e),r&&(this.#xe(e,a),this.dispatchEvent(new CustomEvent("valuechange",{detail:{newValue:e,oldValue:a}}))),i&&this.dispatchInputEvent({type:s,data:n})}}set value(e){this.setValue(e)}getValue(){return this.#Ce}get value(){return this.getValue()}get valueState(){return this.#we}getInputEvent({type:e="",data:t}={}){return new InputEvent("input",{bubbles:!0,cancelable:!1,inputType:e,data:t})}dispatchInputEvent({type:e="",data:t}={}){this.dispatchEvent(this.getInputEvent({type:e,data:t}))}addValueChangeCallback(e){if("function"!=typeof e)throw new TypeError("Callback must be a function");this.#Pe.push(e)}#xe(e,t){for(const s of this.#Pe)s({newValue:e,oldValue:t})}attributeChangedCallback(e,t,s){if(super.attributeChangedCallback(e,t,s),"value"===e)s===t||this.constructor.isValueAssistive||this.setValue(s)}connectedCallback(e){super.connectedCallback(e),this.classList.add("form-custom-element")}getValidityFlagIndex(e){const t=this.constructor.validityFlags.indexOf(e);return-1!==t?t:null}static buildValidityFlagsTemplate(){const e={};for(const t of this.validityFlags)e[t]=!1;return e}};class Ye extends EventTarget{#Ce;constructor(e){super(),this.#Ce=e}set value(e){if(e!==this.#Ce){const t=this.#Ce;this.#Ce=e,this.dispatchEvent(new CustomEvent("valuechange",{detail:{newValue:e,oldValue:t}}))}}get value(){return this.#Ce}}class Ze extends Ye{#Se;constructor(e){super(e),this.#Se=this.element,this.addEventListener("valuechange",(()=>{this.dispatchEvent(new CustomEvent("associatedformelementschange",{detail:{removedElements:[this.#Se],addedElements:[this.element]}})),this.#Se=this.element}))}get description(){return this.constructor.descriptionTemplate.format({elementId:this.elementId})}get element(){return this.value instanceof Element?this.value:document.getElementById(this.value)}get elementId(){return this.element.id||"associated-element"}get associatedFormElements(){return[this.element]}validate(e){const t=this.element;return!t.value||e==t.value||{customError:this.description}}static get errorMessageTemplate(){return a`Value must match the one provided in #${"elementId"}.`}static get descriptionTemplate(){return Ze.errorMessageTemplate}static get defaultFormElementAttrName(){return"matchvalue"}}class et extends EventTarget{static defaultOptions={remove:!0};#c={};#h=[];constructor(e,t,s={}){super(),this.config=e,this.excludeList=t,this.options={...this.constructor.defaultOptions,...s},this.reindex()}get length(){return this.#h.length}dispatchLengthChangeEvent(e){let t=null;0===e&&0!==this.#h.length?t=!0:0!==e&&0===this.#h.length&&(t=!1),null!==t&&this.dispatchEvent(new CustomEvent("lengthchange",{detail:{value:t}}))}reindex(){this.#h=[],this.#c=[];for(const[e,t]of Object.entries(this.config))this.addConfig(e,t)}#y(e,t,{nameAsKey:s=!0}={}){if(t.active&&!this.#h.includes(e)){const t=this.#h.length;this.#h.push(e),this.dispatchLengthChangeEvent(t)}if(this.menu)if(e in this.#c==!1){let n=_(t.text);n=t.obtainButton(n),this.options.remove||t.active||(n.disabled=!0);const i=[n,t.position];s&&i.push(e);const[,r]=this.menu.insert(...i);this.#c[e]=r}else{const t=this.#c[e];this.menu.list.getItem(t).firstElementChild.disabled=!1}}#E(e){const t=this.#h.length;if(fe(this.#h,e)&&this.dispatchLengthChangeEvent(t),this.menu){const t=this.#c[e];if(void 0!==t)if(this.options.remove)this.menu.remove(t),delete this.#c[e];else{this.menu.list.getItem(t).firstElementChild.disabled=!0}}}addConfig(e,t){t.connected=!1;!!this.excludeList.includes(e)||!t.active&&this.options.remove||(this.#y(e,t),t.connected=!0),Object.hasOwn(t,"init")&&(t.init((s=>{s!==t.active&&(t.active=s,s?this.excludeList.includes(e)||(this.#y(e,t),t.connected=!0):(this.#E(e),t.connected=!1))}),t),delete t.init)}updateExcludeList(e){be(this.excludeList,e)||(this.excludeList=e,this.menu&&this.menu.list.empty(),this.reindex())}hasMenu(){return void 0!==this.menu}getMenu({title:e="Controls",classes:t=[],host:s}={}){if(this.menu)return this.menu;const n=new Ve({headingText:e,classes:t,host:s});this.menu=n;const i=this.options.remove?B(this.config,(e=>this.#h.includes(e))):B(this.config,(e=>!this.excludeList.includes(e))),r=[];for(const[e,t]of Object.entries(i))t.name=e,r.push(t);r.length>1&&r.sort(Le("position"));for(const e of r)this.#y(e.name,e);return n}destroyMenu(){this.menu&&(this.menu.element.remove(),this.#c=[],this.menu=null)}updateOption(e,t){if("remove"===e){if("boolean"!=typeof t)throw new TypeError(`Option ${e} requires a value of boolean type`);this.options.remove!==t&&(this.menu&&this.menu.list.empty({emptyKeys:!0}),this.options.remove=t,this.reindex())}}}class tt extends(Xe({ElInterface:de({options:{observeStylesheet:!0}})})){static observedAttributes=[...super.observedAttributes,"name","id","label","description","required","disabled","controlsmenu","controlslist","controlsfilter","matchvalue"];container;constraints;oneTimeValidityState;errorList;static controlsModes=["off","always","toggle","toggle-if","longpress"];static controlsFilterModes=["none","active"];#ke;#Te;#Oe;#Me=[];#Le=!0;#Ae;#Ne;#Ie;constructor(){super(),this.addEventListener("valuechange",(e=>{const{newValue:t}=e.detail;""===t||T(t)?ie(this,["has-value"]):this.classList.add("has-value"),this.setValidity(),this.wasConnected&&this.reportValidity()})),this.constraints=this.getInternalConstraintsConfig(),this.container=this.shadowRoot,this.addAfterConnectedAttrCallback("controlsmenu",(e=>{this.constructor.controlsModes.includes(e)||(e="off"),this.setupControls({mode:e})})),this.addAfterConnectedAttrCallback("controlslist",(()=>{this.updateControlsList(),this.controlsManager&&this.controlsManager.updateExcludeList(this.#Me)})),this.addAfterConnectedAttrCallback("controlsfilter",(e=>{this.#De(e),this.controlsManager&&this.controlsManager.updateOption("remove",this.#Le)})),this.addAfterConnectedAttrCallback("description",(e=>{this.#je(e)}))}get id(){return this.hasAttribute("id")?this.getAttribute("id"):this.elementId}get elementId(){return"form-element"}get disabled(){return!!this.getAttribute("disabled")}attributeChangedCallback(e,t,s){switch(super.attributeChangedCallback(e,t,s),e){case"id":{let e;e=null!==s?s:this.elementId,this.#Ne&&this.#Ne.setAttribute("for",e),this.dispatchEvent(new CustomEvent("idchange",{detail:{id:e}}));break}case"label":this.#Re(s);break;case"disabled":{const e=this.getControlsManager();if(e.hasMenu()){const n=e.getMenu().headingElement;"button"===n.localName&&(null===t?n.disabled=!0:null===s&&(n.disabled=!1))}break}case"matchvalue":{const e=Ze.name;if(null===t&&null!==s)if(this.hasCustomConstraint(Ze.name))this.enableConstraint(e,s);else{const e=new Ze(s);this.setCustomConstraint(e,{attrName:"matchvalue"})}else if(null===s&&null!==t)this.disableConstraint(e);else{this.constraints[e].instance.value=s,this.setValidity(),this.reportValidity()}break}default:{const n=this.getConstraintByAttrName(e);if(n){const[e]=n;null===t&&null!==s?this.enableConstraint(e,s):null===s&&null!==t&&this.disableConstraint(e)}break}}}connectedCallback(){super.connectedCallback()}getInternalConstraintsConfig(){return{required:{type:"internal",attrName:"required",message:"Please fill out this field.",description:"This field is required.",flag:"valueMissing"}}}get controlsConfig(){return this.#Oe??=this.getControlsConfig(),this.#Oe}hasControl(e){const t=this.controlsConfig;return Object.hasOwn(t,e)}updateControlsList(){const e=this.getAttribute("controlslist");this.#Me=this.makeControlsList(e,!0)}getControlsManager(){return this.controlsManager||(this.updateControlsList(),this.controlsManager=new et(this.controlsConfig,this.#Me,{remove:this.#Le})),this.controlsManager}setControlsList(e){const t=e.join(",");this.setAttribute("controlslist",t)}makeControlsList(e,t=!1){if(!e)return[];const s=e.split(","),n=[];for(const e of s)if(e.startsWith("no")){const s=e.substring(2);t&&!this.hasControl(s)||n.push(s)}return n}setControlsFilter(e){return"none"!==e&&"active"!==e?null:(this.setAttribute("controlsfilter",e),!0)}#De(e){this.#Le="none"!==e&&"active"===e}setupControls({mode:e="toggle"}={}){if(!this.constructor.controlsModes.includes(e))throw new DOMException(`Mode ${e} is invalid`);if(e===this.#ke||this.#Te===e)return null;this.#Te=e;const t=this.getControlsManager(),s=()=>{const e=t.hasMenu(),s=t.getMenu({host:this});return s.isDetached&&this.container.appendChild(s.element),e||s.addEventListener("typechange",(e=>{const{newType:t}=e.detail;switch(t){case Ve.types.toggle:"toggle"!==this.#ke&&"toggle-if"!==this.#ke&&this.setupControls({mode:"toggle"});break;case Ve.types.longpress:"longpress"!==this.#ke&&this.setupControls({mode:"longpress"})}})),s},n=()=>{if(this.controlsManager&&this.controlsManager.hasMenu()){const e=this.controlsManager.getMenu({host:this});e.detach(),e.setType(Ve.types.regular)}},i=()=>{this.#Ae&&this.#Ae.abort()};let r;switch(e){case"off":i(),n();break;case"always":i(),r=s();break;case"toggle":i(),r=s(),r.setType(Ve.types.toggle);break;case"toggle-if":{i(),n();const e=()=>{t.length?(r=s(),r.setType(Ve.types.toggle)):n()};e();const a=new AbortController;this.#Ae=a,t.addEventListener("lengthchange",(()=>{e()}),{signal:a.signal});break}case"longpress":i(),r=s(),r.setType(Ve.types.longpress)}return this.#ke=e,this.setAttribute("controlsmenu",e),this.#Te=void 0,!0}changeName(e){this.setAttribute("name",e)}changeId(e){this.setAttribute("id",e)}changeLabel(e){this.setAttribute("label",e)}changeDescription(e){this.setAttribute("description",e)}get labelElement(){return this.#Ne}#Re(e){if(e)if(this.#Ne)this.#Ne.innerText=e;else{const t=function(e,t,s,{classes:n=[],className:i="clickable"}={}){const r=s??document,a={text:e,classes:n,attrs:{}};t&&(a.attrs.for=t);const o=Q("label",a);return o.addEventListener("mouseover",(()=>{if(o.hasAttribute("for")){const e=o.getAttribute("for"),t=r.getElementById(e);t&&!t.disabled&&o.classList.add(i)}})),o.addEventListener("mouseout",(()=>{o.classList.contains(i)&&ie(o,[i])})),o}(e,this.id,this.shadowRoot,{classes:["title"]});this.container===this.shadowRoot?this.#Ne=this.insertElementAfterStylesheets(t):this.#Ne=se(this.container,t)}else this.#Ne&&(this.#Ne.remove(),this.#Ne=void 0)}#je(e){if(e)if(this.#Ie)this.#Ie.innerText=e;else{const t=Q("p",{text:e}),[s]=function(e,t,{classes:s=[],open:n=!1}={}){const i={},r={tag:"summary",options:{text:e},ref:"summary"};let a;a=t instanceof Node?{node:t,ref:"contents"}:{text:String(t),ref:"contents"};const o={classes:s,elems:[r,a]};return n&&(o.attrs={open:""}),[Q("details",o,i),i]}("Description",t,{classes:["description"],open:!0});this.#Ie=this.shadowRoot.appendChild(s)}else this.#Ie&&(this.#Ie.remove(),this.#Ie=void 0)}get descriptionElement(){return this.#Ie}enableConstraint(e,t){if(T(t)&&(t=""),this.hasConstraint(e)){const s=this.constraints[e];Object.hasOwn(s,"attrName")&&this.getAttribute(s.attrName)!==t&&this.setAttribute(s.attrName,String(t)),"custom"===s.type&&(s.status=!0),this.setValidity()}}disableConstraint(e){if(this.hasConstraint(e)){const t=this.constraints[e];Object.hasOwn(t,"attrName")&&this.hasAttribute(t.attrName)&&this.removeAttribute(t.attrName),"custom"===t.type&&(t.status=!1),this.setValidity(),this.reportValidity()}}hasInternalConstraintEnabled(e){if(!this.hasInternalConstraint(e))return null;const t=this.constraints[e];return Object.hasOwn(t,"attrName")?null!==this.attributes.getNamedItem(t.attrName):null}writeValueToClipboard(){var e;e=this.value,new Promise(((t,s)=>{navigator.clipboard.writeText(e).then((()=>{const s=new CustomEvent("copytoclipboard",{detail:{text:e}});document.dispatchEvent(s),t(e)})).catch((t=>{const n=new CustomEvent("copytoclipboarderror",{detail:{text:e,error:t}});document.dispatchEvent(n),s(t,e)}))}))}getControlsConfig(){return{copy:{text:"Copy",active:""!==this.value,position:0,obtainButton:e=>(e.addEventListener("click",(()=>{this.writeValueToClipboard()})),e),init:(e,t)=>{this.addEventListener("input",(s=>{tt.hasValueStatusChange(s.target,t,e)}))}},reportvalidity:{text:"Report Validity",active:!this.valid&&!this.isReportingValidity(),position:0,obtainButton:e=>(e.addEventListener("click",(()=>{this.reportValidity()})),e),init:(e,t)=>{this.addEventListener("input",(()=>{t.connected&&this.valid?e(!1):t.connected||this.valid||this.isReportingValidity()||e(!0)})),this.addEventListener("validityshown",(()=>{t.connected&&e(!1)})),this.addEventListener("validationstatechange",(s=>{!1===s.detail.newState?t.connected||e(!0):t.connected&&e(!1)}))}}}}setCustomConstraint(e,{attrName:t,priority:s=1}={}){L(e,Ye);const n=e.constructor.name;if(this.hasCustomConstraint(n))throw new DOMException(`Constraint ${n} has already been set`,"DuplicateError");if(this.constraints[n]={type:"custom",attrName:t,instance:e,priority:s},t&&!tt.observedAttributes.includes(t)){const s=Z(this,t,(({newValue:t,oldValue:s})=>{null===s&&null!==t?this.enableConstraint(n,t):null===t&&null!==s?this.disableConstraint(n):(e.value=t,this.setValidity(),this.reportValidity())}));this.constraints[n].attrObserver=s}if("associatedFormElements"in e){const t=e.associatedFormElements;if(t){const s=[()=>{this.setValidity(),this.reportValidity()}];for(const e of t)e.addEventListener("input",...s);e.addEventListener("associatedformelementschange",(e=>{const{removedElements:t,addedElements:n}=e.detail;for(const e of t)e.removeEventListener("input",...s);for(const e of n)e.addEventListener("input",...s)}))}}this.enableConstraint(n,e.value)}removeCustomConstraint(e){if(!Object.hasOwn(this.constraints,e)||"custom"!==this.constraints[e])return null;const t=this.constraints[e];"attrObserver"in t&&t.attrObserver.disconnect(),delete this.constraints[e],this.setValidity()}*filterConstraintsConfig(e,t){for(const[s,n]of Object.entries(this.constraints))n[e]===t&&(yield[s,n])}hasConstraint(e,t){let s=Object.hasOwn(this.constraints,e);return!!s&&(t&&(s=this.constraints[e].type===t),s)}getConstraintByAttrName(e){const t=Array.from(this.filterConstraintsConfig("attrName",e));return 0!==t.length?t[0]:null}hasInternalConstraint(e){return this.hasConstraint(e,"internal")}hasCustomConstraint(e){return this.hasConstraint(e,"custom")}getCustomConstraintsSet(){const e=new Set;for(const[,t]of this.filterConstraintsConfig("type","custom"))!0===t.status&&e.add(t.instance);return e}validateValueAgainstCustomConstraints(e){const t=this.getCustomConstraintsSet();return 0===t.size?null:function(e,t){const s={};for(const n of e){const e=n.validate(t);!0!==e&&(s[n.constructor.name]=e)}return s}(t,e)}setValidity(){let e,t=null;const s=[],n={};let i=this.getBaseValidityFlags();const r=i=>{s.push(...Object.keys(i));for(const[s,r]of Object.entries(i)){Object.hasOwn(n,s)?n[s].push(r):n[s]=[r];const i=this.getValidityFlagIndex(s);(null===t||t>i)&&(t=i,e=r)}},a={};for(const[e,t]of Object.entries(i))if(!0===t){let t;for(const[,s]of this.filterConstraintsConfig("flag",e))t="function"==typeof s.message?s.message({value:this.value,constraintValue:this.getAttribute(s.attrName)}):s.message,a[e]=t;!t&&"getInternalValidationMessage"in this&&(a[e]=this.getInternalValidationMessage())}r(a);const o=this.validateValueAgainstCustomConstraints(this.value);if(o)for(const[,e]of Object.entries(o))r(e);this.oneTimeValidityState&&(r(this.oneTimeValidityState),this.oneTimeValidityState=void 0),i||(i=super.constructor.buildValidityFlagsTemplate());for(const e of s)i[e]=!0;this.validityState=n;const l=this.valid;this.internals.setValidity(i,e);const c=this.valid;l!==c&&this.dispatchEvent(new CustomEvent("validationstatechange",{detail:{newState:c}}))}reportValidity(){if(this.removeValidityMessages(),this.valid)this.dispatchEvent(new CustomEvent("validityremoved"));else{if(this.errorList)this.errorList.isDetached&&this.attachErrorList(this.errorList);else{const e=new Oe({type:Oe.types.unordered,classes:["error-list"]});this.attachErrorList(e),this.errorList=e}for(const e of super.constructor.validityFlags)if(Object.hasOwn(this.validityState,e)){const t=this.validityState[e];for(const e of t)this.errorList.append(document.createTextNode(e))}this.dispatchEvent(new CustomEvent("validityshown"))}}attachErrorList(e){e.attach(this.shadowRoot,{adjacency:p.beforeend})}isReportingValidity(){return this.errorList&&this.errorList.isAttached}removeValidityMessages(){this.errorList&&this.errorList.isAttached&&(this.errorList.detach(),this.errorList.empty())}setOneTimeValidityState(e){const t={};for(const[s,n]of Object.entries(e))super.constructor.validityFlags.includes(s)&&(t[s]=n);this.oneTimeValidityState=t,this.setValidity()}static createCustomElement(e,t){const[s]=ot.byType(this.type);return Q(s,{attrs:{...t,name:e}})}static hasValueStatusChange(e,t,s){""===e.value||T(e.value)?s(!1):t.active||s(!0)}}class st extends tt{#Be;constructor(){if(super(),!("createInternalFormElement"in this))throw new TypeError('Child class must define "createInternalFormElement" method');this.#Be=this.createInternalFormElement(),this.#Be.classList.add("form-element","internal-form-element"),this.#Be.id=this.id,this.addEventListener("idchange",(e=>{this.#Be.id=e.detail.id})),st.trackInnerElemFocus(this.#Be,this)}get internalFormElement(){return this.#Be}getInternalValidationMessage(){return this.internalFormElement.validationMessage}static trackInnerElemFocus(e,t){return new Pe({focus:{type:"focus",args:[()=>{t.classList.add("has-focus")}]},blur:{type:"blur",args:[()=>{ie(t,["has-focus"])}]}},e,{autoadd:!0})}}class nt extends st{#Fe;constructor(){super(),this.#Fe=Q("div",{classes:["field"]}),this.#Fe.appendChild(this.internalFormElement),this.container=this.#Fe,this.addValueChangeCallback((({newValue:e})=>{e!==this.internalFormElement.value&&(this.internalFormElement.value=e)}))}createInternalFormElement(){return this.createElement()}attributeChangedCallback(e,t,s){switch(super.attributeChangedCallback(e,t,s),e){case"name":this.internalFormElement.setAttribute("name",s);break;case"disabled":null===t?this.internalFormElement.setAttribute("disabled",s):null===s&&this.internalFormElement.removeAttribute("disabled")}}connectedCallback(){super.connectedCallback(),this.insertElementAfterStylesheets(this.#Fe),this.setAttribute("tabindex","0"),this.dispatchEvent(new CustomEvent("fieldpopulated",{detail:{field:this.#Fe}})),this.internalFormElement.addEventListener("input",(e=>{this.setValue(e.target.value,{type:e.inputType,inputData:e.data})}))}enableConstraint(e,t){if(this.hasInternalConstraint(e)){const s=this.constraints[e];Object.hasOwn(s,"attrName")&&this.internalFormElement.setAttribute(s.attrName,t)}super.enableConstraint(e,t)}disableConstraint(e){if(this.hasInternalConstraint(e)){const t=this.constraints[e];Object.hasOwn(t,"attrName")&&this.internalFormElement.removeAttribute(e)}super.disableConstraint(e)}getBaseValidityFlags(){return this.copyInnerValidityFlags()}copyInnerValidityFlags(){const e={};return super.constructor.validityFlags.forEach((t=>{e[t]=this.internalFormElement.validity[t]})),e}}class it extends nt{static observedAttributes=[...super.observedAttributes,"minlength","maxlength"];constructor(){super()}static get type(){return"text"}get elementId(){return"input"}empty(){this.setValue("",{inputType:"empty"})}clear(){this.empty()}createElement(){return Q("input",{attrs:{type:this.constructor.type}})}getInternalConstraintsConfig(){return{...super.getInternalConstraintsConfig(),minlength:{type:"internal",attrName:"minlength",message:({constraintValue:e,value:t})=>{const s=["character","characters"];return`Please use at least ${n(e,...s)} (you are currently using ${n(t.length,...s)}).`},description:"",flag:"tooShort"},maxlength:{type:"internal",attrName:"maxlength",message:({constraintValue:e,value:t})=>{const s=["character","characters"];return`Please shorten this text to ${n(e,...s)} or less (you are currently using ${n(t.length,...s)}).`},description:"",flag:"tooLong"}}}static hasSelectAllValueChange(e,t,s,n){0===e.selectionStart&&e.selectionEnd===n.length?t.connected&&s(!1):!t.connected&&n&&s(!0)}getControlsConfig(){return{...super.getControlsConfig(),cut:{text:"Cut",active:""!==this.value,obtainButton:e=>(e.addEventListener("click",(()=>{this.writeValueToClipboard(),this.empty()})),e),init:(e,t)=>{this.addEventListener("input",(s=>{tt.hasValueStatusChange(s.target,t,e)}))}},empty:{text:"Empty",active:""!==this.value,obtainButton:e=>(e.addEventListener("click",(()=>{this.empty()})),e),init:(e,t)=>{this.addEventListener("input",(s=>{tt.hasValueStatusChange(s.target,t,e)}))}},selectall:{text:"Select All",active:!T(this.value)&&""!==this.value&&(0!==this.internalFormElement.selectionStart||this.internalFormElement.selectionEnd!==this.value.length),obtainButton:e=>(e.addEventListener("click",(()=>{this.internalFormElement.focus(),this.internalFormElement.select()})),e),init:(e,t)=>{this.addEventListener("input",(s=>{tt.hasValueStatusChange(s.target,t,e)})),this.internalFormElement.addEventListener("select",(s=>{it.hasSelectAllValueChange(s.target,t,e,this.value)})),this.internalFormElement.addEventListener("click",(s=>{it.hasSelectAllValueChange(s.target,t,e,this.value)}))}}}}}class rt extends it{static observedAttributes=[...super.observedAttributes,"min","max"];constructor(){super()}static get type(){return"number"}getControlsConfig(){const e=super.getControlsConfig();return delete e.selectall,{...e,stepup:{text:"Step Up",active:""===this.value||""===this.internalFormElement.max||this.internalFormElement.max&&this.value<this.internalFormElement.max,obtainButton:e=>(e.addEventListener("click",(()=>{const e=Number(this.internalFormElement.step),t=""===this.internalFormElement.step||isNaN(e)?1:e,s=Number(this.value);let n=""===this.value||isNaN(s)?this.internalFormElement.min??t:function(e,t){if(0==e%t)return e+t;{const s=Math.ceil(e/t)*t;return parseFloat(s.toFixed(10))}}(s,t);this.internalFormElement.min&&(n=Math.max(n,this.internalFormElement.min)),this.value=String(n)})),e),init:(e,t)=>{this.addEventListener("input",(()=>{if(this.internalFormElement.max){const s=Number(this.value);""!==this.value&&!isNaN(s)&&this.internalFormElement.max<=s?e(!1):t.active||e(!0)}}))}},stepdown:{text:"Step Down",active:""===this.value||""===this.internalFormElement.max||this.internalFormElement.max&&this.value<this.internalFormElement.max,obtainButton:e=>(e.addEventListener("click",(()=>{const e=Number(this.internalFormElement.step),t=""===this.internalFormElement.step||isNaN(e)?1:e,s=Number(this.value);let n=""===this.value||isNaN(s)?this.internalFormElement.min?this.internalFormElement.min:0-t:function(e,t){const s=e%t;if(0===s)return e-(t-s);{const s=Math.floor(e/t)*t;return parseFloat(s.toFixed(10))}}(s,t);this.internalFormElement.max&&(n=Math.min(n,this.internalFormElement.max)),this.value=String(n)})),e),init:(e,t)=>{this.addEventListener("input",(()=>{if(this.internalFormElement.min){const s=Number(this.value);""!==this.value&&!isNaN(s)&&this.internalFormElement.min>=s?e(!1):t.active||e(!0)}}))}},usemin:{text:"Use Min",active:this.internalFormElement.min&&this.internalFormElement.value!==this.internalFormElement.min,obtainButton:e=>(e.addEventListener("click",(()=>{this.value=String(this.internalFormElement.min)})),e),init:(e,t)=>{this.addEventListener("input",(()=>{this.internalFormElement.min?e(this.value!==this.internalFormElement.min):t.active&&e(!1)}))}},usemax:{text:"Use Max",active:this.internalFormElement.max&&this.internalFormElement.value!==this.internalFormElement.max,obtainButton:e=>(e.addEventListener("click",(()=>{this.value=String(this.internalFormElement.max)})),e),init:(e,t)=>{this.addEventListener("input",(()=>{this.internalFormElement.max?e(this.value!==this.internalFormElement.max):t.active&&e(!1)}))}}}}getInternalConstraintsConfig(){return{...super.getInternalConstraintsConfig(),min:{type:"internal",attrName:"min",message:({constraintValue:e,value:t})=>`Value must be greater than or equal to ${e} (you are using ${t}).`,description:"",flag:"rangeUnderflow"},max:{type:"internal",attrName:"max",message:({constraintValue:e,value:t})=>`Value must be less than or equal to ${e} (you are using ${t}).`,description:"",flag:"rangeOverflow"}}}}class at extends it{static observedAttributes=[...super.observedAttributes];constructor(){super()}static get type(){return"textarea"}createElement(){return Q("textarea",{attrs:{type:this.constructor.type}})}}const ot={map:new Map,add(e,t,{define:s=!0,ignoreIfDefined:n=!0}={}){this.map.set(e,t),s&&(n&&!customElements.get(e)||!n)&&customElements.define(e,t)},addMany(e,{define:t=!0}={}){for(const[s,n]of Object.entries(e))this.add(s,n,{define:t})},byType(e){for(const[t,s]of this.map.entries())if(s.type===e)return[t,s];return null},byCustomElementName(e){for(const[t,s]of this.map.entries())if(t===e)return s;return null},defineAll(){for(const[e,t]of this.map.entries())customElements.get(e)||customElements.define(e,t)}};ot.addMany({"text-form-element":it,"search-form-element":class extends it{constructor(){super()}static get type(){return"search"}},"password-form-element":class extends it{constructor(){super()}static get type(){return"password"}get hasTextSecurity(){return"password"===this.internalFormElement.type}#Ve(e){const t=new CustomEvent("textsecuritychange",{detail:{status:e}});this.dispatchEvent(t)}showWithoutTextSecurity(){this.hasTextSecurity&&(this.internalFormElement.type="text",this.#Ve(!1))}showWithTextSecurity(){this.hasTextSecurity||(this.internalFormElement.type="password",this.#Ve(!0))}toggleTextSecurity(){this.hasTextSecurity?this.showWithoutTextSecurity():this.showWithTextSecurity()}getControlsConfig(){return{...super.getControlsConfig(),showpassword:{text:"Show Password",active:""!==this.value&&this.hasTextSecurity,obtainButton:e=>(e.addEventListener("click",(()=>{this.showWithoutTextSecurity()})),e),init:(e,t)=>{this.addEventListener("input",(s=>{""!==s.target.value&&this.hasTextSecurity&&!t.active?e(!0):""===s.target.value&&t.active&&e(!1)})),this.addEventListener("textsecuritychange",(s=>{!s.detail.status&&t.active?e(!1):s.detail.status&&!t.active&&e(!0)}))}},hidepassword:{text:"Hide Password",name:"hidePassword",active:""!==this.value&&!this.hasTextSecurity,obtainButton:e=>(e.addEventListener("click",(()=>{this.showWithTextSecurity()})),e),init:(e,t)=>{this.addEventListener("input",(s=>{""===s.target.value||this.hasTextSecurity||t.active?""===s.target.value&&t.active&&e(!1):e(!0)})),this.addEventListener("textsecuritychange",(s=>{s.detail.status||t.active?s.detail.status&&t.active&&e(!1):e(!0)}))}},generaterandonandcopy:{text:"Generate Random and Copy",active:""===this.value,obtainButton:e=>(e.addEventListener("click",(()=>{this.value=function(e,{lowercaseLetters:t=!0,uppercaseLetters:s=!0,digits:n=!0,specialChars:i=!0}={}){if(!(t||s||n||i))throw new RangeError("At least one option must be truthy");let r="";t&&(r+="abcdefghijklmnopqrstuvwxyz"),s&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"),n&&(r+="0123456789"),i&&(r+="!@#$%^&*()_");const a=new Uint8Array(e);crypto.getRandomValues(a);let o=[];for(let t=0;t<e;t++)o.push(r[a[t]%r.length]);return o.join("")}(24),this.writeValueToClipboard()})),e),init:(e,t)=>{this.addEventListener("input",(s=>{""!==s.target.value||t.connected?""!==s.target.value&&t.connected&&e(!1):e(!0)}))}}}}},"email-form-element":class extends it{constructor(){super()}static get type(){return"email"}getControlsConfig(){const e=super.getControlsConfig();return delete e.selectall,e}getInternalConstraintsConfig(){return{...super.getInternalConstraintsConfig(),minlength:{type:"internal",attrName:"minlength",message:({constraintValue:e,value:t})=>{const s=["character","characters"];return`Please use at least ${n(e,...s)} (you are currently using ${n(t.length,...s)}).`},description:"",flag:"tooShort"}}}},"number-form-element":rt,"textarea-form-element":at});class lt extends(de({options:{observeStylesheet:!0}})){constructor(){super()}connectedCallback(){super.connectedCallback();const e={},t={elRefs:e};this.hasAttribute("okText")&&(t.okText=this.getAttribute("oktext")),this.hasAttribute("noCancel")?t.useCancel=!1:this.hasAttribute("cancelText")&&(t.cancelText=this.getAttribute("canceltext")),this.hasAttribute("autofocus")&&(t.autofocus=this.getAttribute("autofocus"));const s=function({classes:e,id:t,okText:s,useCancel:n=!0,cancelText:i,autofocus:r,elRefs:a={},useMenu:o=!0}={}){const l=[];let c=!1,h={};if(n){const e={tag:"button",options:{text:i??"Cancel",classes:["cancel-button"],attrs:{value:"cancel"}},ref:"cancel"};"cancel"!==r&&"ok"===r||(e.options.attrs.autofocus="",c=!0),o?h.cancel=Q(e.tag,e.options):l.push(e)}const d={tag:"button",options:{text:s??"OK",classes:["ok-button"],attrs:{value:"ok"}},ref:"ok"};"ok"!==r&&c||(d.options.attrs.autofocus=""),o?h.ok=Q(d.tag,d.options):l.push(d);const u=Q("dialog",{classes:e,id:t,elems:[{tag:"form",options:{attrs:{method:"dialog"},elems:l},ref:"form"}]},a);if(o){const e=new Ve({headingText:"Options",type:Ve.types.regular,host:u});h.cancel&&e.append(h.cancel,"cancel",{listItemClasses:["cancel"]}),e.append(h.ok,"ok",{listItemClasses:["ok"]}),e.appendTo(a.form)}return u}(t);e.form.classList.add("footer");const n=[];this.hasAttribute("iconURL")&&n.push(z(this.getAttribute("iconURL"),"Icon")),this.hasAttribute("title")&&n.push(Q("h6",{text:this.getAttribute("title"),classes:["heading"]})),n.push(Q("p",{text:this.getAttribute("text"),classes:["text"]})),s.prepend(...n),this.shadowRoot.append(s),s.addEventListener("close",(()=>{const e=new CustomEvent("close",{detail:{returnValue:s.returnValue}});this.dispatchEvent(e)})),s.showModal()}}customElements.get("site-dialog")||customElements.define("site-dialog",lt);const ct=({parentConstructor:e}={})=>{const t=class extends e{static#S={paging:ct.pagingMethods.regular,perPageValues:[5,10,20,25,50,100],includePaging:!0,pagingStreamOnScroll:!0};#k;#$e;#Ke;#Ue;constructor(e,s){if(super(e,s),this.#k=U(s,t.#S),this.#k.paging instanceof l&&d(this.#k.paging.listing,"pagingMethods")){this.registerSearchParams([{name:"page",type:"menu",controlBuilder:this.releasePagingLandmark.bind(this)},{name:"perPage",type:"menu",controlBuilder:this.releasePerPageMenu.bind(this)}]);const e=s.searchParams?.perPage,n=s.searchParams?.page;this.#$e=new We({perPage:e,page:n}),this.#$e.addEventListener("totalchange",(e=>{this.dispatchEvent(A(e))})),this.#$e.addEventListener("pagenumberchange",(e=>{const{oldPageNumber:t}=e.detail;this.#Ue=t,this.dispatchEvent(A(e))}));const i=(e,t,s)=>{const n=this.meta.getByName(e);if(n){const[,e]=n;e.textContent=this.#$e[s]}else this.meta.appendPair(t,this.#$e[s],{name:e})},r=()=>{i("pageCount","Page Count","pageCount")},a=()=>{i("perPage","Per Page","perPage")},o=()=>{i("pageNumber","Page Number","page")};if(this.#$e.addEventListener("perpagechange",(e=>{this.dispatchEvent(A(e)),r()})),this.addEventListener("totalchange",(e=>{const{newTotal:t}=e.detail,s=this.meta.getByName("total");if(s){const[,e]=s;e.textContent=t}else this.meta.appendPair("Total",t,{name:"total"});r()})),this.#k.perPageValues&&(Array.isArray(this.#k.perPageValues)?this.#Ke=t.arrayToObject(this.#k.perPageValues):"object"==typeof this.#k.perPageValues&&(this.#Ke=this.#k.perPageValues)),e&&a(),n&&o(),this.addEventListener("perpagechange",(()=>{a()})),this.addEventListener("pagenumberchange",(()=>{o()})),this.#k.includePaging&&this.includePagingLandmark({whenInactive:"disable"}),this.#k.paging===ct.pagingMethods.stream&&this.#k.pagingStreamOnScroll){const e=100;let t=!1;let s=new IntersectionObserver((s=>{s.forEach((async s=>{s.isIntersecting&&!t&&(t=!0,await this.goToNextPageUntil((()=>this.hasRemainingSpaceOffset(e))),t=!1)}))}),{threshold:0,rootMargin:`0px 0px ${e}px 0px`}),n=!1;this.addEventListener("searchparamsapplied",(async()=>{!t&&this.hasRemainingSpaceOffset(e)&&(t=!0,await this.goToNextPageUntil((()=>this.hasRemainingSpaceOffset(e))),t=!1,s.observe(this.footer)),n||(s.observe(this.footer),n=!0)}))}}}static get collectiveOptions(){return{...e.collectiveOptions,...this.#S}}get pagingMethods(){return ct.pagingMethods}set total(e){if(e<0)throw new RangeError(`Total number must be positive, got ${e}`);this.#$e&&e!==this.#$e.total&&(e>0&&!this.pageNumber?(this.pageNumber=1,this.searchParams.page=1):0===e&&(this.pageNumber=0,this.searchParams.page=0),this.#$e.total=e)}get total(){if(this.#$e)return this.#$e.total}set perPage(e){this.#$e&&e!==this.#$e.perPage&&(this.#$e.perPage=e)}get perPage(){return this.#$e.perPage}set pageNumber(e){this.#$e&&e!==this.#$e.page&&(this.#$e.page=e)}get pageNumber(){return this.#$e.page}get previousPageNumber(){return this.#Ue}get offsetStart(){return this.#$e.offsetStart}get offsetEnd(){return this.#$e.offsetEnd}get isNonStreamPaging(){return this.#k.paging!==ct.pagingMethods.stream}get pageCount(){return this.#$e.pageCount}#qe(e,{forwardsLabel:t="Next Page",forwardsTitle:s="Go to next page",backwardsLabel:n="Previous Page",backwardsTitle:i="Go to previous page",trailingPos:r=3,whenInactive:a="disable",includeFirstAndLastPage:o=!0}={}){const l=[{name:"prev-page",label:n,title:i,number:()=>this.#$e.previousPage,pos:()=>e.list.has("first-page")?1:0,active:this.#$e.hasPreviousPage},{name:"next-page",label:t,title:s,number:()=>this.#$e.nextPage,pos:r,active:this.#$e.hasNextPage}];o&&(l.unshift({name:"first-page",label:"First Page",number:1,pos:0,active:this.#$e.hasPreviousPage}),l.push({name:"last-page",label:"Last Page",number:()=>this.#$e.pageCount,pos:r+1,active:this.#$e.hasNextPage}));const c=e instanceof Ue;l.forEach((({name:t,label:s,title:n,number:i,pos:r,active:o})=>{const l=e.list.has(t);let h,d;if(l||!o&&("disable"!==a||c)){if(c&&(h=e.list.getItem(t)?.firstElementChild,h)){const e="number"==typeof i?i:i();h._updateButton(e)}}else r="number"==typeof r?r:r(),d="number"==typeof i?i:i(),[h]=e._createButton(s,r,t,d),h.title=n,h.addEventListener("click",(e=>{e.preventDefault();const t="number"==typeof i?i:i();this.setSearchParam("page",t)})),"disable"===a&&(h.disabled=!o,o?h.title=n:h.removeAttribute("title"));"disable"!==a||c?l&&!o&&e.remove(t):!h&&l&&(h=e.getButton(t),h.disabled=!o,o?h.title=n:h.removeAttribute("title"))}))}#He(e,{type:t="menu",classes:s=[]}={}){let n;return"navigation"===t?(n=new Ue(e,s),n._createButton=(e,t,s,i)=>{const r=new URL(location.href);this.addSearchParamsToURLComponent(r.searchParams),r.searchParams.set(this.translateURLQueryParam("page"),i);const a=super.options.hyperlinkBuilder.buildHyperlink(r,e),[o]=n.insert(a,t,s);return a._updateButton=e=>{const t=new URL(a.href);t.searchParams.set(this.translateURLQueryParam("page"),e),a.href=t},[a,o]}):(n=new Ve({headingText:e,classes:s}),n._createButton=(e,t,s)=>{const[i,,r]=n.insertButton(e,t,s);return[r,i]}),n}releasePagingLandmark({includeFirstAndLastPage:e=!1,whenInactive:t="hide",type:s="menu"}={}){if(!this.#k.paging)return;let n,i;"navigation"===s?(n="Paging Navigation",i=["paging-navigation"]):(n="Paging",i=["paging"]);const r=this.#He(n,{type:s,classes:i});let a,o,l,c;switch(this.#k.paging){case ct.pagingMethods.regular:a="Next Page",o="Go to next page",l="Previous Page",c="Go to previous page";break;case ct.pagingMethods.stream:a="Show More",o="Show more entries",l="Show Less",c="Show less entries"}const h=()=>{this.#qe(r,{forwardsLabel:a,forwardsTitle:o,backwardsLabel:l,backwardsTitle:c,includeFirstAndLastPage:e,whenInactive:t})};return h(),ve(this,{totalchange:h,pagenumberchange:h,perpagechange:h}),r}releaseExtendedPagingLandmark({size:e=5,orientation:t=y.right,whenInactive:s="hide",type:n="menu"}={}){if(this.#k.paging!==ct.pagingMethods.regular)return;const i=this.#He("Extended Paging",{type:n,classes:["extended-paging"]}),r=()=>{for(let t=1;t<=e;t++)i.remove(`page-i${t}`);const[n,r]=this.#$e.calculateVisiblePageRange({size:e,orientation:t});let a=e;const o=i.list.has("first-page")?2:0;for(let e=r;e>=n;e--){const[t,s]=i._createButton(e,o,`page-i${a}`,e);e===this.pageNumber&&(s.classList.add("active"),t.disabled=!0),t.addEventListener("click",(t=>{t.preventDefault(),this.setSearchParam("page",e)})),a--}this.#qe(i,{trailingPos:e+2,whenInactive:s})};return r(),ve(this,{totalchange:r,pagenumberchange:r,perpagechange:r}),i}registerPerPageValues(e){this.#Ke=e,Array.isArray(e)&&(e=t.arrayToObject(e)),this.dispatchEvent(new CustomEvent("registerperpagevalues",{detail:{values:e}}))}releasePerPageMenu({menuOptions:e}={}){const t=this.buildControlFromData({type:"menu",values:this.#Ke,requiresItems:!0,processName:"listingperpage",processTitle:"Listing Per Page"},"perPage",{title:"Per Page",menuOptions:e});return this.#Ke||this.addEventListener("registerperpagevalues",(e=>{t._populator(e.detail.values)})),t}releasePagingNavigation({includeFirstAndLastPage:e=!1}={}){return this.releasePagingLandmark({includeFirstAndLastPage:e,type:"navigation"})}includePagingLandmark({whenInactive:e="disable"}={}){if(!this.header.querySelector(".paging")){const t=this.releasePagingLandmark({whenInactive:e});this.footer.append(t.element)}}async goToNextPage(){const e=this.#$e.nextPage;return e?await this.setSearchParams({page:e,origin:"next-page"}):null}async goToPreviousPage(){const e=this.#$e.previousPage;return e?await this.setSearchParams({page:e}):null}async goToNextPageUntil(e){let t;do{t=await this.goToNextPage()}while(t&&e())}async goToPreviousPageUntil(e){let t;do{t=await this.goToPreviousPage()}while(t&&e())}isPositionWithinPageRange(e){const t=this.offsetStart;return t<=e&&t+this.perPage>e}static arrayToObject(e){const t={};for(const s of e.values())t[s]=s;return t}static isPageChangeOnlyByInitiators(e){const t=Object.keys(e);let s=!1;return 1===t.length&&"page"===t[0]&&(s=!0),s}};return t};ct.pagingMethods=h({regular:"regular",stream:"stream"},"pagingMethods");class ht extends Ne{#We;#ze;constructor(e,t,{processName:s,processTitle:n,timeout:i,handleSignal:r=!0,processCategory:a="regular",processComplete:o=!0,processDetails:l,supportsProgress:c=!1}={}){let h,d,u=!0;t instanceof He?(h=t,u=!1):t instanceof AbortController&&(d=t),super(((t,r,o)=>{h||(h=new He(s,n,{handle:o,timeout:i,category:a,supportsProgress:c,details:l})),h.isPending&&h.start(),e(t,r,h)}),d,r),this.processComplete=o,this.#We=h,this.then((()=>{this.#ze&&u&&h.isRunning&&h.complete()}),(e=>{h.isRunning&&h.fail(e)}))}get process(){return this.#We}set processComplete(e){this.#ze=e}get processComplete(){return this.#ze}static get[Symbol.species](){return Promise}}const dt=({parentConstructor:e=Object}={})=>{const t=class extends e{static#S;#Qe;#k;constructor(e,s,n){super(...O(e)?e:[]),t.#S=s,this.#Qe=n,this.#k={...s,...n}}get options(){return{...this.#k}}get defaultOptions(){return t.defaultOptions}get userOptions(){return this.#Qe}static get defaultOptions(){return{...t.#S}}getOption(e){return this.#k[e]}hasOption(e){return Object.hasOwn(this.#k,e)}};return t};class ut extends(dt({parentConstructor:EventTarget})){static#S={duration:5e3};constructor(e={}){super([],ut.#S,e)}send(e,{duration:t}={}){this.dispatchEvent(new CustomEvent("send",{detail:{message:e,duration:t||this.options.duration}}))}toElementRepresentative(){const e=new Te({classes:["simple-notifications"]});return this.addEventListener("send",(t=>{const{message:s,duration:n}=t.detail,[,i]=e.prepend(s);setTimeout((()=>{e.remove(i)}),n)})),e}toElement(){return this.toElementRepresentative().element}}class mt extends Ce{static#S={classes:[],id:void 0,startWithEmptyMessage:!0,groupMemberBuilder:void 0,keyAsDataId:!1,itemBindings:void 0,searchParams:{},URLQueryTranslations:void 0,useURLQuery:!1,publishToURLQuery:!1,includeMeta:!0,includeMenu:!1,onRemove:void 0,onRemoveMany:void 0,createMenuForEachItem:!1,entryDeletor:void 0,deleteEntryOnItemRemove:!1,deleteEntriesMessages:{confirm:{one:"Do you really want to delete entry?",many:a`Do you really want to delete ${"count"} entries?`},complete:{done:{one:"1 entry deleted",many:a`${"count"} entries deleted`},error:{fail:"Deletion failed",mixed:({errorCount:e,count:t})=>e===t?`Failed to delete ${t} entries`:`${e} out of ${t} entries could not be deleted`}}},hyperlinkBuilder:D,onVisit:void 0,urlBuilders:void 0,onHeadItems:void 0};#k;#_e;#Ge;#Je;#Xe;#Ye;#q;#Ze;#et;#tt;#st=!1;#nt;#it=new Set;#rt;#at={};#ot;#lt={};#ct;#ht;#dt;constructor(e,t={}){"deleteEntriesMessages"in t&&"object"==typeof t.deleteEntriesMessages&&(t.deleteEntriesMessages=F(mt.#S.deleteEntriesMessages,t.deleteEntriesMessages));const s=["deleteEntriesMessages","hyperlinkBuilder"];for(const e of s)e in t&&T(t[e])&&(t[e]=mt.#S[e]);const n={};(t={...mt.#S,...t}).id&&(n.id=t.id);const i={},[r]=mt.createCarcass(e,{classes:t.classes,attrs:n,refs:i,includeFooter:!0,includeBody:!0});super(r),this.#k=t,this.#_e=e,this.#Ge=i.header,this.#Je=i.heading,this.#q=i.body,Object.hasOwn(i,"footer")&&(this.#et=i.footer),this.#Ze=new Te({memberBuilder:t.groupMemberBuilder,classes:["listing-group"],options:{keyAsDataId:t.keyAsDataId}}),this.#Ze.appendTo(this.#q),this.#Ze.addCountAttrTo(r),this.#Ze.addEventListener("countchange",(e=>{const{newCount:t,oldCount:s}=e.detail;0===s?this.putDownEmptyMessage():0===t&&this.putUpEmptyMessage()})),t.startWithEmptyMessage&&this.putUpEmptyMessage(),this.#nt=new Ke(["listing-meta"]);const[,a]=this.#nt.appendPair("Count",this.itemCount,{name:"count"});if(this.#Ze.updateCountText(a),t.includeMeta&&this.#nt.appendTo(this.#et),this.#ot={...this.#ot,...t.searchParams},this.#ht=new ut,this.#Ge.append(this.#ht.toElement()),t.includeMenu){const e=new Ve({headingText:"Listing Menu",type:Ve.types.toggle,host:r,classes:["listing-menu"]});if(this.#Ye=e,Object.hasOwn(t.includeMenu,"manage")){let s={};"object"==typeof t.includeMenu.manage&&(s=t.includeMenu.manage),e.append(this.releaseCopyManagerLaunchButton(s),"manage")}e.appendTo(this.#Ge)}}static get defaultOptions(){return Object.assign({},this.#S)}get options(){return Object.assign({},this.#k)}static get collectiveOptions(){return this.defaultOptions}get originalTitle(){return this.#_e}get header(){return this.#Ge}get heading(){return this.#Je}get head(){return this.#Xe}get group(){return this.#Ze}get footer(){return this.#et}get meta(){return this.#nt}get menu(){return this.#Ye}get itemCount(){return this.#Ze.count}set explicitTotal(e){this.#dt=e}get explicitTotal(){return T(this.#dt)?this.itemCount:this.#dt}get isNoItemsMessageShown(){return this.#tt&&re(this.#tt)}*items(){for(const e of this.#Ze.dataItems())yield e}getItemData(e){return this.group.getChildData(e)}changeTitle(e){this.#Je.replaceChildren(e)}empty(){0!==this.itemCount&&this.#Ze.empty({emptyKeys:!0})}putUpEmptyMessage(){if(!this.#st&&!this.isNoItemsMessageShown){let e;ae(this.#q),e=this.#tt?this.#tt:mt.createNoItemsMessage(),this.#tt=ne(e,this.#Ge)}}putDownEmptyMessage(){!this.#st&&this.isNoItemsMessageShown&&(this.#tt=ae(this.#tt))}revisitEmptyMessage(){0!==this.itemCount?this.putDownEmptyMessage():this.putUpEmptyMessage()}suspendEmptyMessage(){this.#st||(this.#st=!0)}unsuspendEmptyMessage(){this.#st&&(this.#st=!1)}prepareGroup(){this.putDownEmptyMessage(),re(this.#q)||he(this.#Ge,p.afterend,this.#q)}get checkboxConstructor(){let e;return this.#rt?e=this.#rt:([,e]=ot.byType("checkbox"),this.#rt=e),e}onItemBind(e){"function"==typeof e&&this.#it.add(e)}#ut(e,t,s,n){const i={item:e,key:t,element:s,originalElement:n},r={},a=(e,s)=>{e.addEventListener("click",(async()=>{this.deleteEntries([t],{confirm:s})}))},o={button:_("Delete",["delete-button"]),confirm:!0,releaseButton:({text:e="Delete",confirm:t=!0}={})=>{const s=_(e,["delete-button"]);return a(s,t),s}};a(o.button,o.confirm),r.deleteController=o;const l="function"==typeof this.#k.itemBindings;if(this.#it.size)for(const i of this.#it)i.call(this,{item:e,key:t,element:s,controls:r,isItemBindings:l,originalElement:n});l&&(this.#k.createMenuForEachItem&&(r.releaseMenu=({type:e="menu",exclude:n=[]}={})=>{let i,r;const a=(e,n,r)=>{if(this.#k?.urlBuilders?.visit){const a=this.#k.urlBuilders[e]({key:t,element:s}),o=(0,this.#k.hyperlinkBuilder.buildHyperlink)(a,n),[l]=i.append(o,r);return l.firstElementChild}};if("navigation"===e)i=new Ue("Actions"),!n.includes("visit")&&this.#k.urlBuilders.visit&&(r=a("visit","Visit","visit")),!n.includes("edit")&&this.#k.urlBuilders.edit&&a("edit","Edit","edit");else{const e={headingText:"Actions"};if("string"==typeof this.#k.createMenuForEachItem)try{e.type=Ve.types[this.#k.createMenuForEachItem]}catch(e){if(!(e instanceof c))throw e}i=new Ve(e),n.includes("visit")||(r=a("visit","Visit","visit"),r||([,,r]=i.appendButton("Visit","visit",{classes:["visit-button"]}))),n.includes("edit")||i.appendButton("Edit","edit",{classes:["edit-button"]})}return r&&r.addEventListener("click",(e=>{"function"==typeof this.#k.onVisit&&this.#k.onVisit({key:t,element:s,event:e})})),i.append(o.releaseButton({text:"Delete"}),"delete"),i}),this.#k.itemBindings.call(this,{item:e,element:s,controls:r,key:t,listing:this,originalElement:n})),i.controls=r,this.group.modifyChildData(t,i),this.#Ze.onMemberRemove(t,(()=>{this.#k.deleteEntryOnItemRemove&&this.deleteEntries([t],{confirm:!1})}))}async deleteEntries(e,{confirm:t=!0,deleteEntriesMessages:s}={}){const n=e.length,i=Object.create(null);for(const t of e){const e=this.getItemData(t);i[t]=e}const a=(t,s)=>(t instanceof r?t=t.format({count:n,keys:e.join(", ")}):"function"==typeof t&&(t=t(s)),t),o=s||this.#k.deleteEntriesMessages;if(t){let t,s;1===n?(t=o.confirm.one,s={...i[e[0]]}):(t=o.confirm.many,s={count:n,keys:[...e],data:i}),t=a(t,s);const r={okText:"Delete",classes:["danger"]};W?.stylesheets?.dialog&&(r.stylesheet=W.stylesheets.dialog);if(!await function(e,t={}){return new Promise((s=>{const n={text:e,autofocus:"cancel"},i=["iconURL","title","okText","cancelText","stylesheet","autofocus"];for(const e of i)e in t&&(n[e]=t[e]);const r={attrs:n};"classes"in t&&(r.classes=t.classes);const a=Q("site-dialog",r);document.body.append(a),a.addEventListener("close",(e=>{s("ok"===e.detail.returnValue),a.remove()}))}))}(t,r))return}const l=new He("deletelistingentries","Delete Listing Entries",{category:"listing"});l.start();for(const{item:e}of Object.values(i))e.classList.add("deleting");const c=(e,t)=>{"function"==typeof o.notifier?o.notifier(e,t):this.#ht.send(e,t)},h=[];try{let t=this.#k.entryDeletor([...e],l);if(t instanceof Promise&&(t=await t),!0===t||null===t){t&&h.push(...e);const s=i[e[0]];this.dispatchEvent(new CustomEvent("entriesdeleted",{detail:{keys:[...e],data:s}}));c(a(o.complete.done.one,{key:e[0],...s}),"success")}else if("object"==typeof t)if(h.push(...t.successKeys),0===t.errorCount){const e=[...t.successKeys,...t.notFoundKeys],s=(e=>{const t=Object.create(null);for(const s of e)t[s]=i[s];return t})(e);this.dispatchEvent(new CustomEvent("entriesdeleted",{detail:{keys:[...e],data:s}}));c(a(o.complete.done.many,{keys:[...e],data:s}),"success")}else{const s={error:new DOMException(`Could not delete ${t.errorCount} out of ${n} entries`,"DeleteError"),errorCount:t.errorCount,errors:t.errors,successCount:t.successCount,count:n};this.dispatchEvent(new CustomEvent("entriesdeleteerror",{detail:s}));c(a(o.complete.error.mixed,{keys:[...e],...s}),"error")}l.complete()}catch(t){this.dispatchEvent(new CustomEvent("entriesdeleteerror",{detail:{error:t}})),l.isRunning&&l.fail(t);c(a(o.complete.error.fail,{keys:[...e],data:i}),"error")}finally{for(const t of e)if(h.includes(t))this.removeItem(t);else{const{item:e}=i[t];e.classList.remove("deleting")}}}appendItem(e){this.prepareGroup(),this.#Ze.element.append(e)}appendItemFromElement(e,t,s){this.prepareGroup();const[n,i]=this.#Ze.append(e,t);return this.#ut(n,i,e,s),[n,i]}insertItem(e,t,s,n){this.prepareGroup();const[i,r]=this.#Ze.insertMember(e,t,s);return this.#ut(i,r,n,n),i}insertItemFromElement(e,t,s,n){if("number"!=typeof t)return this.appendItemFromElement(e,s,n);{this.prepareGroup();const[i,r]=this.#Ze.insert(e,t,s);return this.#ut(i,r,e,n),[i,r]}}getItem(e){const t=this.group.getChildData(e);return t?t.item:null}removeItem(e){const t=this.getItem(e);t&&t.remove()}addFooterIfNotExists(){if(!this.#et){const e=Q(...Object.values(mt.getFooterSchema()));this.#k.includeMeta&&e.append(this.#nt.element),this.element.append(e)}}createHead(e){const t=Q("div",{classes:["listing-head"]});this.#k.onHeadItems&&this.#k.onHeadItems(e);let s=1;const n=e.length;for(const[i,r]of e){const e=Q("div",{attrs:{"data-name":i}});e.append(r),this.dispatchEvent(new CustomEvent("headitemcreate",{detail:{headItem:e,name:i,position:s,itemCount:n}})),t.append(e),s++}return this.#Xe?this.#Xe.replaceWith(t):(this.#Xe=t,this.#q.prepend(t)),this.#Xe}static getHeaderSchema(e,t){return{tag:"header",options:{classes:["listing-header"],elems:[{tag:t.value,options:{classes:["listing-heading"],text:e},ref:"heading"}]},ref:"header"}}static getFooterSchema(){return{tag:"footer",options:{classes:["listing-footer"]},ref:"footer"}}static getBodySchema(){return{tag:"div",options:{classes:["listing-body"]},ref:"body"}}static createCarcass(e,{classes:t=[],attrs:s,headingLevel:n=m.two,includeFooter:i=!1,includeBody:r=!1,refs:a={}}={}){const[o,l]=Ce.createStandardCarcass(mt,"div",e,{classes:["listing",...t],attrs:s,headingLevel:n,includeFooter:i,includeBody:r,refs:a});return[o,l]}static createNoItemsMessage({text:e="No items"}={}){return Q("div",{classes:["message"],elems:[{tag:"p",options:{text:e}}]})}get searchParamsRegistry(){return Object.assign({},this.#at)}get registeredSearchParamNames(){return Object.keys(this.#at)}hasRegisteredSearchParam(e){return Object.hasOwn(this.#at,e)}validateRegisteredSearchParam(e){if(!this.hasRegisteredSearchParam(e))throw new DOMException(`Search param "${e}" is not registered`)}registerSearchParam(e,t){this.hasRegisteredSearchParam(e)||(t.type||(t.type="checkbox"),this.#at[e]=t,e in this.#ot||(this.#ot[e]=void 0),this.inheritURLQueryParam(e))}registerSearchParams(e){for(const t of e)if("name"in t){const e=t.name;delete t.name,this.registerSearchParam(e,t)}}getSearchParamConfig(e){if(this.hasRegisteredSearchParam(e))return this.#at[e]}buildControlFromData(e,t,{title:s,menuOptions:n={}}={}){switch(e.type){case"checkbox":{let e;const n=this.checkboxConstructor.createElement(t,{label:s});return n.addEventListener("change",(s=>{const{newState:n}=s.detail;e!==n&&(e=n,this.setSearchParam(t,n))})),this.addEventListener("searchparamsset",(e=>{const{initiators:s}=e.detail;if(t in s&&!T(s[t])){const{process:t}=e.detail;t&&(n.process=t)}})),this.addEventListener("searchparamsapplied",(s=>{const{searchParams:i}=s.detail;if(t in i){const s=i[t];n.checked!==s&&(e=s,n.checked=s)}})),n}case"menu":{T(s)&&"title"in e&&(s=e.title),n.headingText=s;const r=`menu-${i(t)}`;n.classes?n.classes.push(r):n.classes=[r];const a=new Ve(n),o=()=>{for(const e of a.list.items())ie(e,["active"]),e.firstElementChild.disabled=!0},l=()=>{for(const e of a.list.items())ie(e,["active"]),e.firstElementChild.disabled=!1},c=[],{values:h,control:d,multiple:u}=e;a._populator=(s,{ignoreDuplicates:n=!0}={})=>{const i=this.itemCount;let r=-1;for(const[o,l]of Object.entries(s)){if(r++,n&&a.list.has(o))continue;let s,h;if("checkbox"===d)h=this.checkboxConstructor.createElement(`${t}[]`,{value:o,label:l}),[s]=a.insert(h,r,o),h.addEventListener("change",(e=>{if(u){const{newState:s,value:n}=e.detail;if(null===n||!c.includes(n)){s?c.push(n):fe(c,o);const e={};e[t]=0!==c.length?[...c]:void 0,this.setSearchParams(e)}}else this.setSearchParam(t,o)}));else[s,,h]=a.insertButton(l,r,o),h.addEventListener("click",(()=>{if(u){c.includes(o)?fe(c,o):c.push(o);const e={};e[t]=0!==c.length?[...c]:void 0,this.setSearchParams(e)}else this.setSearchParam(t,o)}));(!u&&o==this.#ot[t]||u&&Array.isArray(this.#ot[o])&&this.#ot[t].includes(l))&&s.classList.add("active"),e.requiresItems&&0===i&&(h.disabled=!0)}e.requiresItems&&this.group.addEventListener("countchange",(e=>{const{newCount:t,oldCount:s}=e.detail;0===s?l():0===t&&o()}))},h&&a._populator(h);const m=()=>{a.list.element.querySelectorAll(":scope > .active").forEach((e=>{ie(e,["active"])}))},g=(e,t)=>{const s=a.getListItem(String(t)).firstElementChild;"checkbox"===d?s.process=e:e.delayedInfoToggler(s,{tag:"span",adjacency:p.afterbegin})};return this.addEventListener("searchparamsset",(e=>{const{initiators:s}=e.detail;if(t in s&&!T(s[t])){const{searchParams:s,process:n}=e.detail,i=s[t];if(n)if(Array.isArray(i))for(const e of i)g(n,e);else g(n,i)}})),this.addEventListener("searchparamsapplied",(e=>{const{searchParams:s}=e.detail;if(t in s){const e=s[t];if(Array.isArray(e)){m();for(const t of e){const e=a.getListItem(t);e&&(e.classList.add("active"),"checkbox"!==d||c.includes(t)||(c.push(t),e.firstElementChild.checked=!0))}}else{const e=a.getListItem(String(s[t]));e&&e.classList.contains("active")||(m(),l(),e&&(a.select(s[t]),e.classList.add("active"),e.firstElementChild.disabled=!0))}}})),a}}}createControlBySearchParam(e,{title:t,menuOptions:s}={}){if(this.hasRegisteredSearchParam(e)){const n=this.#at[e];return"controlBuilder"in n?n.controlBuilder({menuOptions:s}):this.buildControlFromData(n,e,{title:t})}}get searchParams(){return this.#ot}get searchParamsCopy(){return Object.assign({},this.#ot)}filterOutUnregisteredSearchParams(e){for(const t of Object.keys(e))this.hasRegisteredSearchParam(t)||delete e[t]}setSearchParams(e,{forceWhenMatching:t=!1,updateStateParams:s=!0,origin:n}={}){this.filterOutUnregisteredSearchParams(e),this.#ct&&this.#ct.abort();const i=mt.compareSearchParams(this.#ot,e);if(!t){if(0===Object.keys(i).length)return Promise.resolve(this.#ot)}return this.#ct=new AbortController,new ht((async(t,i,r)=>{this.filterOutUnregisteredSearchParams(this.#ot);let a={...this.#ot,...this.#lt};this.dispatchEvent(new CustomEvent("requestparams",{detail:{params:e,requestParams:a,origin:n}})),a={...a,...e},this.#lt=a,this.dispatchEvent(new CustomEvent("searchparamsset",{detail:{searchParams:a,initiators:e,process:r}}));const o=this.setParamsRequest(a,{initiators:e,process:r});He.processToResolvers(r,o);try{const e=await o;this.#ct=void 0,this.dispatchEvent(new CustomEvent("searchparamsapplied",{detail:{searchParams:e,origin:n}}));for(const[t,s]of Object.entries(a))t in e||void 0!==s||(e[t]=s);if(this.#ot={...this.#ot,...e},s&&this.#k.publishToURLQuery){const e={},t=[];for(const[s,n]of Object.entries(this.#ot))T(n)?t.push(s):e[s]=n;const s=this.#k.publishToURLQuery;"init"!==n?s.pushMany(e,{component:this}):s.replaceMany(e,{component:this}),s.popMany(t,{component:this}),this.dispatchEvent(new CustomEvent("stateparamschange",{detail:{params:this.searchParamsCopy}}))}t(e)}catch(e){e.name,i(e)}finally{this.#ct=void 0,this.#lt={}}}),this.#ct,{processName:"setsearchparams",processTitle:"Set Listing Search Params",processCategory:"listing"})}setSearchParam(e,t,{origin:s}={}){const n={};return n[e]=t,this.setSearchParams(n,{origin:s})}reload(){return this.setSearchParams(this.#ot,{forceWhenMatching:!0})}addSearchParamsToURLComponent(e){mt.addSearchParamsToURLComponent(e,this.searchParams)}get URLSearchParams(){const e=new URLSearchParams;return this.addSearchParamsToURLComponent(e),e}static addSearchParamsToURLComponent(e,t){L(e,URLSearchParams);for(const[s,n]of Object.entries(t))T(n)||(Array.isArray(n)?n.forEach((t=>{e.append(`${s}[]`,t)})):e.append(s,n))}static compareSearchParams(e,t){const s={};for(const[n,i]of Object.entries(t)){const t=e[n],r=Array.isArray(t);n in e&&typeof t==typeof i&&(r?be(t,i):t===i)||(s[n]=i)}return s}get remainingSpace(){const e=this.element.getBoundingClientRect(),t=this.#Ze.element.getBoundingClientRect(),s=parseInt(getComputedStyle(this.element).getPropertyValue("padding-bottom"));return Math.min(document.documentElement.clientHeight,e.bottom)-s-t.bottom}get hasRemainingSpace(){return this.remainingSpace>0}hasRemainingSpaceOffset(e){return this.remainingSpace+e>0}inheritURLQueryParam(e){if(this.#k.useURLQuery){let t=this.translateURLQueryParam(e);const s=new URLSearchParams(location.search).get(t);null!==s&&(this.#ot[e]=s)}}getState(){return this.searchParamsCopy}setState(e,{updateStateParams:t=!1}={}){this.setSearchParams(e,{updateStateParams:t})}translateURLQueryParam(e){const t=this.#k.URLQueryTranslations;return"object"==typeof t&&Object.hasOwn(t,e)?t[e]:e}getManagerCopy(){let e=this.options;Object.hasOwn(e,"searchParams")&&(e.searchParams.page=1),e.includeMenu=!1,e.classes.push("manage-listing"),e=Object.assign(e,{searchable:!0,selectItems:!0,itemBindings:({item:e,controls:{select:t,releaseMenu:s}})=>{const n=s({exclude:["visit","edit"]});"shadowRoot"in e&&(t.setAttribute("slot","select-checkbox"),n.element.setAttribute("slot","menu")),e.prepend(t);const i=e.querySelector(':scope > [data-name="options"]');i?n.appendTo(i):n.appendTo(e)},onHeadItems:e=>{e.unshift(["select",""])},paging:ct.pagingMethods.regular,includePaging:!1,createMenuForEachItem:!0});const t=this.newInstance(e),s=t.releaseExtendedPagingLandmark();s?.appendTo(t.footer);const n=t.releaseControlsMenu({includeDeleteSelected:!0});return n?.appendTo(t.footer),t}createCopyPopup({title:e="Listing Management",classes:t}={}){const s=this.getManagerCopy(),n=new Fe(s.element,{title:e,classes:t,onClose:()=>{n.remove()}});return n.show(),n}releaseCopyManagerLaunchButton({title:e="Manage Listing",popupTitle:t,classes:s}={}){const n=_(e,["manage-listing-button"]);return n.addEventListener("click",(()=>{this.createCopyPopup({title:t,classes:s})})),n}registerURLBuilders(e){this.#k.urlBuilders=e}getURLBuilder(e){return"urlBuilders"in this.#k&&Object.hasOwn(this.#k.urlBuilders,e)?this.#k.urlBuilders[e]:null}createVisitHyperlink(e,t,{content:s="Visit"}={}){const n=this.#k.urlBuilders.visit({key:e,element:t}),i=(0,this.#k.hyperlinkBuilder.buildHyperlink)(n,s);return i.addEventListener("click",(s=>{"function"==typeof this.#k.onVisit&&this.#k.onVisit({key:e,element:t,event:s})})),i}}class pt{convertType(e,t){switch(e){case"string":e="text";break;case"email_address":e="email";break;case"boolean":e="checkbox";break;case"integer":e="number";break;case"text":e="textarea"}return t.relationship&&(e="reference-select"),t.set&&(e="select"),e}}const gt={basename(e,t){const s=e.split("/"),n=s[s.length-1];return t&&n.endsWith(t)?n.substring(0,n.length-t.length):n},relative(e,t){const s=e.split("/"),n=t.split("/");for(;s.length>0&&n.length>0&&s[0]===n[0];)s.shift(),n.shift();e.endsWith(".html")&&s.pop();return s.map((()=>"..")).concat(n).join("/")}};class ft extends DOMException{constructor(e){super(e,"NetworkError")}}class bt extends DOMException{constructor(e){super(e,"RequestError")}}class vt extends DOMException{constructor(e){super(e,"NetworkError")}}class yt extends DOMException{constructor(e){super(e,"NetworkError")}}class Et extends DOMException{constructor(e){super(e,"NetworkError")}}class Ct extends E{constructor(e,t){super(e,"AbortError",t)}}class wt extends C{constructor(e,t){super(e,t)}}class Pt extends C{constructor(e){super(e)}}function xt(e,t,{method:s=g.get,timeout:n=2e3,timeoutConnectOnly:i=!0,requestOptions:r={},returnResponse:a=!1,throwStatusErrors:o=!1,processCategory:l="regular",asFile:c=!1,trackDownloadProgress:h=!0,handleSignal:d=!1,body:u,headers:m}={}){return L(t,[AbortController,He],{paramNumber:2}),new ht((async(t,n,l)=>{const d={};window.dispatchEvent(new CustomEvent("beforenetworkrequest",{detail:{url:e,method:s,process:l,payload:d}})),d.url&&d.url instanceof URL&&(e=d.url),r.method=s.value,r.signal=l.signal,u&&(r.body=u),m&&(r.headers=m);const p=e=>{e instanceof w||("AbortError"===e.name?n(new Ct(`Network request aborted: ${e.message}`,e)):"TimeoutError"===e.name?n(new wt(`Network request has timed out: ${e.message}`)):n(e))};window.dispatchEvent(new CustomEvent("networkrequest",{detail:{url:e,method:s,process:l}}));try{String(e);const s=new Request(e,r);try{let r=await fetch(s);i&&l.stopTimeout();try{if(a)t(r);else{if(o)switch(r.status){case 404:n(new vt(`Network resource at ${e} was not found`));break;case 401:n(new yt("Network resource denied"));break;case 500:n(new Et("Network resource responded with server error"))}if(r.ok){let e,s;if(h&&(s={},r=function(e,t,s={},n){if(!e.headers.has("content-length"))return e;const i=Number(e.headers.get("content-length"));s.contentLength=i;const r=e.body.getReader(),a=new ReadableStream({start(e){s.chunkCount=0,s.done=!1,s.aborted=!1,function a(){r.read().then((r=>{const{done:o,value:l}=r;if(s.done=o,s.aborted=n&&n.aborted,o)return e.close(),!0;s.chunkCount++,t(l,i),e.enqueue(l),a()})).catch((t=>(!s.aborted&&n?.aborted?s.error=n.reason:s.error=t,e.close(),!1)))}()}}),o=new Response(a,{status:e.status,statusText:e.statusText,headers:e.headers});return o._url=e.url,o}(r,function(e){let t=0;return(s,n)=>{t+=s.byteLength,e(t/n*100)}}((e=>{l.progress(e)})),s,l.signal)),e=c?await function(e,t){return L(e,Response),new Promise(((s,n)=>{e.blob().then((n=>{const i=new URL(e.url||e._url);t||(t=gt.basename(i.pathname));const r=new File([n],t,{type:n.type});s(r)})).catch((e=>{n(e)}))}))}(r):await function(e){let t;L(e,Response);let s="text";switch(e.headers.has("content-type")&&(t=e.headers.get("content-type").toLowerCase(),t.startsWith("application/json")?s="json":t.startsWith("image/")&&(s="image")),s){case"text":return e.text();case"json":return e.json();case"image":return e.blob()}}(r),s&&Object.hasOwn(s,"error"))throw s.error;t(e)}else n(new Pt(`Invalid network response status ${r.status}`))}}catch(e){p(e)}}catch(e){"TypeError"===e.name?n(new ft(e.message)):e instanceof C||"AbortError"===e.name&&l.signal.aborted&&l.signal.reason instanceof C?n(new wt(`Network request has timed out: ${e.message}`)):p(e)}}catch(e){n(new bt(`Network request is invalid: ${e.message}`))}}),t,{processName:"networkrequest",processTitle:"Network Request",timeout:n,handleSignal:d,processCategory:l,processDetails:String(e),supportsProgress:h})}const St=h({wwwform:"application/x-www-form-urlencoded",multipart:"multipart/form-data",plaintext:"text/plain"},"formEncodingTypes");class kt extends Ce{#Ge;#mt;#et;#Ye;static#pt=["title","submitText","method","pageName","requestURL","bracketPrefix","data","navigation"];static#gt=["type","subtype","genericType","set","required","relationship","relationshipOtherModule","relationshipOtherModuleTitle","title","min","max","description","match","allowEmpty","value"];constructor(e,{classes:t=[],id:s=te("form"),title:n,submitText:i="Submit",method:r=g.post,enctype:a=St.wwwform,sendOnSubmit:o=!0,agentValidationReporting:l=!1,includeResetButton:c=!1}={}){L(e,URL),u(r,"httpMethods"),u(a,"formEncodingTypes");const h={method:r.name,action:e.toString()};a!==St.wwwform&&(h.enctype=a.value),l||(h.novalidate="novalidate");const d={},m=kt.createCarcass({classes:t,id:s,attrs:h,refs:d});super(m),this.id=s,this.submitText=i,this.title=n,this.#mt=d.mainFieldset,this.sendOnSubmit=o,this.addFooterIfNotExists({includeResetButton:c}),n&&this.addHeaderIfNotExists(),m.addEventListener("submit",(e=>{this.submit({event:e})}));const p=()=>{kt.isElementInvalid(m)?Y(m).forEach((e=>{e.disabled=!1})):function(e){Y(e).forEach((e=>{e.disabled=!0}))}(m)};m.addEventListener("input",(()=>{p()})),kt.onFormElementAddAndRemove(m,p,p)}get url(){const e=this.element.getAttribute("action");return e||null}get header(){return this.#Ge}get footer(){return this.#et}get menu(){return this.#Ye}get mainFieldset(){return this.#mt}get httpMethod(){return g[this.element.method]}get enctype(){return function(e,t){for(const s of Object.values(e))if(s.value===t)return s;return null}(St,this.element.enctype)}get formData(){return new FormData(this.element)}get asURLSearchParams(){return new URLSearchParams(this.formData)}get valid(){return this.element.checkValidity()}reportValidity(){if(!this.valid)for(const e of this.element.elements)"reportValidity"in e&&e.reportValidity()}async submit({event:e,timeout:t,processCategory:s}={}){if(this.valid){if(this.sendOnSubmit){e&&e.preventDefault();const n=this.sendAsNetworkRequest({timeout:t,processCategory:s});try{const e=await n,t=this.nestedErrorsIterator(e.data);return this.publishCustomErrors(t),this.dispatchEvent(new CustomEvent("output",{detail:{payload:e}})),e}catch(e){this.dispatchEvent(new CustomEvent("outputerror",{detail:{error:e}}))}}}else e&&e.preventDefault(),this.reportValidity()}createMenu({includeResetButton:e=!1}={}){const t=new Ve({headingText:"Main Actions",classes:["form-menu"]}),s=function(e,t){const s={text:e};return t&&(s.attrs={form:t}),Q("button",s)}(this.submitText,this.id);if(t.append(s),e){const e=Q("input",{attrs:{type:"reset",value:"Reset",form:this.id}});t.append(e)}return t}createHeader({headingLevel:e=m.two}={}){const t=Q("header",{classes:["form-header"]});if(this.title){const s=Q(e.value,{classes:["form-heading"],text:this.title});t.prepend(s)}return t}addHeaderIfNotExists(){this.#Ge||(this.#Ge=se(this.element,this.createHeader()))}createFooter({includeResetButton:e=!1}={}){const t=this.createMenu({includeResetButton:e});return{footerEl:Q("footer",{classes:["form-footer"],elems:[t.element]}),menu:t}}addFooterIfNotExists({includeResetButton:e=!1}={}){if(!this.#et){const{footerEl:t,menu:s}=this.createFooter({includeResetButton:e});this.#et=this.element.appendChild(t),this.#Ye=s}}appendToMainFieldset(e){return this.#mt.insertBefore(e,null)}serialize(){return this.asURLSearchParams.toString()}findElementByName(e){return this.element.querySelector(`[name="${e}"]`)}getNetworkRequestParams(){const e={"Content-Type":this.enctype.value};let t;switch(this.enctype){case St.wwwform:t=this.serialize();break;case St.multipart:t=this.formData;break;case St.plaintext:t=this.serialize()}const s=new AbortController;return{url:this.url,handle:s,options:{method:this.httpMethod,headers:e,body:t}}}sendAsNetworkRequest({timeout:e=1e4,processCategory:t="main"}={}){const s=this.getNetworkRequestParams(),{options:n}=s;n.timeout=e,n.processCategory=t;const i=xt(...Object.values(s));return this.attachProcessToSubmitButtons(i.process),i}attachProcessToSubmitButtons(e){if(L(e,He),e.isRunning){const t=Y(this.element);t.forEach((t=>{let s;t.disabled=!0,s=t instanceof HTMLButtonElement?p.afterbegin:p.beforebegin,e.delayedInfoToggler(t,{adjacency:s,tag:"span"})})),e.addEventListener("ended",(()=>{t.forEach((e=>{e.disabled=!1}))}))}}*nestedErrorsIterator(e){if(e)for(const[t,s]of Object.entries(e))Object.hasOwn(s,"errors")&&(yield[t,s.errors])}publishCustomErrors(e){for(const[t,s]of e){const e=this.findElementByName(t);e&&(e.setOneTimeValidityState(s),e.reportValidity())}}clear(){const e=["fieldset","button","object"];for(const t of this.element.elements)e.includes(t.localName)||(t instanceof tt&&"clear"in t&&"function"==typeof t.clear?t.clear():"select"===t.localName?0!==t.selectedIndex&&(t.selectedIndex=0):"checkbox"===t.type||"radio"===t.type?t.checked&&(t.checked=!1):t.value="")}static buildIdFromName(e,t){if("string"==typeof e&&e&&"string"==typeof t&&t)return t.concat("_",e)}static createCarcass({classes:e,id:t,attrs:s,refs:n={}}={}){return Q("form",{classes:e,id:t,attrs:s,elems:[{tag:"fieldset",options:{classes:["main"],elems:[Q("legend",{text:"Main Fields"})]},ref:"mainFieldset"}]},n)}static from(e,t,s,{formElementBuilder:n,hyperlinkBuilder:i}={}){const r=K(t,e,{validProps:kt.#pt,considerArrayAsMultiPath:!0}),a={title:r.title,classes:[]};r.submitText&&(a.submitText=r.submitText),r.method&&(a.method=g[r.method]),r.pageName&&a.classes.push(r.pageName);const o=new URL(r.requestURL,location.href),l=new kt(o,a);let c;r.subtitle&&l.changeSubheading(r.subtitle),r.bracketPrefix&&(c=r.bracketPrefix);const h=new Map,d=l.element.id,u=new Map;for(let[e,t]of Object.entries(r.data)){t=K(s,t,{validProps:kt.#gt,considerArrayAsMultiPath:!0}),c&&(e=`${c}[${e}]`);const i=n.getWrapperElements(e,t,d);if(i){const{wrapper:s,element:n}=i;h.set(e,n),s&&l.appendToMainFieldset(s),t.match&&u.set(e,n)}}if(u.forEach(((e,t)=>{const n=K(s,r.data[t],{validProps:kt.#gt,considerArrayAsMultiPath:!0});if(h.has(n.match)){const t=h.get(n.match),s=new Ze(t);e.setCustomConstraint(s,{attrName:"matchvalue"})}})),r.navigation){const e=Ue.fromSchema(r.navigation,{hyperlinkBuilder:i,heading:"Form Navigation"});l.footer.appendChild(e.element)}return l}static isElementInvalid(e){return!e.matches(":invalid")}static onFormElementAddAndRemove(e,t,s){new MutationObserver((e=>{for(let n of e)"childList"===n.type&&(n.addedNodes.forEach((e=>{(e instanceof HTMLFormElement||e instanceof tt)&&t()})),n.removedNodes.forEach((e=>{(e instanceof HTMLFormElement||e instanceof tt)&&s()})))})).observe(e,{childList:!0,subtree:!0})}}class Tt extends pt{constructor(){super()}createFormElement(e,t,s){const n=this.convertType(t.genericType??t.type,t),i=ot.byType(n);if(null===i)return null;const[,r]=i,a={controlsmenu:"toggle",controlsfilter:"none"},o={title:"label",min:"minlength",max:"maxlength",description:"description"};let l;switch(t.required&&(a.required=""),W?.stylesheets?.formElement&&(l=W.stylesheets.formElement),n){case"checkbox":W?.stylesheets?.checkbox&&(l=W.stylesheets.checkbox),a.value="1",a.controlsmenu="off";break;case"select":W?.stylesheets?.selectMenu&&(l=W.stylesheets.selectMenu);break;case"reference-select":W?.stylesheets?.referenceSelect&&(l=W.stylesheets.referenceSelect),a.url=t.relationshipOtherModule,a["module-title"]=t.relationshipOtherModuleTitle}l&&(a.stylesheet=l),s&&(a.id=kt.buildIdFromName(e,s));for(const[e,s]of Object.entries(o))Object.hasOwn(t,e)&&("minlength"!==s&&"maxlength"!==s||"number"!==n?a[s]=t[e]:a[e]=t[e]);const c=r.createCustomElement(e,a);if("value"in t&&"string"==typeof t.value&&c.setValue(t.value),"select"===n)for(const[e,s]of Object.entries(t.set))c.addOption(s,e);return c}wrap(e,t){return t[0]}getWrapperElements(e,t,s){const n=this.createFormElement(e,t,s),i=this.convertType(t.genericType,t);return{wrapper:this.wrap(i,[n]),element:n}}}const Ot=ct({parentConstructor:(({parentConstructor:e,naturalOrder:t=!1}={})=>{const s={};t&&(s.natural="Natural");for(const{name:e,value:t}of Object.values(v))s[e]=t;const n=class extends e{static#S={sortable:!0,sortValues:void 0,relevanceKey:void 0,headItemSort:void 0};#k;#ft;#bt;constructor(e,t){if(super(e,t),this.#k=U(t,n.#S),this.#k.sortable){let e,t;this.registerSearchParams([{name:"order",type:"menu",values:s,controlBuilder:this.releaseOrderMenu.bind(this)},{name:"sort",type:"menu",controlBuilder:this.releaseSortMenu.bind(this)}]),this.#ft=this.#k.sortValues,this.addEventListener("requestparams",(e=>{const{params:t,requestParams:s}=e.detail;"sort"in t&&!T(t.sort)&&(T(t.order)||"natural"===t.order)&&this.hasNaturalOrder&&"natural"===s.order&&(t.order="asc"),this.hasNaturalOrder&&"order"in t&&"natural"===t.order&&!t.sort&&!T(this.searchParams.sort)&&(t.sort=void 0)})),"relevanceKey"in this.#k&&(this.#bt=this.#k.relevanceKey);const n=new Map,i=(s,n)=>{const i=this.searchParams.sort===n,r=new Ve({headingText:"Options",host:s,classes:["sort-menu"]}),[,,a]=r.appendButton("ASC","asc-order",{classes:["asc-direction-button"]}),[,,o]=r.appendButton("DESC","desc-order",{classes:["desc-direction-button"]});a.addEventListener("click",(()=>{this.setSearchParams({order:"asc",sort:n})})),"asc"===this.searchParams.order&&i&&(a.disabled=!0,t=a),o.addEventListener("click",(()=>{this.setSearchParams({order:"desc",sort:n})})),"desc"===this.searchParams.order&&i&&(o.disabled=!0,t=o),0===this.itemCount&&(a.disabled=!0,o.disabled=!0),this.group.addEventListener("countchange",(e=>{const{newCount:s,oldCount:n}=e.detail;0===n?(t!==a&&(a.disabled=!1),t!==o&&(o.disabled=!1)):0===s&&(a.disabled=!0,o.disabled=!0)})),i&&(e=s),r.appendTo(s)},r=(e,t)=>new Pe({click:{type:"click",args:[()=>{let s;if(this.searchParams.sort===t){s="asc"===this.searchParams.order?"desc":"asc"}else s="asc";const n=this.setSearchParams({order:s,sort:t});"button"===e.localName&&n.process&&n.process.isRunning&&(e.disabled=!0,n.process.addEventListener("ended",(()=>{e.disabled=!1})))}]}},e,{autoadd:!0}),a=(s,n)=>{const i=this.searchParams.sort===n,a=_(s.innerText,["sort-toggler-button"]);r(a,n),i&&(t=a),0===this.itemCount&&(a.disabled=!0),this.group.addEventListener("countchange",(e=>{const{newCount:t,oldCount:s}=e.detail;0===s?a.disabled=!1:0===t&&(a.disabled=!0)})),i&&(e=s),s.append(a)};this.addEventListener("headitemcreate",(e=>{if(this.#ft){const{headItem:t,name:s}=e.detail;if(s in this.#ft)if("button"===this.#k.headItemSort)a(t,s);else if("menu"===this.#k.headItemSort)i(t,s);else{const e=r(t,s);n.set(t,e),t.classList.add("clickable")}}})),this.addEventListener("searchparamsapplied",(s=>{if(this.head){const{searchParams:n}=s.detail;let i=!1;if(!T(n.sort)&&!T(n.order)){const s=`[data-name="${n.sort}"]`,r=this.head.querySelector(s);if(r){let s;if("button"===this.#k.headItemSort)s=r.querySelector(".sort-toggler-button");else if("menu"===this.#k.headItemSort){const e=n.order.concat("-direction-button");s=r.querySelector(`.${e}`),s.disabled=!0,t&&t!==s&&(t.disabled=!1)}s&&(t=s),i=!0,e&&e.removeAttribute("data-order"),e=r,e.dataset.order=n.order}}!i&&t&&0!==this.itemCount&&(t.disabled=!1,t=void 0)}})),this.addEventListener("registersortvalues",(e=>{if(this.head){const{values:t}=e.detail;for(const e of this.head.children){const s=e.dataset.name in t;if("button"===this.#k.headItemSort){const t=e.querySelector(".sort-toggler-button");t&&!s?t.remove():!t&&s&&a(e,e.dataset.name)}else if("menu"===this.#k.headItemSort){const t=e.querySelector(".sort-menu");t&&!s?t.remove():!t&&s&&i(e,e.dataset.name)}else{const t=n.get(e);if(!s&&t)t.remove(),ie(e,["clickable"]),n.delete(e);else if(!t){const t=r(e,name);n.set(e,t),e.classList.add("clickable")}}}}}))}}static get collectiveOptions(){return{...e.collectiveOptions,...this.#S}}get hasNaturalOrder(){return t}set relevanceKey(e){this.#bt=e}get isRelevanceInSortValues(){if(T(this.#bt))return!1;const e=this.getSearchParamConfig("sort");return"values"in e&&this.#bt in e.values}get relevanceKey(){return this.#bt}registerSortValues(e){this.#ft=e;this.getSearchParamConfig("sort").values=e,this.dispatchEvent(new CustomEvent("registersortvalues",{detail:{values:e}}))}releaseOrderMenu({menuOptions:e}={}){const t=this.buildControlFromData({type:"menu",values:s,processName:"listingorder",processTitle:"Listing Order",requiresItems:!0},"order",{title:"Order",menuOptions:e}),n=e=>{for(const[s,n]of t.list.namedChildren())if("natural"!==s){const t=n.querySelector("button");t&&(t.disabled=!e)}};return this.hasNaturalOrder&&(!this.searchParams.sort&&this.#k.sortValues&&n(!1),this.group.addEventListener("countchange",(e=>{if(!this.searchParams.sort&&this.#k.sortValues){const{oldCount:t}=e.detail;0===t&&n(!1)}})),this.addEventListener("searchparamsapplied",(e=>{const{searchParams:t}=e.detail;!("sort"in t)||"order"in t||T(t.sort)||n(!0,t.sort),"order"in t&&"natural"===t.order&&this.#k.sortValues&&n(!1)}))),t}releaseSortMenu({menuOptions:e}={}){const t=this.buildControlFromData({type:"menu",values:this.#ft,processName:"listingsort",processTitle:"Listing Sort",requiresItems:!0},"sort",{title:"Sort",menuOptions:e});return this.addEventListener("registersortvalues",(e=>{t._populator(e.detail.values,{ignoreDuplicates:!0})})),t}};return n})({parentConstructor:(({parentConstructor:e}={})=>{const t=class extends e{static#S={searchable:!0};#k;#vt;constructor(e,s){if(super(e,s),this.#k=U(s,t.#S),this.#k.searchable){let e;this.registerSearchParams([{name:"search",type:"search",controlBuilder:this.releaseSearchLandmark.bind(this)}]),this.addEventListener("requestparams",(t=>{const{params:s,requestParams:n,origin:i}=t.detail;if("search"in s){const t=!T(s.search);this.hasRegisteredSearchParam("sort")&&(this.isRelevanceInSortValues?t?(T(this.searchParams.search)&&(e={sort:this.searchParams.sort,order:this.searchParams.order}),this.relevanceKey?s.sort=this.relevanceKey:(delete s.sort,delete n.sort),s.order="desc"):e&&(s.sort=e.sort,s.order=e.order,e=void 0):this.hasNaturalOrder&&T(s.order)&&(s.order="natural")),this.hasRegisteredSearchParam("page")&&"search"===i&&(s.page=1)}}))}}static get collectiveOptions(){return{...e.collectiveOptions,...this.#S}}get searchQuery(){return this.#vt}releaseSearchLandmark({fieldName:e="query",disableIfNoItems:t=!0}={}){const s=(new Tt).createFormElement(e,{type:"search",title:"Search"}),n=Q("search",{elems:[s]});return t&&0===this.explicitTotal&&!this.#vt&&s.setAttribute("disabled","disabled"),s.addEventListener("input",(e=>{if(e.target.value!==this.#vt){const t=this.#vt;this.#vt=e.target.value||void 0;const n=this.setSearchParam("search",this.#vt,{origin:"search"}).process,i=()=>{n.delayedInfoToggler(s.shadowRoot.lastElementChild,{adjacency:p.afterend})};s.isConnected?i():s.addEventListener("fieldpopulated",(()=>{i()})),this.dispatchEvent(new CustomEvent("searchchange",{detail:{newSearchQuery:this.#vt,oldSearchQuery:t,process:n}}))}})),this.addEventListener("searchparamsset",(e=>{const{initiators:t}=e.detail;if("search"in t){let e=t.search;T(e)&&(e=""),s.value!==e&&(this.#vt=e,s.value=e)}})),t&&this.group.addEventListener("countchange",(e=>{const{newCount:t,oldCount:n}=e.detail;0===n&&s.hasAttribute("disabled")?s.removeAttribute("disabled"):this.#vt||0!==t||s.setAttribute("disabled","disabled")})),n}includeSearchLandmark({fieldName:e="query",disableIfNoItems:t=!0}={}){let s=this.header.querySelector("search");return s||(s=this.releaseSearchLandmark({fieldName:e,disableIfNoItems:t}),ne(s,this.heading)),s}};return t})({parentConstructor:(({parentConstructor:e}={})=>{const t=class extends e{static#S={selectItems:!1,onRemoveMany:void 0};#k;#yt=[];constructor(e,s){if(super(e,s),this.#k=U(s,t.#S),this.#k.selectItems){const e=this.#yt.length,[,t]=this.meta.appendPair("Selected Count",e);this.addEventListener("selectedcountchange",(e=>{const{newSelectedCount:s}=e.detail;t.textContent=s})),this.onItemBind((({item:e,key:t,controls:s,isItemBindings:n})=>{if(this.group.onMemberRemove(t,(()=>{this.#Et(t)})),n){const n={};W?.stylesheets?.checkboxClassic&&(n.stylesheet=W?.stylesheets?.checkboxClassic);const i=this.checkboxConstructor.createElement("select",n);i.addEventListener("change",(s=>{const{newState:n}=s.detail;n?(this.#Ct(t),e.classList.add("selected")):(this.#Et(t),ie(e,["selected"]))})),s.select=i}}))}}static get collectiveOptions(){return{...e.collectiveOptions,...this.#S}}get selectedItems(){return this.#yt}get selectedItemsCount(){return this.#yt.length}get isAllItemsSelected(){const e=this.itemCount;return 0!==e&&this.selectedItemsCount===e}get isNoAvailableItemsSelected(){return 0!==this.itemCount&&0===this.selectedItemsCount}#wt(e,t,s){this.dispatchEvent(new CustomEvent("selectedcountchange",{detail:{newSelectedCount:e,oldSelectedCount:t,isAll:s}}))}#Ct(e){const t=this.#yt.length;this.#yt.push(e);const s=t+1,n=s===this.itemCount;this.#wt(s,t,n)}#Et(e){if(-1!==this.#yt.indexOf(e)){const t=this.#yt.length;fe(this.#yt,e);const s=t-1;return this.#wt(s,t,!1),!0}return!1}#Pt(e,t){for(const s of t)if(this.group.hasKey(s)){const{controls:{select:t}}=this.getItemData(s);t.checked=e}}#xt(e){for(const{controls:{select:t}}of this.items())t.checked=e}selectItems(e){this.#Pt(!0,e)}selectAllItems(){this.#xt(!0)}deselectItems(e){this.#Pt(!1,e)}deselectAllItems(){this.#xt(!1)}releaseSelectAllItemsControl(){const e=_("Select All",["select-all-items-button"]);return e.addEventListener("click",(()=>{this.selectAllItems()})),this.#St(e),e}#St(e){!this.isAllItemsSelected&&this.#k.selectItems&&0!==this.itemCount||(e.disabled=!0),this.addEventListener("selectedcountchange",(t=>{const{isAll:s,newSelectedCount:n}=t.detail;(s||0===n&&0===this.itemCount)&&!e.disabled?e.disabled=!0:!s&&e.disabled&&(e.disabled=!1)})),this.group.addEventListener("countchange",(t=>{if(this.#k.selectItems){const{newCount:s}=t.detail;!this.isAllItemsSelected&&0!==s||e.disabled?!this.isAllItemsSelected&&e.disabled&&(e.disabled=!1):e.disabled=!0}}))}#kt(e){this.#k.selectItems&&0!==this.itemCount&&0!==this.selectedItemsCount||(e.disabled=!0),this.addEventListener("selectedcountchange",(t=>{const{newSelectedCount:s}=t.detail;s||e.disabled?s&&e.disabled&&(e.disabled=!1):e.disabled=!0})),this.group.addEventListener("countchange",(t=>{const{newCount:s}=t.detail;this.#k.selectItems&&(0!==s&&0!==this.selectedItemsCount||e.disabled?0!==this.selectedItemsCount&&e.disabled&&(e.disabled=!1):e.disabled=!0)}))}releaseDeselectAllItemsControl(){const e=_("Deselect All",["deselect-all-items-button"]);return!this.isNoAvailableItemsSelected&&this.#k.selectItems||(e.disabled=!0),e.addEventListener("click",(()=>{this.deselectAllItems()})),this.#kt(e),e}releaseDeleteSelectedItemsControl(){const e=_("Delete Selected",["delete-selected-entries-button"]);return e.addEventListener("click",(()=>{this.deleteEntries([...this.#yt])})),this.#kt(e),e}releaseControlsMenu({headingText:e="Select Items",includeDeleteSelected:t=!1}={}){const s=new Ve({headingText:e,classes:["select-items-menu"]});return s.append(this.releaseSelectAllItemsControl(),"select-all"),s.append(this.releaseDeselectAllItemsControl(),"deselect-all"),t&&s.append(this.releaseDeleteSelectedItemsControl(),"delete-selected"),s}};return t})({parentConstructor:mt})}),naturalOrder:!0})}),Mt=Ot;class Lt extends Mt{static#S={classes:[],id:void 0,groupMemberBuilder:void 0,keyAsDataId:!1,itemBindings:void 0,searchParams:{perPage:25,page:1,order:"natural"},useURLQuery:!1,publishToURLQuery:!1,includeMeta:!0,includeMenu:!1,onRemove:void 0,onRemoveMany:void 0,createMenuForEachItem:!1,deleteEntriesMessages:void 0,hyperlinkBuilder:void 0,onVisit:void 0,urlBuilders:void 0,onHeadItems:void 0,searchable:!1,selectItems:!1,paging:ct.pagingMethods.regular,pagingStreamOnScroll:!0,includePaging:!0,sortable:!0,perPageValues:void 0,sortValues:void 0,itemTemplate:void 0,itemName:void 0,itemNameReuse:!0,format:"default",chunkNames:void 0,includeHead:!1,headItemSort:void 0,applySearchParams:void 0};#fe;#k;#ue;#Tt;#Ot;constructor(e,t,s={}){L(e,_e),"searchParams"in(s=U(s,Lt.#S))&&(s.searchParams={...Lt.#S.searchParams,...s.searchParams}),s={...Lt.#S,...s};const n=e.getSize();let i;if(n instanceof Promise?(s.searchParams.page=void 0,s.startWithEmptyMessage=!1):(i=n,0===n&&(s.searchParams.page=0)),!s.groupMemberBuilder)if(s.itemTemplate){const e=Te.customElementMemberBuilder;s.itemName&&(e.customElementName=s.itemName),s.groupMemberBuilder=e}else"chunks"===s.format&&(s.groupMemberBuilder=Te.chunkBuilder,s.chunkNames&&(s.groupMemberBuilder.chunkNames=s.chunkNames));s.entryDeletor=t=>1===t.length?e.delete(t[0]):e.deleteMany(t);if(super(t,U(s,Mt.collectiveOptions)),this.#fe=e,this.#k=s,this.#Ot=Promise.withResolvers(),void 0!==i&&(this.total=i,this.explicitTotal=i),"string"==typeof s.format&&this.element.setAttribute("data-format",s.format),s.searchable&&this.includeSearchLandmark(),s.itemTemplate){let e=s.itemName;if(!e){let t=1;do{e=`listing-item-${t}`,t++}while(customElements.get(e))}customElements.get(e)&&s.itemNameReuse||function(e,{template:t,throwOnDuplicate:s=!0,webComponentOptions:n={}}={}){if(customElements.get(e)){if(s)throw new DOMException(`Custom element with name ${e} is already defined`,"DuplicateError")}else customElements.define(e,class extends(de(n)){constructor(){super()}connectedCallback(){super.connectedCallback(t)}})}(e,{template:s.itemTemplate})}s.includeHead&&"chunks"===s.format&&s.chunkNames&&this.createHead(Object.entries(s.chunkNames)),this.#fe.addEventListener("add",(e=>{this.#Ot.promise.then((()=>{this.#y(e.detail.element,e.detail.key,e.detail.position)}))}));const r=e=>{this.total=e,this.explicitTotal=e,this.setSearchParams(this.searchParams,{forceWhenMatching:!0,origin:"init"})};if(n instanceof Promise){He.wrapAroundPromise(n,["storelistinginit","Store Listing Init"]).delayedInfoToggler(this.footer,{delay:150,adjacency:p.afterbegin}),n.then((e=>{r(e)})).catch((e=>{}))}else r(n);const a=t=>{if(this.#k.paging&&1!==this.pageCount||e.isDense){for(const e of t)if(this.group.hasKey(e)){this.reload();break}}else for(const e of t)this.removeItem(e)};this.#fe.addEventListener("delete",(e=>{const{key:t,total:s}=e.detail;a([t]),this.total=s,this.explicitTotal=s})),this.#fe.addEventListener("deletemany",(e=>{const{keys:t,total:s}=e.detail;a(t),this.total=s,this.explicitTotal=s})),this.#fe.addEventListener("deletenotfound",(e=>{const{keys:t,total:s}=e.detail;this.total=s;for(const e of t)this.removeItem(e)}))}newInstance(e){return new this.constructor(this.#fe,this.originalTitle,e||this.#k)}static get defaultOptions(){return Object.assign({},this.#S)}get options(){return Object.assign({},this.#k)}set total(e){this.#ue=e,this.#k.paging&&(super.total=e)}get total(){return this.#ue}set explicitTotal(e){super.explicitTotal=e}get explicitTotal(){return super.explicitTotal}async#Mt(e,t,s){let n;if(this.#k.paging){n=Ot.isPageChangeOnlyByInitiators(s),this.perPage=Number(e.perPage),this.pageNumber=Number(e.page);const t=this.previousPageNumber;if(!this.isNonStreamPaging&&n&&t-1===this.pageNumber){const s=new We({total:this.total,perPage:this.perPage,page:t});return this.group.removePortion(s.offsetStart,s.offsetEnd-1),Object.assign({},e)}}const i=B(e,((e,t)=>!T(t))),r=await this.#fe.applySearchParams(i,{signal:t.signal});let{result:a,total:o,appliedParams:l}=r;this.#k.applySearchParams&&"function"==typeof this.#k.applySearchParams&&({iterable:a,total:o,appliedParams:l}=this.#k.applySearchParams(e,a,o,l)),"natural"===e.order&&(l.order="natural"),this.total=o,this.putDownEmptyMessage(),this.suspendEmptyMessage(),!this.isNonStreamPaging&&n||this.empty(),this.#Tt=t,t.delayedInfoToggler(this.footer,{adjacency:p.afterbegin});try{for await(let[e,s]of a){if(this.#Tt.id!==t.id)throw new DOMException("Process aborted","AbortError");const n=Object.hasOwn(s,"result")&&s.result?s.result:s;this.#Lt(n,e)}}finally{this.#Tt.id===t.id&&(this.unsuspendEmptyMessage(),this.revisitEmptyMessage())}return l}#Lt(e,t,s){let n;if("chunks"===this.#k.format&&"toElementChunks"in e){const i=e.toElementChunks({search:this.searchQuery,chunkList:this.options.chunkNames});n=this.insertItemFromElement(i,s,t,e)}else if(Te.hasGroupMemberMethod(e)){const i=e.toGroupMember({search:this.searchQuery});n=this.insertItem(i,s,t,e)}else n=this.insertItemFromElement(e,s,t,e);return n}#y(e,t,s){const n=this.total;s<0&&(s=n);let i=!0;const r=this.itemCount,a=this.searchParams;if(this.#k.paging&&0!==r&&!(r<this.perPage)||!T(a.order)&&"natural"!==a.order)this.#k.paging&&!this.isPositionWithinPageRange(s)||(i=!0,this.reload());else{let n=e,r=!0;this.searchQuery&&(r=Qe(e,this.searchQuery),null!==r&&(n=r)),r?(i=!0,this.#Lt(n,t,s)):i=!1}const o=n+1;i&&(this.total=o),this.explicitTotal=o}reload(){return this.setSearchParams(this.searchParams,{forceWhenMatching:!0})}async setParamsRequest(e,{initiators:t,process:s}){let n;return 0!==this.explicitTotal?n=await this.#Mt(e,s,t):(this.empty(),n=Object.create(null)),this.#Ot.resolved||(this.#Ot.resolve(),this.#Ot.resolved=!0),n}}class At extends(Ge(Je)){#be;constructor(e){L(e,Map,{allowUndefined:!0}),e||(e=new Map);const t={};super(e,{protectedMethods:t}),this.#be=t.dispatchAddEvent}hasKey(e){return this.store.has(e)}add(e,t){this.store.set(t,e),this.#be(e,{key:t,position:-1})}}const Nt=(()=>{let t=0;const s=h({pending:"Pending",waiting:"Waiting",doing:"Doing",done:"Done",cancelling:"Cancelling",cancelled:"Cancelled",failed:"Failed"},"jobStatuses"),n=h({done:"done",cancelled:"cancelled",failed:"failed"},"jobOutcomes"),i={},r=$e({statuses:s,defaultStatus:s.pending,privateMethods:i});return class extends r{#se;#Y;#At;#Nt;#It;#Dt;#jt=!1;#Rt;#Bt;#Ft=new Set;#N;#Vt;#$t;#Kt;constructor(e,s,{jobs:n,category:r="main",host:a,goals:o}={}){if(L(n,It,{paramNumber:3,allowUndefined:!0}),super(),t++,this.#Y=i.changeStatus,this.#se=t,this.#At=e,this.#Nt=r,this.#It=a,this.#Rt=n,this.#Bt=s,this.#Kt=o,n){const e=n.filter([r],null,!1,a,o);if(0!==e.size){const t=e.values().next().value;this.addDependency(t),t.settled().then((()=>{this.#Ut(t.outcome,t.result)}))}n.add(this)}}get id(){return this.#se}get keyPath(){return"id"}get name(){return this.#At}get category(){return this.#Nt}get host(){return this.#It}get isSettled(){return this.#jt}get result(){return this.#$t}get outcome(){return this.#Dt}get goals(){return this.#Kt}static get statuses(){return s}static get outcomes(){return n}#qt(){const e=new Ve;let t,s,n,i;return this.isPending&&([,s,t]=e.appendButton("Do","do"),t.addEventListener("click",(async()=>{try{await this.do()}catch(e){}}))),this.isDone||([,i,n]=e.appendButton("Cancel","cancel"),n.addEventListener("click",(async()=>{try{await this.cancel()}catch(e){}})),this.isCancelling&&(n.disabled=!0),this.addEventListener("settle",(()=>{e.remove(i)}))),(s||i)&&this.addEventListener("statuschange",(()=>{e.remove(s),this.isCancelling&&(n.disabled=!0)})),e}#Ht(){const e=new Oe({classes:["dependencies"]}),t=t=>{const s=`job${t.id}`,n=document.createTextNode(t.name),[i]=e.append(n,s);return i};for(const e of this.#Ft)t(e);return this.addEventListener("dependency",(e=>{const{job:s}=e.detail,n=t(s);s.addStatusAttrTo(n)})),this.addEventListener("dependencyremove",(t=>{const{job:s}=t.detail,n=`job${s.id}`;e.remove(n)})),e}addDependency(e){if(L(e,Nt),!this.isPending&&!this.isWaiting)throw new DOMException("Dependency can be added only when job is pending or waiting","StatusError");if(this.#Rt&&!this.#Rt.has(e))throw new DOMException("Job must belong to parent listing","HierarchyError");this.#Ft.add(e),this.dispatchEvent(new CustomEvent("dependency",{detail:{job:e}})),e.addEventListener("settle",(()=>{this.#Ft.delete(e)}))}removeDependency(e){L(e,Nt);const t=this.#Ft.delete(e);return t&&this.dispatchEvent(new CustomEvent("dependencyremove",{detail:{job:e}})),t}hasDependencies(){return 0!==this.#Ft.size}dependencies(){return this.hasDependencies()?new Ne(((e,t)=>{const s=[],n=n=>{n.isFailed?t(`Job "${n.name}" has failed`):n.isCancelled?t(`Job "${n.name}" has been cancelled`):(s.push(...n.result),this.hasDependencies()||e(s))},i=e=>{e.isCancelling&&t(`Job "${e.name}" is being cancelled`)};for(const e of this.#Ft)e.isSettled?n(e):i(e),e.addEventListener("statuschange",(()=>{i(e)})),e.addEventListener("settle",(()=>{n(e)}))})):Ne.resolve()}async do({abortController:e=new AbortController,returnLastValue:t=!1}={}){if(!this.isPending)throw new DOMException("Only pending jobs can be done","StatusError");let i=[];if(this.hasDependencies()){this.#Y(s.waiting);const t=this.dependencies();this.addEventListener("statuschange",(e=>{e.detail.newStatus===s.cancelled&&t.cancel()})),e.signal.addEventListener("abort",(e=>{this.cancel(e.target.reason)}));try{i=await t}catch(e){if(!Ne.isPromiseAbortException(e)){const t=new E("Dependency error","DependencyError",e);throw this.#Ut(n.fail,t),t}throw e}}this.#N=e,this.#Y(s.doing);try{const s=await M(this.#Bt,{signal:e.signal,initialValues:i,onEnd:({revertPromise:e})=>{this.#Vt=e}});return this.#Ut(n.done,s),t?0===(r=s).length?void 0:r[r.length-1]:s}catch(e){if(e instanceof x){this.#Y(s.cancelling);try{await this.#Vt}catch(e){throw this.#Ut(n.failed,e),e}this.#Ut(n.cancelled,e)}else this.#Ut(n.failed,e);throw e}var r}async done(){return new Promise((e=>{this.isDone?e():this.addEventListener("statuschange",(t=>{t.detail.newStatus===s.done&&e()}))}))}#Ut(e,t){switch(this.#Dt=e,this.#jt=!0,this.#$t=t,e){case n.done:this.#Y(s.done);break;case n.failed:this.#Y(s.failed);break;case n.cancelled:t=new E("Cancel error","AbortError",t),this.#$t=t,this.#Y(s.cancelled)}return this.dispatchEvent(new CustomEvent("settle",{detail:{status:this.status,outcome:e,result:t}})),t}async settled(){return new Promise(((e,t)=>{const s=()=>{this.#Dt===n.done?e(this.#$t):t(this.#$t)};this.isSettled?s():this.addEventListener("settle",(()=>{s()}))}))}async cancel(e){if(this.isCancelled)return this.#$t.cause;if(this.isDone||this.isFailed)throw new DOMException("Done or failed jobs cannot be cancelled","StateError");if(this.isPending||this.isWaiting)return this.#Ut(n.cancelled,e);(this.isDoing||this.isCancelling)&&(this.isDoing&&this.#N.abort(e),await this.#Vt);try{await this.settled()}catch(e){return e.cause}}toElementRepresentative({search:e}={}){const t=new qe(this.#At,{classes:["job"]});N(this.#At,e,t.heading);const s=new Ke,[,n]=s.appendPair("Status",this.status.value);N(this.status.value,e,n),this.addEventListener("statuschange",(t=>{const i=t.detail.newStatus.value;if(n.textContent=i,N(i,e,n),this.isFailed){let e=this.#$t.message||this.#$t;this.#$t.cause&&(e=e.concat(": ",this.#$t.cause.message||this.#$t.cause)),s.appendPair("Failure reason",e)}})),t.insert(s.element);const i=this.#qt();t.insert(i);const r=this.#Ht();let a=Q("h6",{text:"Dependencies"});return 0!==r.count&&t.insert(a),r.addEventListener("countchange",(e=>{const{newCount:t}=e.detail;t&&!re(a)?r.element.before(a):!t&&re(a)&&ae(a)})),t.insert(r),t}toElement({search:e}={}){return this.toElementRepresentative({search:e}).element}toGroupMember({search:e}={}){return this.toElement({search:e})}toElementChunks({search:e,chunkList:t}={}){const s={id:t=>{I(t,"#".concat(this.id),e)},name:t=>{I(t,this.#At,e)},status:t=>{this.addStatusAttrTo(t),this.updateStatusText(t,e)},dependencies:e=>{const t=this.#Ht();e.append(t.element)}};if(R(t)){const e={};for(const n of Object.keys(t))Object.hasOwn(s,n)&&(e[n]=s[n]);return e}return s}toItem(){return{id:this.id,name:this.name,status:this.status.value}}static compareGoals(e,t){const s=Object.keys(e),n=Object.keys(t);if(s.length!==n.length)return!1;for(const n of s)if(e[n]!==t[n])return!1;return!0}static get chunkNames(){return{id:"ID",name:"Name",status:"Status",dependencies:"Dependencies"}}static get criteriaItems(){return["id","name","status"]}static get sortValues(){return{id:"ID",name:"Name",status:"Status"}}trackCriteria(t){const s=Object.create(null);let n;Object.hasOwn(t,"search")&&(n=t.search,delete t.search);let i=!1;const r={},a=()=>{const e=Object.values(r).includes(!0);e!==i&&(i=e,"function"==typeof s.onchange&&s.onchange(i))},o=(s,i)=>{let a=!1;if(s in t&&t[s]==i)a=!0;else if(n){let t=i;i instanceof l&&(t=i.value),function(t,s,n=!1,i=!1){const r=typeof t;let a=null;if("string"===r&&i?a=e(t):"number"===r&&(a=String(t)),i&&(s=e(s)),a&&(n&&(a=a.toLowerCase(),s=s.toLowerCase()),-1!==a.indexOf(s)))return!0;return!1}(t,n,!0,!0)&&(a=!0)}r[s]=a};for(const e of this.constructor.criteriaItems)(n||e in t)&&o(e,this[e]),"status"===e&&this.addEventListener("statuschange",(e=>{o("status",e.detail.newStatus),a()}));return a(),Object.assign(s,{get isMatch(){return i},get matches(){return r}}),s}}})();class It{#fe=new At;get collection(){return this.#fe.store}get count(){return this.#fe.size}create(e,t,{category:s="main",host:n}){return new Nt(e,t,{jobs:this,category:s,host:n})}add(e){L(e,Nt),this.has(e)||this.#fe.add(e,e.id)}has(e){return L(e,Nt),this.#fe.hasKey(e.id)}filter(e,t,s,n,i){const r=new Set;T(e)||Array.isArray(e)||(e=[e]),T(t)||Array.isArray(t)||(t=[t]);for(const[,a]of this.#fe)n&&n!==a.host||e&&e.length&&!e.includes(a.category)||t&&t.length&&!t.includes(a.name)||!0===s&&!a.isSettled||!1===s&&a.isSettled||i&&(a.goals&&!Nt.compareGoals(i,a.goals)||!a.goals)||r.add(a);return r}static async waitFor(e){if(!e.size)return Promise.resolve();const t=[];for(const s of e)t.push(s.settled());return await Promise.all(t)}static async cancel(e){if(!e.size)return Promise.resolve();const t=[];for(const s of e)t.push(s.cancel());return await Promise.all(t)}toItems(){const e=[];for(const[,t]of this.#fe)e.push(t.toItem());return e}toElementRepresentative({format:e="default"}={}){const t={searchable:!0,keyAsDataId:!0,format:e,chunkNames:Nt.chunkNames,sortValues:Nt.sortValues};return"chunks"===e&&(t.includeHead=!0),new Lt(this.#fe,"Jobs",t)}toElement({format:e="default"}={}){return this.toElementRepresentative({format:e}).element}}const Dt=(()=>{const e={};return async(t,s,n,i,{force:r=!0,signal:a,finallyCallback:o,payload:l}={})=>{if(t in e){const i=e[t];if(i.isActive){if(Nt.compareGoals(i.goals,s)){for(const e of Object.keys(i.payload))l[e]=i.payload[e];return await i.promise}i.abortController.abort()}if(!r&&Nt.compareGoals(s,n))return n}const{promise:c,resolve:h,reject:d}=Promise.withResolvers();t in e==!1?e[t]={id:1}:e[t].id++,e[t].isActive=!0,e[t].goals=s,e[t].promise=c,e[t].abortController=new AbortController,e[t].payload=l;const u=e[t].id;try{const n=[e[t].abortController.signal];a&&a instanceof AbortSignal&&n.push(a);const r=AbortSignal.any(n);await i(r),h(s)}catch(e){d(e);try{await c}catch(e){throw e}}finally{o&&o(),u===e[t].id&&(e[t].isActive=!1)}return s}})(),jt=(()=>{const e=h({light:"Light",dark:"Dark"},"colorModeThemes"),t=h({light:"Light",dark:"Dark",os:"OS"},"colorModes"),s={name:"DefaultStoreController",value:t.os,async fetch(){return this.value},async save(e){return u(e,"colorModes"),this.value=e,e}};Object.seal(s);const n={name:"DefaultLocalStorageStoreController",key:"colorMode",async fetch(){const e=localStorage.getItem(this.key);return null!==e?t[e]:null},async save(e){return u(e,"colorModes"),localStorage.setItem(this.key,e.name),e}};Object.seal(n);const i=matchMedia(`(prefers-color-scheme:${e.light.name})`),r=document.documentElement;let a,o,m=i.matches?e.light:e.dark;i.addEventListener("change",(t=>{m=t.matches?e.light:e.dark,window.dispatchEvent(new CustomEvent("osthemechange",{detail:{theme:m}}))}));let g=s,f=!1;const b=new BroadcastChannel("colorMode");Z(r,"data-theme",(({newValue:e})=>{o||null===e?o&&e!==o.name&&r.setAttribute("data-theme",o.name):r.removeAttribute("data-theme")}));let v=!1;if(r.hasAttribute("data-color-mode")){const e=r.getAttribute("data-color-mode");try{a=t[e]}catch(e){if(!(e instanceof c))throw e}}else E(s.value),v=!0;if(r.hasAttribute("data-theme")){const t=r.getAttribute("data-theme");try{e[t]}catch(e){e instanceof c&&r.removeAttribute("data-theme")}}function y(s){!function(e){if(e!==o){const t=o;o=e,r.setAttribute("data-theme",o.name),document.dispatchEvent(new CustomEvent("themechange",{detail:{newTheme:o,oldTheme:t}}))}}(function(s){if(s===t.os)return m;return s===t.light?e.light:e.dark}(s))}function E(e,{broadcast:t=!0}={}){if(e!==a){const s=a;a=e,r.setAttribute("data-color-mode",a.name),document.dispatchEvent(new CustomEvent("colormodechange",{detail:{newColorMode:a,oldColorMode:s}})),y(a),t&&b.postMessage({colorMode:a.name,controllerName:g.name})}}!v&&a&&y(a);const C=new class extends EventTarget{get colorMode(){return a}get colorModes(){return t}get theme(){return o}get themes(){return e}get OSTheme(){return m}get hasCustomStoreController(){return f}get defaultStoreController(){return s}get defaultLocalStorageStoreController(){return n}get nextColorMode(){switch(a){case t.light:return t.dark;case t.dark:return t.os;case t.os:return t.light;default:return}}async getColorMode(){let e=await g.fetch();return null===e&&(e=await g.save(s.value)),e}async setCustomStoreController(e,{apply:t=!1}={}){if(this.validateStoreController(s),g=e,f=!0,t){let e;e=t instanceof l&&function(e,t){if(!(e instanceof l))throw new TypeError("Argument #1 is not an enumeration member");return d(e.listing,t)}(t,"colorModes")?t:await this.getColorMode(),E(e)}}unsetCustomStoreController(){f&&(g=s,f=!1)}async saveColorMode(e,{force:t=!1,signal:s}={}){const n={},i=Dt("savecolormode",{colorMode:e},{colorMode:a},(async t=>{await g.save(e,{signal:t})}),{payload:n,force:t,signal:s});if(!n.process){const t=new AbortController,s=He.wrapAroundPromise(i,["savecolormode","Save Color Mode",{handle:t}]);n.process=s,this.dispatchEvent(new CustomEvent("savestart",{detail:{colorMode:e,process:s}}))}return await i,E(e),e}async saveNextColorMode(){return this.saveColorMode(this.nextColorMode)}releaseMenu({headingText:e="Theme",classes:s=[],type:n,selectValue:i}={}){const r=new Ve({headingText:e,type:n,classes:s,selectValue:i});for(const e of Object.values(t)){const[t,,s]=r.appendButton(e.value,e.name);e===a&&(t.classList.add("active"),s.disabled=!0),s.addEventListener("click",(()=>{this.saveColorMode(e)}))}return this.addEventListener("savestart",(e=>{const{colorMode:t,process:s}=e.detail,n=r.getButton(t.name);n&&s.delayedInfoToggler(n,{adjacency:p.afterbegin,tag:"span"})})),document.addEventListener("colormodechange",(e=>{const{newColorMode:t,oldColorMode:s}=e.detail,n=r.list.getItem(s.name);if(n){ie(n,["active"]);r.getButton(s.name).disabled=!1}r.list.getItem(t.name).classList.add("active");r.getButton(t.name).disabled=!0})),this.addColorModeAttrTo(r.element),r}releaseTogglerButton(){const e=_(a.value);return e.title="Toggle Color Mode",e.addEventListener("click",(()=>{this.saveNextColorMode()})),this.updateColorModeText(e),this.addColorModeAttrTo(e),this.addEventListener("savestart",(t=>{const{process:s}=t.detail;s.delayedInfoToggler(e,{adjacency:p.afterbegin,tag:"span"})})),e}releaseTogglerCustomElement(){return Q("color-mode-toggler")}addColorModeAttrTo(e){L(e,Element),e.setAttribute("data-color-mode",""),this.updateColorModeOnAttr(e.getAttributeNode("data-color-mode"))}updateColorModeOnAttr(e){L(e,Attr),e.value=a.name,document.addEventListener("colormodechange",(t=>{e.value=t.detail.newColorMode.name}))}updateColorModeText(e){e.textContent=a.value,document.addEventListener("colormodechange",(t=>{e.textContent=t.detail.newColorMode.value}))}validateStoreController(e){!function(e,t){if("object"!=typeof e)throw new DOMException("Value must be an object","ValidationError");for(const{name:s,type:n,required:i}of t)if(Object.hasOwn(e,s)){if(typeof e[s]!==n)throw new DOMException(`Property "${s}" must be of "${n}" type`,"ValidationError")}else if(i)throw new DOMException(`Property "${s}" is missing`,"ValidationError")}(e,[{name:"name",type:"string",required:!0},{name:"fetch",type:"function",required:!0},{name:"save",type:"function",required:!0}])}};Object.freeze(C),addEventListener("osthemechange",(()=>{a===t.os&&y(a)})),b.addEventListener("message",(e=>{const{colorMode:s,controllerName:n}=e.data;n&&n!==g.name||E(t[s],{broadcast:!1})})),Z(r,"data-color-mode",(({oldValue:e,newValue:s,attrName:n})=>{Object.hasOwn(t,s)?a.name!==s&&C.saveColorMode(t[s]):T(e)?r.removeAttribute(n):r.setAttribute(n,e)}));class w extends(de()){constructor(){super(),this.replaceChildren()}connectedCallback(){super.connectedCallback(),C.addColorModeAttrTo(this);const e=C.releaseTogglerButton();this.shadowRoot.append(e)}}return customElements.define("color-mode-toggler",w),C})();window.colorMode=jt,window.colorModeSwitcher=jt.releaseMenu({type:Ve.types.regular})}();
